/*!CK:945885556!*//*1444747167,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["U\/uZw"]); }

__d("ChatTypeaheadEvent",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ABANDONED_QUERY:"abandoned_query",NEW_QUERY:"new_query",RESULT_SELECTED:"result_selected"};},null,{});
__d("StickerConstants",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={MOBILE_LIKE_STICKER_PACK_ID:"227877430692340",GRAVEYARD_PACK_ID:"604597256247273",LIKE_STICKER_ID:"227878347358915",HOT_LIKE_SMALL_STICKER_ID:"369239263222822",HOT_LIKE_MEDIUM_STICKER_ID:"369239343222814",HOT_LIKE_LARGE_STICKER_ID:"369239383222810",MRU_STICKER_PACK:"599061016853145",SEARCH_PACK_ID:"680229632032514",SPRITE_PADDING:"24",PayloadSource:{VIEW_ACTION:"view-action"},EMOTICON_PACK_ID:"1471127876485636",DEFAULT_FRAME_RATE:83,TRAY_SIZE:64,THREAD_SIZE:120};},null,{});
__d('OrderedFriendsList',['AvailableListConstants','PresenceStatus','SearchableEntry','ShortProfiles','WorkModeConfig','createArrayFromMixed','isValidUniqueID','InitialChatFriendsList'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=[],p=[],q={},r=[],s={},t=[],u={contains:function(v){return v in q;},getList:function(){if(l.is_work_user)return m(o);u.reRank();var v=m(o);v=v.filter(function(w){var x=k.getNowUnsafe(w);return !x||x.type=='friend'||x.is_nonfriend_messenger_contact;});return v;},getSearchableEntries:function(v,w){var x=u.getList();k.getMulti(x.slice(0,v),function(y){var z=[];for(var aa in y)z.push(u.normalizeProfileEntry(y[aa],aa));var ba=u.getGroups().map(u.normalizeThreadEntry);w(z.concat(ba).filter(function(ca){return !!ca;}).sort(function(ca,da){return ca.getOrder()-da.getOrder();}));});},normalizeProfileEntry:function(v,w){var x=v.searchTokens||[];return new j({uniqueID:v.id||w,keywordString:x.join(' '),order:u.getRank(v.id||w),photo:v.thumbSrc,title:v.name,type:v.type,uri:v.uri,auxiliaryData:{isMessengerUser:v.is_messenger_user}});},normalizeThreadEntry:function(v,w){var x=v.mercury_thread,y=v.participants_to_render,z=v.text,aa=null;if(!z)z=x.name;var ba=y.map(function(da){return da.name;}).join(', ');if(!z){z=ba;}else aa=ba;var ca=v.uid;if(!z||!n(ca))return null;return new j({uniqueID:ca,order:w,photo:x.image_src,title:z,subtitle:aa,type:'thread',auxiliaryData:{participantsToRender:y,thread:x}});},getRank:function(v){return v in q?q[v]:o.length;},getActiveList:function(){if(r.length>0)return r;return u.getList();},getActiveRank:function(v){return v in s?s[v]:u.getRank(v);},reRank:function(){o=[];var v=0;t.forEach(function(w){var x=w.slice(0,-2),y=w.slice(-1);if(i.get(x)==y){o[v]=x;q[x]=v++;}});},rankActive:function(){var v=0;t.forEach(function(w){var x=w.slice(0,-2),y=w.slice(-1);if(y==h.ACTIVE){r[v]=x;s[x]=v++;}});},getGroups:function(){return p;}};(function(){var v=c('InitialChatFriendsList');o=v.list.length?v.list:[];p=v.groups||[];if(!l.is_work_user){t=o.slice();u.rankActive();u.reRank();}else o.forEach(function(w,x){q[w]=x;});})();f.exports=b.OrderedFriendsList||u;},null);
__d('ChatDispatcher',['Dispatcher'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new h();},null);
__d('ChatTabActions',['ChatDispatcher','keyMirror'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=i({CLOSE_TAB:null,CLOSE_ALL_TABS:null,CLOSE_FRAGILE_TABS:null,LOWER_TAB:null,OPEN_FRAGILE_TAB:null,OPEN_TAB:null,PERSIST_LOCAL_STATE:null,PROMOTE_TAB:null,RAISE_TAB:null}),k={Types:j,closeTab:function(l,m){h.dispatch({actionType:j.CLOSE_TAB,reason:m,threadID:l});},closeAllTabs:function(){h.dispatch({actionType:j.CLOSE_ALL_TABS});},closeFragileTabs:function(){h.dispatch({actionType:j.CLOSE_FRAGILE_TABS});},lowerTab:function(l){h.dispatch({actionType:j.LOWER_TAB,threadID:l});},openFragileTab:function(l){h.dispatch({actionType:j.OPEN_FRAGILE_TAB,threadID:l});},openTab:function(l){h.dispatch({actionType:j.OPEN_TAB,threadID:l});},persistLocalState:function(){h.dispatch({actionType:j.PERSIST_LOCAL_STATE});},promoteTab:function(l){h.dispatch({actionType:j.PROMOTE_TAB,threadID:l});},raiseTab:function(l,m,n){h.dispatch({actionType:j.RAISE_TAB,signatureID:n,threadID:l,userAction:m});}};f.exports=k;},null);
__d('ChatSidebarActionTypes',['keyMirror'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=h({INIT:null,LOADED:null,SET_ENABLED:null,SHOW:null,TOGGLE:null});},null);
__d('ChatSidebarStore',['ChatDispatcher','ChatOptionsInitialData','ChatSidebarActionTypes','FluxStore','SidebarType','performanceAbsoluteNow'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;'use strict';n=babelHelpers.inherits(p,k);o=n&&n.prototype;function p(){o.constructor.call(this,h);this.$ChatSidebarStore1={initialized:false,initTime:m(),loaded:false,enabled:!!i.sidebar_mode,visible:null};this.$ChatSidebarStore2={};}p.prototype.__onDispatch=function(q){var r=q.type;this.$ChatSidebarStore2=babelHelpers._extends({},this.$ChatSidebarStore1);switch(r){case j.INIT:if(!this.$ChatSidebarStore2.initialized)this.$ChatSidebarStore1.initTime=m();this.$ChatSidebarStore1.initialized=true;break;case j.LOADED:this.$ChatSidebarStore1.loaded=true;break;case j.SHOW:this.$ChatSidebarStore1.visible=q.sidebarType;break;case j.SET_ENABLED:this.$ChatSidebarStore1.enabled=q.enabled;this.$ChatSidebarStore1.visible=q.sidebarType;break;case j.TOGGLE:this.$ChatSidebarStore1.enabled=!this.$ChatSidebarStore1.enabled;this.$ChatSidebarStore1.visible=this.$ChatSidebarStore1.enabled?q.visible:l.BUDDYLIST;break;}for(var s in this.$ChatSidebarStore1)if(this.$ChatSidebarStore1.hasOwnProperty(s))if(this.$ChatSidebarStore1[s]!==this.$ChatSidebarStore2[s]){this.__emitChange();break;}};p.prototype.getPrevState=function(){return this.$ChatSidebarStore2;};p.prototype.getState=function(){return this.$ChatSidebarStore1;};p.prototype.isInitialized=function(){return this.$ChatSidebarStore1.initialized;};p.prototype.isLoaded=function(){return this.$ChatSidebarStore1.loaded;};p.prototype.isEnabled=function(){return this.$ChatSidebarStore1.enabled;};p.prototype.getInitTime=function(){return this.$ChatSidebarStore1.initTime;};p.prototype.getVisibleType=function(){return this.$ChatSidebarStore1.visible;};f.exports=new p();},null);
__d('ChatSidebarVisibility',['ChatConfig','ChatSidebarStore','DOMDimensions','OrderedFriendsList'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=h.get('sidebar.min_friends'),m=h.get('sidebar.minimum_width'),n=h.get('minisidebar.minimum_width'),o={getViewport:function(){return j.getViewportWithoutScrollbarDimensions();},hasLowFriendCount:function(){return k.getActiveList().length<=l;},isViewportCapable:function(){var p=o.getViewport();return p.width>m;},isViewportCapableForMiniSidebar:function(){var p=o.getViewport();return p.width>n&&p.width<=m;},shouldShowSidebar:function(){return o.shouldShowSidebarIgnoreEnabled()&&i.isEnabled();},shouldShowMiniSidebar:function(){return o.shouldShowMiniSidebarIgnoreEnabled()&&i.isEnabled();},shouldShowSidebarIgnoreEnabled:function(){return o.isViewportCapable()&&!o.hasLowFriendCount();},shouldShowMiniSidebarIgnoreEnabled:function(){return !h.get('divebar_new_design',false)&&o.isViewportCapableForMiniSidebar()&&!o.hasLowFriendCount();}};f.exports=o;},null);
__d('ChatSidebarActions',['ChatDispatcher','ChatSidebarActionTypes','ChatSidebarVisibility','SidebarType'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();function l(){if(j.shouldShowSidebar()){return k.SIDEBAR;}else if(j.shouldShowMiniSidebar())return k.MINI_SIDEBAR;return k.BUDDYLIST;}function m(){if(j.shouldShowSidebarIgnoreEnabled()){return k.SIDEBAR;}else if(j.shouldShowMiniSidebarIgnoreEnabled())return k.MINI_SIDEBAR;return k.BUDDYLIST;}var n={init:function(){h.dispatch({type:i.INIT});},loaded:function(){h.dispatch({type:i.LOADED});},disable:function(){h.dispatch({type:i.SET_ENABLED,enabled:false,sidebarType:k.BUDDYLIST});},enable:function(){h.dispatch({type:i.SET_ENABLED,enabled:true,sidebarType:m()});},show:function(){h.dispatch({type:i.SHOW,sidebarType:l()});},toggle:function(){h.dispatch({type:i.TOGGLE,sidebarType:l()});}};f.exports=n;},null);
__d('ChatSidebarComposeLink.react',['ChatOpenTab','React','ReactDOM','TooltipLink.react','URI','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=i.PropTypes,o=i.createClass({displayName:'ChatSidebarComposeLink',propTypes:{className:n.string.isRequired},componentDidMount:function(){h.listenOpenEmptyTab(j.findDOMNode(this),'sidebar');},render:function(){var p=m._("Neue Nachricht");return (i.createElement(k,{ajaxify:new l('/ajax/messaging/composer.php'),className:this.props.className,tooltip:p,rel:'dialog'}));}});f.exports=o;},null);
__d('SidebarFitWindowHeight',['Arbiter','ArbiterMixin','Event','Style','SubscriptionsHandler','UITinyViewportAction','Vector','mixin','queryThenMutateDOM'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q,r;q=babelHelpers.inherits(s,o(i));r=q&&q.prototype;function s(t){'use strict';r.constructor.call(this);this.$SidebarFitWindowHeight1=t;this.onViewportUpdate();m.subscribe('change',this.onViewportUpdate.bind(this));}s.prototype.onViewportUpdate=function(){'use strict';if(m.isTiny()){this.onScroll();var t=this.onScroll.bind(this);this.$SidebarFitWindowHeight2=new l();this.$SidebarFitWindowHeight2.addSubscriptions(j.listen(window,'scroll',t),h.subscribe('dom-scroll',t));}else{if(this.$SidebarFitWindowHeight3!==0){k.set(this.$SidebarFitWindowHeight1,'margin-top','0');this.$SidebarFitWindowHeight3=0;}this.$SidebarFitWindowHeight2&&this.$SidebarFitWindowHeight2.release();}};s.prototype.onScroll=function(){'use strict';p(this.updateScrollPosition.bind(this),this.resizeSidebar.bind(this),'SidebarFitWindowHeight/scroll');};s.prototype.updateScrollPosition=function(){'use strict';this.$SidebarFitWindowHeight4=n.getScrollPosition().y;this.$SidebarFitWindowHeight5||(this.$SidebarFitWindowHeight5=this.$SidebarFitWindowHeight1.offsetHeight);};s.prototype.resizeSidebar=function(){'use strict';var t=-Math.max(Math.min(this.$SidebarFitWindowHeight4,this.$SidebarFitWindowHeight5),0);k.set(this.$SidebarFitWindowHeight1,'margin-top',t+'px');if(t!=this.$SidebarFitWindowHeight3){this.$SidebarFitWindowHeight3=t;this.inform('resized',t);}};s.prototype.getOffset=function(){'use strict';return this.$SidebarFitWindowHeight3;};f.exports=s;},null);
__d('ChatSidebar',['Arbiter','ArbiterMixin','AsyncRequest','BanzaiODS','Bootloader','ChatConfig','ChatImpressionLogger','ChatSidebarActions','ChatSidebarComposeLink.react','ChatSidebarStore','ChatSidebarVisibility','CSS','DOM','DOMDimensions','Event','JSLogger','KeyEventController','LitestandClassicPlaceHolders','MercuryConfig','Parent','PresencePrivacy','PresenceUtil','React','ReactDOM','ReactComponentRenderer','Run','SidebarType','ScrollableArea','SidebarFitWindowHeight','Style','ViewportBounds','createArrayFromMixed','csx','cx','debounce','emptyFunction','ge'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra){if(c.__markCompiled)c.__markCompiled();var sa='chat_sidebar_visibility',ta,ua,va,wa,xa,ya,za,ab,bb,cb,db=null,eb,fb=w.create('chat_sidebar');k.setEntitySample(sa,.0001);function gb(){return q.getVisibleType()===ha.SIDEBAR;}function hb(){return q.getVisibleType()===ha.MINI_SIDEBAR;}function ib(vb,wb){if(!gb())return;if(wb){ab.hide();}else{ab.show();lb();}}function jb(){if(!gb()&&!hb()||!za)return 0;if(db===null){db=za.offsetWidth;if(hb())db=206;}return db;}function kb(){s.removeClass(document.documentElement,'sidebarMode');if(!q.isInitialized()){h.inform('reflow');la.inform('change');return;}db=null;ab.hide();cb.getCore().reset();s.hide(za);s.hide(xa);s.hide(ya);s.removeClass(document.documentElement,'miniSidebar');s.removeClass(za,"_51xq");wa&&wa.setProps({shown:false},function(){return qb(false);});fb.log('minisidebar_hide');h.inform('sidebar/hide',ub);h.inform('reflow');la.inform('change');}function lb(){o.show();if(!q.isInitialized()){tb();o.init();}pb();}function mb(){if(cb&&gb())cb.getCore().getElement().focus();}function nb(vb){var wb=r.getViewport().height;vb.forEach(function(xb){if(xb&&xb!==ta)wb-=u.getElementDimensions(xb).height;});if(eb)wb-=eb.getOffset();if(bb)wb-=u.getElementDimensions(bb).height;return Math.max(0,wb);}function ob(){s.hide(xa);s.show(ya);s.removeClass(document.documentElement,'miniSidebar');s.removeClass(za,"_51xq");wa&&wa.setProps({shown:false},function(){return qb(false);});db=null;s.show(za);s.addClass(document.documentElement,'sidebarMode');ab.show();fb.log('sidebar_show');h.inform('sidebar/show',ub);y.destroy('sidebar');la.inform('change');}function pb(){if(q.getVisibleType()!==ha.SIDEBAR)return;var vb=nb(ma(ya.childNodes)),wb=ab.getItemHeight(),xb=8,yb=Math.floor((vb-xb)/wb);ka.set(ta,'height',vb+'px');ab.setNumTopFriends(yb);if(z.ScrollableSidebarTypeaheadGK){cb.getView().setMaxHeight(vb);}else{var zb=Math.floor((vb-xb)/wb);zb=Math.max(zb-2,1);cb.getData().setMaxResults(zb);}h.inform('sidebar/resized',ub);h.inform('reflow');}function qb(vb){if(za===null)return;s.conditionClass(za,"_2e4g",vb);}function rb(){s.hide(ya);s.show(xa);s.show(za);s.addClass(document.documentElement,'sidebarMode');s.addClass(document.documentElement,'miniSidebar');s.addClass(za,"_51xq");var vb=nb([]);if(!wa){l.loadModules(["ChatMiniSidebar.react","ChatSearchSource"],function(wb,xb){if(!va)va=new xb({queryRequests:[{uri:'/ajax/mercury/composer_query.php'}]});wa=new fa(wb,xa);wa.setProps({dataSource:va,height:vb,maxEntries:50,onClickSearch:qb,onToggleSidebar:o.disable,shown:true});});}else wa.setProps({height:vb,shown:true});y.destroy('sidebar');fb.log('minisidebar_show');h.inform('minisidebar/show',ub);h.inform('reflow');la.inform('change');}function sb(){new j('/ajax/chat/settings.php').setHandler(qa).setErrorHandler(qa).setData({sidebar_mode:q.isEnabled(),window_id:ca.getSessionID()}).setAllowCrossPageTransition(true).send();}function tb(){var vb=true;if(!q.isEnabled()){fb.log('state_not_enabled');vb=false;}if(!r.isViewportCapable())if(!r.isViewportCapableForMiniSidebar()){fb.log('state_not_shown_viewport_mini');vb=false;}if(vb)k.bumpEntityKey(sa,'state_viewport_can_show');if(r.hasLowFriendCount()){fb.log('state_not_shown_num_friends');vb=false;}var wb=vb?'state_shown':'state_not_shown';fb.log(wb);k.bumpEntityKey(sa,wb);}var ub={init:function(vb,wb,xb){ub.init=qa;o.loaded();za=vb;ab=wb;cb=xb;ta=t.find(vb,'div.fbChatSidebarBody');xa=t.find(vb,"._51x-");ya=t.find(vb,"._51x_");bb=t.find(vb,"._5qqe");var yb=t.find(vb,"._x1u");if(yb)ea.render(da.createElement(p,{className:"_3a-4 _5q85"}),yb);if(m.get('sidebar_react_dropdown',false)){var zb=t.find(vb,"._1ltf");if(zb)ga.onAfterLoad(function(){l.loadModules(["ChatSidebarDropdown.react","SidebarType"],function(bc,cc){ea.render(da.createElement(bc,{sidebarType:cc.SIDEBAR,onToggleSidebar:o.disable}),zb);});});}v.listen(window,'resize',lb);x.registerKey('q',function(event){if(q.getVisibleType()!==ha.SIDEBAR)return;if(!ua)ua=t.scry(vb,'.inputsearch')[0];if(ua){ua.focus();event.prevent();}});var ac=t.find(vb,'div.fbChatSidebarMessage div.message');if(ac)ga.onAfterLoad(function(){l.loadModules(["ChatSidebarSheet.react"],function(bc){ea.render(da.createElement(bc,{root:vb,onUpdate:pb}),ac,pb);});});ab.setScrollContainer(aa.byClass(ab.getRoot(),'uiScrollableAreaWrap'));ab.subscribe(['render','show','hide'],pa(function(bc){var cc=ia.getInstance(ab.getRoot());cc&&cc.adjustGripper();}));h.subscribe('chat/option-changed',function(bc,cc){if(cc.name==='hide_groups')pb();});h.subscribe(['AppsDivebar/show-apps','AppsDivebar/hide-apps','Ticker/resized'],pb);xb.getCore().subscribe('sidebar/typeahead/active',ib);xb.subscribe('reset',function(){if(!xb.getCore().getValue()&&!ab.isVisible())ib(null,false);});ba.subscribe('privacy-user-presence-changed',lb);q.addListener(function(){var bc=q.getState(),cc=q.getPrevState();if(bc.visible!==cc.visible)switch(bc.visible){case ha.SIDEBAR:ob();break;case ha.MINI_SIDEBAR:rb();break;case ha.BUDDYLIST:kb();break;}if(bc.enabled!==cc.enabled){if(bc.enabled)setTimeout(mb,0);sb();}});lb();n.init(ab);la.addPersistentRight(jb);ub.inform('sidebar/initialized',ub,h.BEHAVIOR_PERSISTENT);h.inform('sidebar/initialized',ub,h.BEHAVIOR_PERSISTENT);eb=new ja(bb);eb.subscribe('resized',lb);},ensureLoaded:function(){if(!q.isEnabled())return;if(q.isLoaded())return;if(ra('pagelet_sidebar'))return;e(['UIPagelet'],function(vb){var wb=t.create('div',{id:'pagelet_sidebar'});t.appendContent(document.body,wb);vb.loadFromEndpoint('SidebarPagelet','pagelet_sidebar');});o.loaded();},hide:function(){if(!q.isEnabled())return;o.disable();},unhide:function(){if(q.isEnabled())return;o.enable();}};Object.assign(ub,i);f.exports=ub;},null);
__d('ChatTypeaheadBehavior',['BanzaiLogger','ChatOpenTab','ChatTypeaheadEvent','CSS','MercuryTypeaheadConstants','Parent','Rect','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();function p(r,s){var t=m.byClass(r,"_4oes");if(t)k.conditionClass(t,"_5q83",s);}function q(r){'use strict';this._typeahead=r;this._loggedQuery=false;}q.prototype.enable=function(){'use strict';var r=this._typeahead;this._subscriptions=[r.subscribe('focus',(function(){this._loggedQuery=false;r.getData().refreshData();p(r.getElement(),true);}).bind(this)),r.subscribe('blur',(function(s){if(this._loggedQuery)h.log('ChatTypeaheadLoggerConfig',{event:j.ABANDONED_QUERY,max_results:r.getData().getMaxResults(),num_friend_results:r.getView().results.filter(function(t){return t.render_type===l.FRIEND_TYPE;}).length,query:r.getCore().value});r.getCore().reset();p(r.getElement(),false);this._loggedQuery=false;}).bind(this)),r.subscribe('respond',(function(s,t){if(!this._loggedQuery&&r.getCore().getValue().length>0){h.log('ChatTypeaheadLoggerConfig',{event:j.NEW_QUERY});this._loggedQuery=true;}if(t.value&&t.value===r.getCore().getValue()){if(!t.results.length){var u=t.value.toLowerCase(),v=r.getData().getQueryCache();if(!t.isAsync&&!v.hasOwnProperty(u))return;r.getView().showNoResults();}k.addClass(r.getElement(),'hasValue');}}).bind(this)),r.subscribe('reset',function(){k.removeClass(r.getElement(),'hasValue');}),r.subscribe('select',(function(s,t){var u=t.selected.uid;if(t.selected.mercury_thread&&!t.selected.mercury_thread.is_canonical)u=t.selected.mercury_thread.thread_fbid;r.getView().hide();h.log('ChatTypeaheadLoggerConfig',{event:j.RESULT_SELECTED,max_results:r.getData().getMaxResults(),result_type:t.selected.render_type,query:r.getCore().value});this._loggedQuery=false;i.openTabByType(u,t.selected.type,'typeahead');}).bind(this)),r.subscribe('highlight',function(s,t){if(t.index>=0){var u=r.getView().getItems()[t.index];if(u){var v=new n(u),w=u.offsetParent,x=v.boundWithin(new n(w)).getPositionVector();v.getPositionVector().sub(x).scrollElementBy(w);}}})];};q.prototype.disable=function(){'use strict';this._subscriptions.forEach(function(r){this._typeahead.unsubscribe(r);},this);this._subscriptions=null;};Object.assign(q.prototype,{_subscriptions:null});f.exports=q;},null);
__d('NubController',['ArbiterMixin','Dock'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(){}Object.assign(j.prototype,h,{init:function(k){this.el=k;i.registerNubController(k,this);return this;},buttonContentChanged:function(){this.inform('nub/button/content-changed');},flyoutContentChanged:function(){this.inform('nub/flyout/content-changed');},hide:function(){i.hide(this.el);},show:function(){i.show(this.el);}});f.exports=j;},null);
__d('ChatActivity',['Event','Arbiter','AvailableList','AvailableListConstants','JSLogger','MercuryConfig','PresenceState','UserActivity'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=m.activity_limit||60000,q=m.idle_limit||1800000,r=m.idle_poll_interval||300000,s=l.create('chat_activity'),t=Date.now(),u=t,v=true;function w(){var aa=Date.now();return !!(v&&aa-t<p);}var x=Object.assign(new i(),{isActive:w});function y(){var aa=t;t=Date.now();if(t-aa>q){s.debug('idle_to_active',aa);n.doSync();}x.inform('activity');}j.subscribe(k.ON_AVAILABILITY_CHANGED,function(){if(!j.isUserIdle())u=Date.now();});h.listen(window,'focus',function(){v=true;y();});h.listen(window,'blur',function(){v=false;});o.subscribe(function(){y();});function z(aa){var ba=aa&&aa.at&&n.verifyNumber(aa.at);if(typeof ba!=='number')ba=null;return ba||0;}setInterval(function(){var aa=Date.now(),ba=z(n.get()),ca=Math.max(t,ba,u);if(aa-ca>q){s.debug('idle',{cookie:ba,local:t,presence:u});x.inform('idle',aa-ca);}},r);n.registerStateStorer(function(aa){var ba=z(aa);if(ba<t)aa.at=t;return aa;});i.subscribe(l.DUMP_EVENT,function(aa,ba){ba.chat_activity={activity_limit:p,idle_limit:q,idle_poll_interval:r,last_active_time:t,last_global_active_time:u};});f.exports=x;},null);
__d('FBRTCCallBlockingStore',['Arbiter','AsyncRequest','BanzaiLogger','ChannelConstants','FBRTCDispatcher','FBRTCStore','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o,p;'use strict';var q=false,r=0,s=null,t='call_block_setting_changed';o=babelHelpers.inherits(u,m);p=o&&o.prototype;u.prototype.init=function(v){this.$FBRTCCallBlockingStore1(v);h.subscribe(k.getArbiterType('videocall_block_setting'),this.$FBRTCCallBlockingStore2.bind(this));};u.prototype.__onDispatch=function(v){if(v.type!==t)return;this.$FBRTCCallBlockingStore1(v.data);};u.prototype.$FBRTCCallBlockingStore1=function(v){switch(v){case 0:q=false;this.$FBRTCCallBlockingStore3();break;case -1:q=true;this.$FBRTCCallBlockingStore3();break;default:q=true;this.$FBRTCCallBlockingStore4(v);}this.__emitChange();};u.prototype.$FBRTCCallBlockingStore4=function(v){if(s===null)s=n(this.turnOnVideoCalling.bind(this),v*1000);};u.prototype.getBlockingStatus=function(){return q;};u.prototype.turnOnVideoCalling=function(){new i('/ajax/chat/settings.php').setHandler(this.$FBRTCCallBlockingStore5.bind(this)).setData({call_blocked_until:0}).send();};u.prototype.turnOffVideoCalling=function(v){r=v;new i('/ajax/chat/settings.php').setHandler(this.$FBRTCCallBlockingStore6.bind(this)).setData({call_blocked_until:v}).send();};u.prototype.$FBRTCCallBlockingStore3=function(){if(s){clearTimeout(s);s=null;}};u.prototype.$FBRTCCallBlockingStore5=function(){l.dispatch({type:t,data:0});j.log('VideoCallLoggerConfig',{event:t,message:'enable'});};u.prototype.$FBRTCCallBlockingStore6=function(){l.dispatch({type:t,data:r});j.log('VideoCallLoggerConfig',{event:t,message:'disable_'+r});};u.prototype.$FBRTCCallBlockingStore2=function(v,w){l.dispatch({type:t,data:w.obj.value});};function u(){o.apply(this,arguments);}f.exports=new u();},null);
__d('MercuryMessages',['BanzaiODS','EventEmitter','ImmutableObject','LogHistory','Map','MercuryActionStatus','MercuryActionType','MercuryAssert','MercuryDispatcher','MercuryLogMessageType','MercuryMessageClientState','MercuryPayloadSource','MercurySingletonMixin','MercuryMessageActions','MercuryMessageIDs','RangedCallbackManager','MercurySendMessageFields','MercuryServerRequests','MercuryThreadActions','MercuryThreadInformer','MercuryThreads','URI','invariant','isMessengerDotComURI','mergeDeep','setImmediate'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){'use strict';if(c.__markCompiled)c.__markCompiled();var ha=new i(),ia=k.getInstance('mercury_messages');function ja(sa,ta){var ua=ta;if(sa._localIdsMap[ta])ua=sa._localIdsMap[ta];return sa._messages.get(ua);}function ka(sa){switch(sa){case s.UNKNOWN:case s.SERVER_INITIAL_DATA:case s.SERVER_FETCH_THREAD_INFO:case s.SERVER_THREAD_SYNC:return true;}return false;}function la(sa,ta){if(!sa._threadsToMessages[ta])sa._threadsToMessages[ta]=new w(function(ua){return ja(sa,ua).timestamp;},function(ua,va){return va-ua;});return sa._threadsToMessages[ta];}function ma(sa,ta,ua){ta.forEach(function(va){var wa=la(sa,va);wa.setReachedEndOfArray();sa._emitReorderedChange(va,ua);});}function na(sa){this._fbid=sa;this._messageActions=u.getForFBID(this._fbid);this._serverRequests=y.getForFBID(this._fbid);this._threadInformer=aa.getForFBID(this._fbid);this._threads=ba.getForFBID(this._fbid);this._threadActions=z.getForFBID(this._fbid);this._dispatcher=p.getForFBID(this._fbid);this._didChange=false;this._failedHistoryFetchThreads={};this._threadsToMessages={};this._localTitanMessagesCount={};this._messages=new l();this._localIdsMap={};this._dispatcher.subscribe('update-messages',(function(ta,ua){var va=(ua.actions||[]).filter(function(xa){var ya=xa.action_type,za=(xa.is_forward||xa.thread_id)&&(ya==n.LOG_MESSAGE||ya==n.USER_GENERATED_MESSAGE||ya==n.SEND_MESSAGE||ya==n.DELETE_THREAD||ya==n.DELETE_MESSAGES||ya==n.MARK_MESSAGES_SPAM),ab=xa.upload_id&&xa.upload_data&&(ya==n.CANCEL_ATTACHMENT_PLACEHOLDER||ya==n.CONFIRM_ATTACHMENT_PLACEHOLDER),bb=xa.note&&ya==n.CREATE_PAGE_ADMIN_NOTE;return za||ab||bb;}),wa=ka(ua.payload_source);this.handleUpdates(va,wa,ua.payload_source,ua.from_client);if(ua.end_of_history)ma(this,ua.end_of_history,ua.payload_source);if(this._didChange){this._didChange=false;ha.emit('change');}}).bind(this));ia.debug('constructed',{fbid:this._fbid});}Object.assign(na.prototype,{getMessagesFromIDs:function(sa){return (sa||[]).map(ja.bind(null,this)).filter(function(ta){return ta;});},getServerMessageID:function(sa){var ta=sa;if(this._localIdsMap[sa])ta=this._localIdsMap[sa];return ta;},hasLoadedNMessages:function(sa,ta){var ua=la(this,sa);return ua.hasReachedEndOfArray()||ua.getCurrentArraySize()>=ta;},hasLoadedExactlyNMessages:function(sa,ta){var ua=la(this,sa);return ua.getCurrentArraySize()==ta;},clearMercuryInternalState_DO_NOT_USE:function(){this._failedHistoryFetchThreads={};this._threadsToMessages={};this._localTitanMessagesCount={};this._messages=new l();this._localIdsMap={};},getThreadMessagesRange:function(sa,ta,ua,va,wa,xa){var ya=la(this,sa),za=(function(jb){va(oa(this,jb));}).bind(this),ab=ya.executeOrEnqueue(ta,ua,za),bb=ya.getUnavailableResources(ab),cb=this._failedHistoryFetchThreads[sa];if(bb.length&&!cb){var db=ya.getCurrentArraySize(),eb=this._localTitanMessagesCount[sa]||0,fb=db-eb,gb=bb.length+eb,hb=this.getCurrentlyLoadedMessages(sa),ib=hb.length?hb[0].timestamp:null;ia.debug('fetch_missing_messages',{threadID:sa,offset:ta,limit:ua,timestamp:ib,missingIndices:bb,messageCount:db,localMessageCount:eb});this._serverRequests.fetchThreadMessages(sa,fb,gb,ib,wa,xa);}else this._failedHistoryFetchThreads[sa]=false;return ab;},getThreadMessagesRangeNow:function(sa,ta,ua){var va=la(this,sa),wa=[];for(var xa=ta;xa<ta+ua;xa++){var ya=va.getResourceAtIndex(xa),za=ja(this,ya);za&&wa.push(za);}return wa;},getThreadMessagesSinceTimestamp:function(sa,ta){var ua=la(this,sa),va=ua.getElementsUntil(ta);return oa(this,va);},hasLoadedAllMessages:function(sa){return la(this,sa).hasReachedEndOfArray();},getCurrentlyLoadedMessages:function(sa){var ta=la(this,sa).getAllResources();return oa(this,ta);},unsubscribe:function(sa,ta){o.isThreadID(ta);var ua=la(this,ta);ua.unsubscribe(sa);},_addNewMessage:function(sa,ta){ra(ta);this._messages.set(sa,new j(ta));},_addNewPageAdminNote:function(sa,ta){var ua=this._messages.get(sa);if(ua){var va=ua.page_admin_notes?ua.page_admin_notes.slice():[],wa=false,xa=true;for(var ya=0;ya<va.length;++ya)if(va[ya].id===ta.id){wa=true;xa=false;break;}else if((va[ya].id===null||va[ya].id===undefined)&&va[ya].body===ta.body){wa=true;va[ya]=ta;}if(!wa)va.push(ta);if(xa){var za={};za.page_admin_notes=va;this._updateMessage(sa,ua,za);}}},_updateMessage:function(sa,ta,ua){var va=j.set(ta,ua);this._messages.set(sa,va);return va;},_shouldSortOutOfOrderMessages:function(sa,ta,ua){if(sa==s.CLIENT_CHANNEL_MESSAGE){var va=this.getThreadMessagesSinceTimestamp(ta,ua);if(va.length>0){h.bumpEntityKey('chat.web','channel.messages_reordered');return true;}}return false;},_preprocessIncomingAction:function(sa,ta){var ua=sa.action_type;if(ta==s.CLIENT_CHANNEL_MESSAGE&&ua==n.USER_GENERATED_MESSAGE&&sa.offline_threading_id&&this._localIdsMap[sa.offline_threading_id]===sa.offline_threading_id){sa.client_message_id=sa.offline_threading_id;sa.status=m.SUCCESS;sa.action_type=n.SEND_MESSAGE;ua=sa.action_type;}if(ta===s.CLIENT_CHANNEL_MESSAGE&&ua==n.USER_GENERATED_MESSAGE){var va=this._threads.getThreadMetaNow(sa.thread_id);if(va&&va.folder)sa.folder=va.folder;}return sa;},handleUpdates:function(sa,ta,ua,va){var wa,xa={};for(var ya=0;ya<sa.length;ya++){var za=this._preprocessIncomingAction(sa[ya],ua),ab=za.action_type,bb=ja(this,za.message_id);if(ab==n.LOG_MESSAGE)if(this.isLocalMessage(za))continue;if(za.is_forward||ua==s.SERVER_SEARCH){if(!this._messages.has(za.message_id))this._addNewMessage(za.message_id,za);continue;}else if(za.client_state===r.SEND_TO_SERVER){this._addNewMessage(za.message_id,za);continue;}else if(ab==n.SEND_MESSAGE){var cb=za.client_message_id;if(cb&&this._localIdsMap[cb]&&za.status){var db=ja(this,cb),eb=db.status;if(db.status==m.SUCCESS)continue;if(!xa[za.thread_id])xa[za.thread_id]=[];this._updateLocalMessage(za);if(typeof eb!==undefined||za.status==m.FAILED_UNKNOWN_REASON||za.status==m.UNABLE_TO_CONFIRM||za.status==m.SUCCESS||za.status==m.ERROR)this._emitUpdatedChange(za.thread_id,ja(this,cb).message_id,ua);}continue;}else if(ab==n.DELETE_THREAD){la(this,za.thread_id).removeAllResources();continue;}else if(ab==n.DELETE_MESSAGES){this._deleteMessages(za.thread_id,za.message_ids,ua);ga((function(){this._threadActions.updateSnippet(za.thread_id,za.message_ids);}).bind(this));continue;}else if(ab==n.CREATE_PAGE_ADMIN_NOTE){this._addNewPageAdminNote(za.message_id,za.note);this._emitUpdatedChange(za.thread_id,za.message_id,'link_shim');continue;}else if(za.offline_threading_id&&this._localIdsMap[za.offline_threading_id]||bb&&!bb.is_forward){if(bb&&za.ranges&&za.ranges.length>0){var fb=bb.message_id;this._updateMessage(this._localIdsMap[fb]||fb,bb,{ranges:sa.ranges});this._emitUpdatedChange(bb.thread_id,bb.message_id,'link_shim');}continue;}else if(ab===n.CONFIRM_ATTACHMENT_PLACEHOLDER){this._confirmAttachmentPlaceholder(za.upload_id,za.upload_data);continue;}else if(ab===n.CANCEL_ATTACHMENT_PLACEHOLDER){this._cancelAttachmentPlaceholder(za.upload_id,za.upload_data);continue;}else{if(ua===s.CLIENT_SEND_MESSAGE){this._localIdsMap[za.message_id]=za.message_id;if(za.thread_id=='root:'+za.offline_threading_id)la(this,za.thread_id).setReachedEndOfArray();}if(ab==n.LOG_MESSAGE&&za.log_message_type==q.SERVER_ERROR)this._failedHistoryFetchThreads[za.thread_id]=true;if(za.client_state===r.DO_NOT_SEND_TO_SERVER&&za.upload_id)this._uploadMessages[za.upload_id]=za;if(!xa[za.thread_id])xa[za.thread_id]=[];xa[za.thread_id].push(za.message_id);this._addNewMessage(za.message_id,za);if(za.offline_threading_id&&za.offline_threading_id!=za.message_id){this._localIdsMap[za.offline_threading_id]=za.message_id;v.addServerID(za.offline_threading_id,za.message_id);if(za.threading_id)v.addServerID(za.threading_id,za.message_id);}if(za[x.MANUAL_RETRY_CNT]>0){wa=la(this,za.thread_id);wa.resortResources([za.message_id]);this._emitReorderedChange(za.thread_id,s.CLIENT_SEND_MESSAGE);}ta=ta||this._shouldSortOutOfOrderMessages(ua,za.thread_id,za.timestamp);if(!ta)this._emitReceivedChange(ja(this,za.message_id));continue;}}for(var gb in xa){wa=la(this,gb);var hb=wa.getAllResources(),ib=hb.filter((function(jb){var kb=this._messages.get(jb);return kb.action_type==n.LOG_MESSAGE&&kb.log_message_type==q.SERVER_ERROR;}).bind(this));wa.removeResources(ib);if(va)pa(this,gb,xa[gb]);if(ta){wa.addResources(xa[gb]);this._emitReorderedChange(gb,ua);}else wa.addResourcesWithoutSorting(xa[gb].reverse(),0);this._threadInformer.updatedThread(gb);}this._didChange&&ia.debug('handle_updates',{localMessageCounts:fa(this._localTitanMessagesCount)});},isFirstMessage:function(sa){var ta=la(this,sa.thread_id);if(ta.getCurrentArraySize()===0)return false;var ua=ta.getResourceAtIndex(ta.getCurrentArraySize()-1),va=ja(this,ua).message_id,wa=ja(this,sa.message_id).message_id;return ta.hasReachedEndOfArray()&&va==wa;},isLocalMessage:function(sa){if(sa.offline_threading_id!==null&&sa.offline_threading_id===sa.message_id)return true;if(sa.threading_id!==null&&sa.threading_id===sa.message_id)return true;return false;},_deleteMessages:function(sa,ta,ua){if(!ta.length)return;this._deleteIndividualMessages(sa,ta,ua);if(ua!==s.CLIENT_CHANNEL_MESSAGE)this._serverRequests.deleteMessages(sa,ta);},_deleteIndividualMessages:function(sa,ta,ua){var va=ta.map(function(xa){return ja(this,xa).message_id;},this),wa=la(this,sa);wa.removeResources(va);this._emitReorderedChange(sa,ua);},_updateLocalMessage:function(sa){var ta=ja(this,sa.client_message_id),ua={};ua.status=sa.status;if(sa.status===m.SUCCESS||sa.error_data)ua.error_data=sa.error_data;var va=sa.message_id,wa=sa.client_message_id;if(this._messages.has(va)){this._updateMessage(va,ta,ua);return false;}if(sa.threading_id)ua.threading_id=sa.threading_id;if(sa.timestamp)ua.timestamp=sa.timestamp;if(sa.log_message_data)ua.log_message_data=sa.log_message_data;if(sa.ranges&&sa.ranges.length){ra(sa);ua.ranges=sa.ranges;}if(sa.attachments&&sa.attachments.length){ua.raw_attachments=null;ua.attachments=sa.attachments;}this._localIdsMap[wa]=va;v.addServerID(wa,va);var xa=this._updateMessage(va,ta,ua);this._messages.set(wa,new j());if(qa(xa))this._localTitanMessagesCount[xa.thread_id]--;return true;},getNumberLocalMessages:function(sa){return this._localTitanMessagesCount[sa]||0;},_uploadMessages:{},_confirmAttachmentPlaceholder:function(sa,ta){var ua=this._popPendingAttachmentMessage(sa,ta);delete ua.preview_attachments;this._serverRequests.sendNewMessage(ua);},_cancelAttachmentPlaceholder:function(sa,ta){var ua=this._popPendingAttachmentMessage(sa,ta);this._deleteIndividualMessages(ua.thread_id,[ua.message_id]);if(this._localTitanMessagesCount[ua.thread_id])this._localTitanMessagesCount[ua.thread_id]--;},_popPendingAttachmentMessage:function(sa,ta){var ua=this._uploadMessages[sa];!ua?da(0):undefined;ua.image_ids=ta.image_ids;ua.file_ids=ta.file_ids;ua.audio_ids=ta.audio_ids;ua.gif_ids=ta.gif_ids;ua.video_ids=ta.video_ids;ua.client_state=r.SEND_TO_SERVER;delete this._uploadMessages[sa];return ua;},_emitUpdatedChange:function(sa,ta,ua){this._didChange=true;this._threadInformer.updatedMessage(sa,ta,ua);},_emitReceivedChange:function(sa){this._didChange=true;this._threadInformer.receivedMessage(sa);},_emitReorderedChange:function(sa,ta){this._didChange=true;this._threadInformer.reorderedMessages(sa,ta);}});Object.assign(na,t,{addListener:function(sa,ta){return ha.addListener(sa,ta);}});function oa(sa,ta){var ua=ta.map(ja.bind(null,sa));return ua.reverse();}function pa(sa,ta,ua){var va=ua.filter(function(wa){return qa(ja(sa,wa));});if(!sa._localTitanMessagesCount[ta])sa._localTitanMessagesCount[ta]=0;sa._localTitanMessagesCount[ta]+=va.length;}function qa(sa){var ta=sa.action_type;if(ta==n.USER_GENERATED_MESSAGE)return true;switch(sa.log_message_type){case q.SUBSCRIBE:case q.UNSUBSCRIBE:case q.SERVER_ERROR:case q.LIVE_LISTEN:return false;default:return true;}}function ra(sa){if(!sa.ranges)return;sa.ranges.forEach(function(ta){if(!ta.entity||ta.entity.external||!ta.entity.url)return;var ua=new ca(ta.entity.url);if(ea(ca.getRequestURI())&&!ua.getDomain()){ua.setProtocol('https').setDomain('www.facebook.com');ta.entity.url=ua.toString();}});}f.exports=na;},null);
__d('MercuryNotificationRenderer',['MercuryAssert','MercuryParticipants','MercuryViewer','fbt','MercuryMessages','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=c('MercuryMessages').get(),m=c('MercuryThreads').get();function n(o,p){h.isThreadID(o);m.getThreadMeta(o,function(q){l.getThreadMessagesRange(o,0,1,function(r){var s=r.length&&r[r.length-1];if(s&&s.author!=j.getID()){i.get(s.author,function(t){if(q.name){p(k._("{senderName} hat {groupName} eine Nachricht geschickt",[k.param('senderName',t.short_name),k.param('groupName',q.name)]));}else p(k._("{name} hat dir eine Nachricht geschickt",[k.param('name',t.short_name)]));});}else p(k._("Neue Nachricht!"));});});}f.exports={renderDocumentTitle:n};},null);
__d('MercuryTimestampTracker',['MercuryActionType','MercuryPayloadSource','MercurySingletonMixin','MercuryDispatcher'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m){this._fbid=m;this._dispatcher=k.getForFBID(this._fbid);this._lastTimestamp=0;this._dispatcher.subscribe('update-messages',(function(n,o){if(!o.actions||!o.actions.length)return;if(o.payload_source==i.CLIENT_SEND_MESSAGE||o.payload_source==i.UNKNOWN)return;for(var p=0;p<o.actions.length;p++){var q=o.actions[p],r=q.action_type;if(r==h.USER_GENERATED_MESSAGE&&q.thread_id&&q.timestamp>this._lastTimestamp)this._lastTimestamp=q.timestamp;}}).bind(this));}Object.assign(l.prototype,{getLastUserMessageTimestamp:function(){return this._lastTimestamp;}});Object.assign(l,j);f.exports=l;},null);
__d('ChatTitleBarBlinker',['ChatActivity','ChatConfig','DocumentTitle','FavIcon','JSLogger','MercuryNotificationRenderer','PresenceState','MercuryThreadInformer','MercuryTimestampTracker'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=c('MercuryThreadInformer').get(),p=c('MercuryTimestampTracker').get(),q=l.create('chat_title'),r=null,s=0,t=false;if(i.get('unreadFavicon'))k.setToggleResources(i.get('unreadFaviconURL'));function u(){if(r){r.stop();r=null;return true;}return false;}function v(aa){var ba=aa||p.getLastUserMessageTimestamp();if(s<=ba){s=ba;if(u()||t)n.doSync();}if(i.get('unreadFavicon')&&k.isToggledResource())k.toggle();}var w={blink:function(aa,ba){if(!r&&s<ba)m.renderDocumentTitle(aa,function(ca){if(!r)r=j.blink(ca);});},stopBlinking:function(){v();},blinkingElsewhere:function(){t=true;}};function x(aa){var ba=n.verifyNumber(aa.sb2);if(!ba||ba<=s)return null;return ba;}function y(aa){var ba=aa&&x(aa);if(ba){s=ba;q.debug('load',s);u();t=false;}}function z(aa){var ba=x(aa);if(!ba){q.debug('store',s);aa.sb2=s;t=false;}return aa;}n.registerStateStorer(z);n.registerStateLoader(y);o.subscribe('thread-read-changed',function(aa,ba){var ca=p.getLastUserMessageTimestamp(),da=0;for(var ea in ba)if(ba[ea].mark_as_read&&ba[ea].timestamp>=ca&&ba[ea].timestamp>da)da=ba[ea].timestamp;da&&v(da);});h.subscribe('activity',function(){v();});(function(){var aa=n.getInitial();if(aa)s=x(aa)||0;})();f.exports=w;},null);
__d('MercuryGroupThreadMentions',['CurrentUser','ShortProfiles'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={messageMentionsViewer:function(k,l){i.get(h.getID(),function(m){l(new RegExp('@'+m.firstName,'i').test(k.body));});}};f.exports=j;},null);
__d('MercuryBrowserAlerts',['ArbiterMixin','ChatActivity','ChatConfig','ChatOptions','ChatTitleBarBlinker','MercuryConfig','MercuryGroupThreadMentions','MercuryThreadInfo','MercuryViewer','MessagingTag','Sound','MercuryBlockedParticipants','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s=c('MercuryBlockedParticipants').get(),t=c('MercuryThreads').get();r.init(['audio/ogg','audio/mpeg']);function u(w){if(k.getSetting('sound'))r.play([j.get('sound.notif_ogg_url'),j.get('sound.notif_mp3_url')],w,false);}var v={messageReceived:function(w){if(p.isViewer(w.author)||!w.is_unread||w.folder!=q.INBOX&&w.folder!=q.ARCHIVED)return;var x=w.thread_id,y=i.isActive();if(y){var z=false;v.inform('before-alert',{threadID:x,cancelAlert:function(){z=true;}});}t.getThreadMeta(x,function(aa){var ba=o.isMuted(aa);n.messageMentionsViewer(w,function(ca){if(ba&&(!m.GroupChatMentionsGK||!ca))return;if(s.isPresentInGroupThread(aa))return;var da=w.timestamp;if(y){!z&&u(da);}else{l.blink(x,da);u(da);}l.blinkingElsewhere();});});}};f.exports=Object.assign(v,h);},null);
__d('ChatPerfInstrumentation',['BanzaiLogger','ChatPerfEvent','Promise','emptyFunction','performanceAbsoluteNow'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m={_startTime:(Number),init:function(){this._startTime=l();return new j(function(n){return n();});},_log:function(event){h.log('ChatPerfLoggerConfig',{event:event,duration:l()-this._startTime});},logTTI:function(){this.logTTI=k;this._log(i.TTI);},logCHAT_CONVERSATION_TTI:function(){this.logCHAT_CONVERSATION_TTI=k;this._log(i.CHAT_CONVERSATION_TTI);}};f.exports=m;},null);
__d('MercuryDelayedDispatcher',['MercuryDispatcher','MercuryServerPayloadPreprocessor','MercuryServerRequests','MercurySingletonProvider','MercuryThreadIDMap'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();function m(o){this.$MercuryDelayedDispatcher1=o;this.$MercuryDelayedDispatcher2=[];this.$MercuryDelayedDispatcher3=l.getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher4=h.getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher5=j.getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher6=i.getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher4.subscribe('model-update-completed',(function(p,q){return this.$MercuryDelayedDispatcher7();}).bind(this));}m.getForFBID=function(o){return n.getForFBID(o);};m.get=function(){return n.get();};m.prototype.handleUpdateWaitForThread=function(o,p){var q=this.$MercuryDelayedDispatcher3.getClientIDFromServerIDNow(p);if(q){this.$MercuryDelayedDispatcher8(o);return;}this.$MercuryDelayedDispatcher3.getClientIDFromServerID(p,(function(){return this.$MercuryDelayedDispatcher2.push(o);}).bind(this));this.$MercuryDelayedDispatcher5.ensureThreadIsFetched(p);};m.prototype.$MercuryDelayedDispatcher7=function(){if(this.$MercuryDelayedDispatcher2&&this.$MercuryDelayedDispatcher2.length){var o=this.$MercuryDelayedDispatcher2[0];this.$MercuryDelayedDispatcher2=this.$MercuryDelayedDispatcher2.slice(1);this.$MercuryDelayedDispatcher8(o);}};m.prototype.$MercuryDelayedDispatcher8=function(o){if(o.from_client){this.$MercuryDelayedDispatcher4.handleUpdate(o);}else this.$MercuryDelayedDispatcher6.handleUpdate(o);};var n=new k(m);f.exports=m;},null);
__d('MercuryChannelHandler',['Arbiter','ChannelConstants','MercuryActionType','MercuryConfig','MercuryDelayedDispatcher','MercuryGlobalActionType','MercuryMessages','MercuryPayloadSource','MercuryServerPayloadPreprocessor','MercurySingletonMixin','MercuryThreadInformer','MercuryViewer','MessagingEvent','MessagingReliabilityLogger','MessagingTag','PresenceUtil','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();var y,z;y=babelHelpers.inherits(aa,x(q));z=y&&y.prototype;function aa(ba){'use strict';z.constructor.call(this);this.$MercuryChannelHandler1=ba;this.__payloadPreprocessor=p.getForFBID(this.$MercuryChannelHandler1);this.$MercuryChannelHandler2=r.getForFBID(this.$MercuryChannelHandler1);this.$MercuryChannelHandler3=n.getForFBID(this.$MercuryChannelHandler1);this.__delayedDispatcher=l.getForFBID(this.$MercuryChannelHandler1);this.$MercuryChannelHandler4=[];}aa.prototype.getInstanceFBID=function(){'use strict';return this.$MercuryChannelHandler1;};aa.prototype.$MercuryChannelHandler5=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj||!ca.obj.message){u.addEntry('channel_receive','invalid_data');return;}var da=ca.obj.message,ea=da.other_user_fbid?da.other_user_fbid:da.thread_fbid;ea=ea.toString();var fa={author:da.mercury_author_id,author_email:da.mercury_author_email,body:da.body,subject:da.subject,has_attachment:da.has_attachment,attachments:da.attachments,html_body:da.html_body,thread_id:da.tid,thread_fbid:da.thread_fbid&&da.thread_fbid.toString(),other_user_fbid:da.other_user_fbid&&da.other_user_fbid.toString(),offline_threading_id:da.offline_threading_id,message_id:da.mid,is_spoof_warning:da.is_spoof_warning,ranges:da.ranges,source:da.mercury_source,source_tags:da.mercury_source_tags,threading_id:da.threading_id,timestamp:da.timestamp,timestamp_absolute:da.timestamp_absolute,timestamp_relative:da.timestamp_relative,timestamp_datetime:da.timestamp_datetime,timestamp_time_passed:da.timestamp_time_passed,action_type:j.USER_GENERATED_MESSAGE,is_unread:da.is_unread,is_forward:false,forward_count:da.forward_count||da.forward,forward_message_ids:da.forward_msg_ids,folder:ca.obj.folder};if("sync_id" in da){fa.sync_id=da.sync_id;}else fa.action_id=da.action_id;if(k.WWWSyncMsgText&&!da.has_attachment)return;var ga=[babelHelpers._extends({},fa)];ga=ga.concat(da.forward_actions||[]);var ha=o.CLIENT_CHANNEL_MESSAGE;this.__delayedDispatcher.handleUpdateWaitForThread({actions:ga,payload_source:ha},ea);u.addEntry('channel_receive','success',[ea,fa.message_id,w.getSessionID()]);};aa.prototype.$MercuryChannelHandler7=function(ba,ca){'use strict';var da=ca.obj.other_user_fbid,ea=ca.obj.thread_fbid;if(!this.$MercuryChannelHandler6(ba)||!da&&!ea)return;this.__payloadPreprocessor.handleUpdate({delivery_receipts:[{other_user_fbid:da?da.toString():'',thread_fbid:ea?ea.toString():'',time:ca.obj.timestamp}]});};aa.prototype.$MercuryChannelHandler8=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj||!ca.obj.thread_fbids&&!ca.obj.other_user_fbids)return;var da=[],ea=ca.obj.event==t.READ;(ca.obj.thread_fbids||[]).forEach(function(fa){da.push({action_type:j.CHANGE_READ_STATUS,action_id:null,thread_fbid:fa,mark_as_read:ea,timestamp:ca.obj.timestamp||0,folder:ca.obj.folder_info[fa]});});(ca.obj.other_user_fbids||[]).forEach(function(fa){da.push({action_type:j.CHANGE_READ_STATUS,action_id:null,other_user_fbid:fa,mark_as_read:ea,timestamp:ca.obj.timestamp||0,folder:ca.obj.folder_info[fa]});});this.__payloadPreprocessor.handleUpdate({actions:da,payload_source:o.CLIENT_CHANNEL_MESSAGE});};aa.prototype.$MercuryChannelHandler9=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj||!(ca.obj.thread_fbids||ca.obj.other_user_fbids))return;var da=[];(ca.obj.thread_fbids||[]).forEach(function(ea){da.push({action_type:j.DELETE_THREAD,action_id:null,thread_fbid:ea});});(ca.obj.other_user_fbids||[]).forEach(function(ea){da.push({action_type:j.DELETE_THREAD,action_id:null,other_user_fbid:ea});});this.__payloadPreprocessor.handleUpdate({actions:da,payload_source:o.CLIENT_CHANNEL_MESSAGE});};aa.prototype.$MercuryChannelHandler10=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj||!ca.obj.thread_fbids&&!ca.obj.other_user_fbids||!ca.obj.mids)return;var da=ca.obj.thread_fbids.length?ca.obj.thread_fbids[0]:null,ea=ca.obj.other_user_fbids.length?ca.obj.other_user_fbids[0]:null,fa={action_type:j.DELETE_MESSAGES,action_id:null,thread_fbid:da,other_user_fbid:ea,message_ids:ca.obj.mids};if(k.MessengerGlobalDeleteGK){if(ca.obj.updated_thread)return;this.__payloadPreprocessor.handleUpdate({actions:[fa],payload_source:o.CLIENT_CHANNEL_MESSAGE});return;}this.__payloadPreprocessor.handleUpdate({actions:[fa],threads:[ca.obj.updated_thread],payload_source:o.CLIENT_CHANNEL_MESSAGE});};aa.prototype.$MercuryChannelHandler11=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj||!ca.obj.folder)return;var da={action_type:m.MARK_ALL_READ,action_id:ca.obj.action_id,folder:ca.obj.folder};this.__payloadPreprocessor.handleUpdate({global_actions:[da]});};aa.prototype.$MercuryChannelHandler12=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj.thread_fbids&&!ca.obj.other_user_fbids)return;var da=o.CLIENT_CHANNEL_MESSAGE;(ca.obj.thread_fbids||[]).forEach(function(ea){var fa={action_type:j.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:ea.toString(),other_user_fbid:null,archived:ca.obj.state};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[babelHelpers._extends({},fa)],payload_source:da},ea.toString());},this);(ca.obj.other_user_fbids||[]).forEach(function(ea){var fa={action_type:j.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:null,other_user_fbid:ea.toString(),archived:ca.obj.state};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[babelHelpers._extends({},fa)],payload_source:da},ea.toString());},this);};aa.prototype.$MercuryChannelHandler13=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj.thread_fbids&&!ca.obj.other_user_fbids)return;var da=o.CLIENT_CHANNEL_MESSAGE,ea;(ca.obj.thread_fbids||[]).forEach(function(fa){if(ca.obj.event==t.TAG){ea=ca.obj.tag;}else ea=ca.obj.marked_as_spam?v.SPAM:v.INBOX;var ga={action_type:j.CHANGE_FOLDER,action_id:null,thread_fbid:fa.toString(),other_user_fbid:null,new_folder:ea};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[babelHelpers._extends({},ga)],payload_source:da},fa.toString());},this);(ca.obj.other_user_fbids||[]).forEach(function(fa){if(ca.obj.event==t.TAG){ea=ca.obj.tag;}else ea=ca.obj.marked_as_spam?v.SPAM:v.INBOX;var ga={action_type:j.CHANGE_FOLDER,action_id:null,other_user_fbid:fa.toString(),thread_fbid:null,new_folder:ea};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[babelHelpers._extends({},ga)],payload_source:da},fa.toString());},this);};aa.prototype.$MercuryChannelHandler14=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj.tag)return;switch(ca.obj.tag){case v.ACTION_ARCHIVED:this.$MercuryChannelHandler12(ba,ca);break;case v.INBOX:case v.OTHER:this.$MercuryChannelHandler13(ba,ca);break;}};aa.prototype.__markAsSeen=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler15(ba)||!ca.obj||!ca.obj.seen_timestamp)return;this.__payloadPreprocessor.handleUpdate({message_counts:[{seen_timestamp:ca.obj.seen_timestamp,folder:v.INBOX}],unseen_thread_fbids:[{thread_fbids:[],other_user_fbids:[],folder:v.INBOX}],payload_source:o.CLIENT_CHANNEL_MESSAGE});};aa.prototype.__updateModelsFromMercuryPayload=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler16(ba)||!ca.obj)return;this.$MercuryChannelHandler2.synchronizeInforms((function(){var da=ca.obj,ea=[];(da.actions||[]).forEach(function(fa){var ga=j.USER_GENERATED_MESSAGE;if(fa.action_type==j.LOG_MESSAGE){var ha=o.CLIENT_CHANNEL_MESSAGE,ia;ia=fa.other_user_fbid||fa.thread_fbid;this.__delayedDispatcher.handleUpdateWaitForThread({actions:[babelHelpers._extends({},fa)],payload_source:ha},ia);}else if(fa.action_type!=ga)ea.push(fa);},this);da.actions=ea;da.payload_source=o.CLIENT_CHANNEL_MESSAGE;this.__payloadPreprocessor.handleUpdate(da);}).bind(this));};aa.prototype.$MercuryChannelHandler17=function(ba,ca){'use strict';var da,ea,fa=ca.obj.time,ga=ca.obj.reader,ha=ca.obj.thread_fbid||'';this.__payloadPreprocessor.handleUpdate({roger:(ea={},ea[ha]=(da={},da[ga]=fa,da),ea)});};aa.prototype.$MercuryChannelHandler18=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj||ca.obj.message_blocked===undefined||!ca.obj.thread_fbid)return;var da=j.UPDATE_BLOCKER_STATUS,ea=[{action_type:da,action_id:null,thread_fbid:ca.obj.thread_fbid,message_blocked:ca.obj.message_blocked,is_blocked_by_recipient:ca.obj.is_blocked_by_recipient}];this.__payloadPreprocessor.handleUpdate({actions:ea,payload_source:o.CLIENT_CHANNEL_MESSAGE});};aa.prototype.$MercuryChannelHandler19=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj||ca.obj.got_blocked===undefined||!ca.obj.thread_fbid)return;var da=j.UPDATE_BLOCKEE_STATUS,ea=[{action_type:da,action_id:null,thread_fbid:ca.obj.thread_fbid,got_blocked:ca.obj.got_blocked}];this.__payloadPreprocessor.handleUpdate({actions:ea,payload_source:o.CLIENT_CHANNEL_MESSAGE});};aa.prototype.$MercuryChannelHandler20=function(ba,ca){'use strict';if(!this.$MercuryChannelHandler6(ba)||!ca.obj||ca.obj.mute_settings===undefined||!ca.obj.thread_fbid&&!ca.obj.other_user_fbid)return;var da=j.CHANGE_MUTE_SETTINGS,ea=[{action_type:da,action_id:null,thread_fbid:ca.obj.thread_fbid,other_user_fbid:ca.obj.other_user_fbid,mute_settings:ca.obj.mute_settings}];this.__payloadPreprocessor.handleUpdate({actions:ea,payload_source:o.CLIENT_CHANNEL_MESSAGE});};aa.prototype.__handleMessagingPayload=function(ba,ca){'use strict';switch(ca.obj.event){case t.DELIVER:this.$MercuryChannelHandler5(ba,ca);break;case t.DELIVERY_RECEIPT:this.$MercuryChannelHandler7(ba,ca);break;case t.READ:case t.UNREAD:this.$MercuryChannelHandler8(ba,ca);break;case t.READ_ALL:this.$MercuryChannelHandler11(ba,ca);break;case t.DELETE:this.$MercuryChannelHandler9(ba,ca);break;case t.DELETE_MESSAGES:this.$MercuryChannelHandler10(ba,ca);break;case t.TAG:this.$MercuryChannelHandler14(ba,ca);break;case t.REPORT_SPAM:this.$MercuryChannelHandler13(ba,ca);break;case t.READ_RECEIPT:this.$MercuryChannelHandler17(ba,ca);break;case t.CHANGE_MUTE_SETTINGS:this.$MercuryChannelHandler20(ba,ca);break;case t.UPDATE_BLOCKER_STATUS:this.$MercuryChannelHandler18(ba,ca);break;case t.UPDATE_BLOCKEE_STATUS:this.$MercuryChannelHandler19(ba,ca);break;}};aa.prototype.getRouting=function(){'use strict';return {mercury:this.__updateModelsFromMercuryPayload,messaging:this.__handleMessagingPayload,inbox:this.__markAsSeen};};aa.prototype.__getMessagingPayloadType=function(){'use strict';return i.getArbiterType('messaging');};aa.prototype.__getMercuryPayloadType=function(){'use strict';return i.getArbiterType('mercury');};aa.prototype.__getInboxPayloadType=function(){'use strict';return i.getArbiterType('inbox');};aa.prototype.$MercuryChannelHandler6=function(ba){'use strict';return ba==this.__getMessagingPayloadType();};aa.prototype.$MercuryChannelHandler16=function(ba){'use strict';return ba==this.__getMercuryPayloadType();};aa.prototype.$MercuryChannelHandler15=function(ba){'use strict';return ba==this.__getInboxPayloadType();};aa.prototype.turnOn=function(){'use strict';if(!this.$MercuryChannelHandler4.length){var ba=this.getRouting();for(var ca in ba)this.$MercuryChannelHandler4.push(h.subscribe(i.getArbiterType(ca),ba[ca].bind(this)));}return this;};aa.prototype.turnOff=function(){'use strict';if(this.$MercuryChannelHandler4.length){this.$MercuryChannelHandler4.forEach(h.unsubscribe);this.$MercuryChannelHandler4=[];}return this;};Object.assign(aa,q);f.exports=aa;},null);
__d('MercuryRoger',['Arbiter','ArbiterMixin','immutable','JSLogger','MercuryActionStatus','MercuryDispatcher','MercurySingletonMixin','MercuryThreads','mixin','mapObject'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r,s,t=l.SUCCESS;r=babelHelpers.inherits(u,p(i));s=r&&r.prototype;function u(x){'use strict';s.constructor.call(this);this.$MercuryRoger1={};this.$MercuryRoger2=[];this.$MercuryRoger3=x;this.$MercuryRoger4=m.getForFBID(this.$MercuryRoger3);this.$MercuryRoger5=o.getForFBID(this.$MercuryRoger3);this.$MercuryRoger4.subscribe('update-roger',(function(y,z){for(var aa in z){var ba=this.$MercuryRoger1[aa]||j.OrderedMap();ba=ba.withMutations((function(ca){for(var da in z[aa]){var ea=this.$MercuryRoger5.getThreadMetaNow(aa);if(ea&&ea.participants)if(ea.participants.indexOf(da)==-1){this.$MercuryRoger2.push(w(this.$MercuryRoger1));continue;}var fa=ca.get(da),ga=z[aa][da];if(!fa||ga>fa)ca.set(da,ga);}}).bind(this));this.$MercuryRoger1[aa]=ba.sort();}z&&this.inform('change',z);}).bind(this));h.subscribe(k.DUMP_EVENT,(function(y,z){z.bad_read_receipts={receipts:this.$MercuryRoger2};}).bind(this));}u.prototype.getSeenBy=function(x,y){'use strict';if(!x)return [];var z=[],aa=this.$MercuryRoger1[x.thread_id];if(!aa)return z;aa.forEach(function(ba,ca){if(v(x,ba,ca,y))z.push(ca);});return z;};u.prototype.wasSeenByAll=function(x){'use strict';if(!x)return false;var y=this.$MercuryRoger1[x.thread_id];if(!y)return false;return y.every(function(z,aa){return v(x,z,aa);});};u.prototype.getSeenTimestamps=function(x){'use strict';var y=this.$MercuryRoger1[x];if(!y){y=j.OrderedMap();this.$MercuryRoger1[x]=y;}return y;};u.prototype.getSeenTimestamp=function(x,y){'use strict';var z=this.$MercuryRoger1[x];return z?z.get(y):null;};Object.assign(u,n);function v(x,y,z,aa){return !!(y>=x.timestamp&&(x.status===undefined||x.status===t)&&(!aa||z!=x.author));}function w(x){return q(x,function(y){return y.toJS();});}f.exports=u;},null);
__d('MercuryDelayedRoger',['ArbiterMixin','LiveTimer','MercuryActionStatus','MercuryConfig','setTimeoutAcrossTransitions','MercuryMessages','MercuryRoger','MercuryThreadInformer','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=c('MercuryMessages').get(),n=c('MercuryRoger').get(),o=c('MercuryThreadInformer').get(),p=c('MercuryThreads').get(),q={},r={},s=k['roger.seen_delay'],t={getSeenBy:function(z,aa){if(r[z])return [];return n.getSeenBy(u(z),aa);},wasSeenByAll:function(z){if(r[z])return false;return n.wasSeenByAll(u(z));}};Object.assign(t,h);function u(z){if(!q[z]){var aa=p.getThreadMetaNow(z);if(aa)q[z]={thread_id:z,author:aa.participants[0],timestamp:aa.timestamp};}return q[z];}function v(z){var aa=false;m.getThreadMessagesRange(z,0,1,function(ba){var ca=ba[0];if(!ca)return;var da=ca.timestamp;if(ca.action_id||ca.status==j.SUCCESS)da-=i.getServerTimeOffset();var ea=t.getSeenBy(z);if(r[z]){clearTimeout(r[z]);delete r[z];}var fa=da+s,ga=fa-Date.now();if(ga>0)r[z]=l(function(){delete r[z];w(z);},ga);q[z]=ca;var ha=t.getSeenBy(z);if(ea.length||ha.length)aa=true;});return aa;}function w(z){var aa={};aa[z]=true;x(aa);}function x(z){t.inform('state-changed',z);t.inform('change');}function y(event,z){var aa={};for(var ba in z)if(v(ba))aa[ba]=true;for(var ca in aa){x(aa);break;}}n.subscribe('change',function(z,aa){for(var ba in aa)!r[ba]&&w(ba);});o.subscribe('messages-received',y);o.subscribe('messages-reordered',y);o.subscribe('messages-updated',y);f.exports=t;},null);
__d('MercuryDeliveryReceipts',['ArbiterMixin','Map','MercuryDispatcher','MercurySingletonProvider','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=babelHelpers.inherits(o,l(h));n=m&&m.prototype;function o(q){'use strict';n.constructor.call(this);this.$MercuryDeliveryReceipts1=q;this.$MercuryDeliveryReceipts2=new i();this.$MercuryDeliveryReceipts3=j.getForFBID(this.$MercuryDeliveryReceipts1);this.$MercuryDeliveryReceipts3.subscribe('update-delivery',(function(r,s){if(s.delivery_receipts)for(var t in s.delivery_receipts){var u=s.delivery_receipts[t],v=this.$MercuryDeliveryReceipts2.get(t)||0;if(u>v){this.$MercuryDeliveryReceipts2.set(t,u);this.informDeliveryStatusChanged(t);}}}).bind(this));}o.getForFBID=function(q){'use strict';return p.getForFBID(q);};o.get=function(){'use strict';return p.get();};o.prototype.informDeliveryStatusChanged=function(q){'use strict';var r=new i();r.set(q,true);this.inform('change',r);};o.prototype.getDeliveryTime=function(q){'use strict';return this.$MercuryDeliveryReceipts2.get(q)||0;};var p=new k(o);f.exports=o;},null);
__d('MercuryDeliveryState',['MercuryConfig','MercuryIDs','MercuryServerRequests','MercurySingletonMixin','MercuryThreadIDMap','MercuryThreadInformer','PresencePrivacy','UserActivity','debounceAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';if(c.__markCompiled)c.__markCompiled();var q=h.delivery_timeout||120000;function r(s){this.$MercuryDeliveryState1=s;this.$MercuryDeliveryState2=j.getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState3=m.getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState4=l.getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState5=[];this.$MercuryDeliveryState6=[];this.$MercuryDeliveryState3.subscribe('messages-received',this.$MercuryDeliveryState7.bind(this));o.subscribe(p(this.$MercuryDeliveryState8,300,this));}r.prototype.$MercuryDeliveryState7=function(s,t){for(var u in t){var v=t[u];v.forEach((function(w){if(this.$MercuryDeliveryState9(w)){this.$MercuryDeliveryState5.push(w);this.$MercuryDeliveryState4.getServerIDFromClientID(u,(function(x){if(!this.$MercuryDeliveryState6[x])this.$MercuryDeliveryState6[x]=[];this.$MercuryDeliveryState6[x].push(w.message_id);}).bind(this));}}).bind(this));}if(o.isActive(q))this.$MercuryDeliveryState8();};r.prototype.$MercuryDeliveryState8=function(){if(this.$MercuryDeliveryState5.length===0&&this.$MercuryDeliveryState6.length===0)return;var s=this.$MercuryDeliveryState5.map(function(t){return t.message_id;});if(s)this.$MercuryDeliveryState2.sendDeliveryReceipts(s,this.$MercuryDeliveryState6);this.$MercuryDeliveryState6=[];this.$MercuryDeliveryState5=[];};r.prototype.$MercuryDeliveryState9=function(s){var t=s.author?i.getUserIDFromParticipantID(s.author):null;if(t===this.$MercuryDeliveryState1)return false;if(!s.is_unread)return false;if(!n.allows(t))return false;return true;};Object.assign(r,k);f.exports=r;},null);
__d('MercuryFilters',['MessagingTag','arrayContains'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=[h.UNREAD],k={ALL:'all',UNREAD:h.UNREAD,getSupportedFilters:function(){return j.concat();},isSupportedFilter:function(l){return i(j,l);}};f.exports=k;},null);
__d('MercuryOrderedThreadlist',['LogHistory','MercuryActionType','MercuryDispatcher','MercuryFilters','MercuryFolders','MercuryPayloadSource','MercurySingletonMixin','MercuryThreadIDMap','MessagingTag','PageMessageEnumTag','RangedCallbackManager','MercuryServerRequests','MercuryThreadInformer','MercuryThreads','arrayContains'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){'use strict';if(c.__markCompiled)c.__markCompiled();var w=h.getInstance('ordered_threadlist_model'),x=k.getSupportedFilters().concat([k.ALL,p.GROUPS]),y=l.getSupportedFolders();function z(ja,ka,la,ma){var na=[],oa=false,pa=false,qa=(ka||[]).filter(function(xa){var ya=xa.filter||k.ALL;return (xa.folder==la||!xa.folder&&la==p.INBOX)&&ya==ma;}),ra=ja._threadlistOrderMap[la][ma].getAllResources(),sa;qa.forEach(function(xa){na=na.concat(xa.thread_ids);if(xa.error){if(xa.end>ra.length)pa=xa.error;}else{var ya=xa.end-xa.start;if(xa.thread_ids.length<ya)oa=true;}if(!sa||xa.end>sa)sa=xa.end;});da(ja,na,la,ma);if(oa){ja._threadlistOrderMap[la][ma].setReachedEndOfArray();}else if(pa){ja._threadlistOrderMap[la][ma].setError(pa);}else{var ta=ja._threadlistOrderMap[la][ma].getCurrentArraySize();if(sa&&ta<sa){var ua={},va=ra.concat(na),wa=va.filter(function(xa){var ya=ua[xa];ua[xa]=true;return ya;});if(wa.length){w.warn('duplicate_threads',{folder:la,expected_final_size:sa,actual_final_size:ta,duplicate_thread_ids:wa});ja._serverRequests.fetchThreadlistInfo(sa,wa.length,la,ma==k.ALL?null:ma);}}}}function aa(ja,ka){y.forEach(function(la){x.forEach(function(ma){z(ja,ka,la,ma);});});}function ba(ja,ka){var la={};y.forEach(function(ma){la[ma]={};x.forEach(function(na){la[ma][na]={to_add:[],to_remove:[],to_remove_if_last_after_add:{}};});});ka.forEach(function(ma){if(ma.is_forward)return;var na=ma.thread_id,oa=ea(ja,na),pa=fa(ja,na);function qa(){pa.forEach(function(sa){if(!v(x,sa))return;la[oa][sa].to_add.push(na);if(!ja._threadlistOrderMap[oa][sa].hasReachedEndOfArray()&&!ja._threadlistOrderMap[oa][sa].hasResource(na))la[oa][sa].to_remove_if_last_after_add[na]=true;});}function ra(sa){if(v(x,sa))if(v(pa,sa)){la[oa][sa].to_add.push(na);}else la[oa][sa].to_remove.push(na);}if(!oa){if(ma.action_type===i.CHANGE_FOLDER||ma.action_type===i.CHANGE_ARCHIVED_STATUS)y.forEach(function(sa){if(sa!==oa)x.forEach(function(ta){ja._threadlistOrderMap[sa][ta].removeResources([na]);});});return;}switch(ma.action_type){case i.DELETE_THREAD:pa.forEach(function(sa){if(!v(x,sa))return;la[oa][sa].to_remove.push(na);});break;case i.CHANGE_ARCHIVED_STATUS:case i.CHANGE_FOLDER:qa();break;case i.CHANGE_READ_STATUS:ra(p.UNREAD);break;case i.USER_GENERATED_MESSAGE:case i.LOG_MESSAGE:pa.forEach(function(sa){if(!v(x,sa))return;if(ga(ja,na,oa,sa))la[oa][sa].to_add.push(na);});break;case i.CHANGE_FLAG:ra(q.FLAG);break;}});y.forEach(function(ma){x.forEach(function(na){var oa=ja._threadlistOrderMap[ma][na];da(ja,la[ma][na].to_add,ma,na);for(var pa=oa.getCurrentArraySize()-1;pa>=0;pa--){var qa=oa.getResourceAtIndex(pa);if(!la[ma][na].to_remove_if_last_after_add[qa])break;la[ma][na].to_remove.push(qa);}oa.removeResources(la[ma][na].to_remove);});});}function ca(ja,ka){var la={};y.forEach(function(ma){la[ma]={};x.forEach(function(na){la[ma][na]=[];});});ka.forEach(function(ma){var na=ea(ja,ma.thread_id),oa=fa(ja,ma.thread_id);if(na)oa.forEach(function(pa){if(ga(ja,ma.thread_id,na,pa))la[na][pa].push(ma.thread_id);});});y.forEach(function(ma){x.forEach(function(na){if(la[ma][na].length>0)da(ja,la[ma][na],ma,na);});});}function da(ja,ka,la,ma){ma=ma||k.ALL;ja._threadlistOrderMap[la][ma].addResources(ka);y.forEach(function(na){if(na!=la)ja._threadlistOrderMap[na][ma].removeResources(ka);});}function ea(ja,ka){var la=ja._threads.getThreadMetaNow(ka),ma=null;if(!la){ma='No thread metadata';}else if(!la.folder)ma='No thread folder';if(ma){var na={error:ma,tid:ka};w.warn('no_thread_folder',na);return null;}var oa=la.folder;if(la.is_archived)oa=p.ACTION_ARCHIVED;if(ja._threadlistOrderMap[oa]){return oa;}else return null;}function fa(ja,ka){var la=ja._threads.getThreadMetaNow(ka),ma=[k.ALL];if(!la){var na={error:'no_thread_metadata',tid:ka};w.warn('no_thread_metadata',na);return [];}if(la.unread_count)ma.push(p.UNREAD);if(!la.is_canonical)ma.push(p.GROUPS);var oa=la.page_thread_info;if(oa&&oa.flagged)ma.push(q.FLAG);return ma;}function ga(ja,ka,la,ma){var na=ja._threads.getThreadMetaNow(ka);return !!(na&&na.timestamp&&ea(ja,ka)==la&&v(fa(ja,ka),ma));}function ha(ja){this._fbid=ja;this._serverRequests=s.getForFBID(this._fbid);this._threadIDMap=o.getForFBID(this._fbid);this._threadInformer=t.getForFBID(this._fbid);this._threads=u.getForFBID(this._fbid);this._dispatcher=j.getForFBID(this._fbid);this._threadlistOrderMap={};y.forEach((function(ka){this._threadlistOrderMap[ka]={};x.forEach((function(la){this._threadlistOrderMap[ka][la]=new r((function(ma){return this._threads.getThreadMetaNow(ma).timestamp;}).bind(this),function(ma,na){return na-ma;},this._threadIDMap.canLinkExternally.bind(this._threadIDMap));}).bind(this));}).bind(this));this._dispatcher.subscribe('update-threadlist',(function(ka,la){if(!ia(la))return;var ma=la.ordered_threadlists;if(ma&&ma.length){aa(this,ma);}else{var na=(la.actions||[]).filter(function(oa){return oa.thread_id;});ca(this,la.threads||[]);ba(this,na);}this._threadInformer.updatedThreadlist();}).bind(this));}Object.assign(ha.prototype,{getThreadlistOrderMap:function(ja,ka){if(!this._threadlistOrderMap[ja][ka]){x=x.concat([ka]);y.forEach((function(la){this._threadlistOrderMap[la][ka]=new r((function(ma){return this._threads.getThreadMetaNow(ma).timestamp;}).bind(this),function(ma,na){return na-ma;},this._threadIDMap.canLinkExternally.bind(this._threadIDMap));}).bind(this));}return this._threadlistOrderMap[ja][ka];},getThreadlist:function(ja,ka,la,ma,na,oa){return this.getFilteredThreadlist(ja,ka,la,k.ALL,ma,na,oa);},getFilteredThreadlist:function(ja,ka,la,ma,na,oa,pa){var qa=this.getThreadlistOrderMap(la,ma),ra=qa.executeOrEnqueue(ja,ka,na,oa),sa=qa.getUnavailableResources(ra),ta=qa.getError(ja,ka,oa);if(sa.length||ta){if(qa.getCurrentArraySize()<ja){var ua={start:ja,limit:ka,filter:ma,resources_size:qa.getCurrentArraySize()};w.warn('range_with_gap',ua);}qa.setError(false);this._serverRequests.fetchThreadlistInfo(qa.getCurrentArraySize(),sa.length,la,ma==k.ALL?null:ma,pa);}return ra;},getThreadlistUntilTimestamp:function(ja,ka,la){la=la||k.ALL;return this.getThreadlistOrderMap(ka,la).getElementsUntil(ja);},getAvailableThreadlistNow:function(ja,ka){ka=ka||k.ALL;return this.getThreadlistOrderMap(ja,ka).getAllResources();},getThreadCount:function(ja,ka){ka=ka||k.ALL;return this.getThreadlistOrderMap(ja,ka).getCurrentArraySize();},hasLoadedThreadlist:function(ja,ka){ka=ka||k.ALL;return this.getThreadlistOrderMap(ja,ka).hasReachedEndOfArray();},unsubscribe:function(ja,ka,la){la=la||k.ALL;this.getThreadlistOrderMap(ka,la).unsubscribe(ja);}});Object.assign(ha,n);function ia(ja){switch(ja.payload_source){case m.CLIENT_CHANGE_ARCHIVED_STATUS:case m.CLIENT_CHANGE_READ_STATUS:case m.CLIENT_CHANGE_FOLDER:case m.CLIENT_CHANNEL_MESSAGE:case m.CLIENT_DELETE_MESSAGES:case m.CLIENT_DELETE_THREAD:case m.CLIENT_SEND_MESSAGE:case m.SERVER_SEND_MESSAGE:case m.SERVER_FETCH_THREADLIST_INFO:case m.SERVER_THREAD_SYNC:return true;case m.SERVER_INITIAL_DATA:return !!ja.ordered_threadlists;default:return false;}}f.exports=ha;},null);
__d('MercuryStateCheck',['Arbiter','ChannelConstants','LogHistory','MercuryAPIArgsSource','MercuryFolders','MercuryOrderedThreadlist','MercuryServerRequests','MercurySingletonMixin','MessagingTag','URI'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=j.getInstance('mercury_state_check');function s(t){'use strict';this.$MercuryStateCheck1=t;this.$MercuryStateCheck2=n.getForFBID(this.$MercuryStateCheck1);this.$MercuryStateCheck3=m.getForFBID(this.$MercuryStateCheck1);h.subscribe(i.ON_INVALID_HISTORY,this.$MercuryStateCheck4.bind(this,i.ON_INVALID_HISTORY));e(['ChannelConnection'],(function(u){u.subscribe(u.CONNECTED,(function(v,w){if(!w.init)this.$MercuryStateCheck5(u.CONNECTED);}).bind(this));}).bind(this));}s.prototype.$MercuryStateCheck4=function(t){'use strict';var u;if(q.getRequestURI().getPath().search(/messages/)!==-1){u=l.getSupportedFolders();}else u=[p.INBOX];r.debug('check',{folders:u,source:t});this.$MercuryStateCheck2.fetchMissedMessages(u,k.MERCURYSYNC);};s.prototype.$MercuryStateCheck5=function(t){'use strict';var u=this.$MercuryStateCheck3.getAvailableThreadlistNow(p.INBOX)||[];u=u.slice(0,20);r.debug('full_check',{threads:u,source:t});this.$MercuryStateCheck2.fetchThreadData(u,k.MERCURYSYNC);this.$MercuryStateCheck4(t);};Object.assign(s,o);f.exports=s;},null);
__d('MercuryUnseenState',['MercuryFolders','KeyedCallbackManager','LogHistory','MercuryActionType','MercuryDispatcher','MercurySingletonMixin','MercuryThreadInfo','MercuryThreadlistConstants','MercuryThreadIDMap','MessagingTag','MercuryServerRequests','MercuryThreadInformer','MercuryThreads','createObjectFrom','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=o.MAX_UNSEEN_COUNT,x='unseen_thread_hash',y='unseen_thread_list',z=j.getInstance('mercury_unseen_state');function aa(pa){this._fbid=pa;this._serverRequests=r.getForFBID(this._fbid);this._threadIDMap=p.getForFBID(this._fbid);this._threads=t.getForFBID(this._fbid);this._threadInformer=s.getForFBID(this._fbid);this._dispatcher=l.getForFBID(this._fbid);this._initialUnseenCount=null;this._lastSeenTimestamp=0;this._maxCount=false;this._pendingServerUpdates=false;this._unseenResources=new i();this._dispatcher.subscribe('update-unseen',(function(qa,ra){ga(this,ra);}).bind(this));this._dispatcher.subscribe('update-thread-ids',(function(qa,ra){ma(this,ra);}).bind(this));}Object.assign(aa.prototype,{getUnseenCount:function(){if(this.exceedsMaxCount()){z.error('unguarded_unseen_count_fetch',{});return 0;}return fa(this)||0;},exceedsMaxCount:function(){return this._maxCount||fa(this)>w;},markAsSeen:function(){var pa=fa(this);if(pa===null){this._pendingServerUpdates=true;}else if(pa>0||this._maxCount){this._serverRequests.markSeen();var qa=this._serverRequests.getLastActionTimestamp();ha(this,qa,[]);}}});Object.assign(aa,m);function ba(pa,qa,ra){var sa={};sa[qa]=0;ja(pa,sa,ra);}function ca(pa,qa){pa._unseenResources.setResource(x,qa);pa._unseenResources.setResource(y,Object.keys(qa));}function da(pa,qa){var ra=pa._unseenResources.executeOrEnqueue(x,qa),sa=pa._unseenResources.getUnavailableResources(ra);if(sa.length)pa._serverRequests.fetchUnseenThreadIDs();}function ea(pa){return pa._unseenResources.getResource(x);}function fa(pa){var qa=pa._unseenResources.getResource(y);if(qa){return qa.length;}else return pa._initialUnseenCount;}function ga(pa,qa){var ra=oa(qa);if(qa.unseen_thread_fbids){qa.unseen_thread_fbids.forEach(function(cb){if(cb.folder!=q.INBOX)return;var db=cb.thread_fbids||[];db=db.concat(cb.other_user_fbids||[]);var eb=la(pa,db),fb=pa._lastSeenTimestamp;if(ra&&ra.seen_timestamp)fb=ra.seen_timestamp;ha(pa,fb,eb);if(ra&&ra.unseen_count>w)pa._maxCount=true;});}else if(ra&&ra.seen_timestamp){pa._lastSeenTimestamp=ra.seen_timestamp;if(ra.unseen_count>w){pa._maxCount=true;ca(pa,{});}else{pa._initialUnseenCount=ra.unseen_count;if(pa._initialUnseenCount===0)ca(pa,{});}}else{if(pa._maxCount)return;var sa=qa.actions;if(!sa||!sa.length)return;var ta={},ua={};for(var va=0;va<sa.length;va++){var wa=sa[va];if(wa.is_forward)continue;var xa=wa.action_type,ya=wa.other_user_fbid?wa.other_user_fbid:wa.thread_fbid,za=wa.thread_id?wa.thread_id:ya;if(xa==k.MARK_THREAD_SEEN){ba(pa,za,wa.persistent);continue;}if(!na(pa,wa))continue;if(xa==k.USER_GENERATED_MESSAGE||xa==k.LOG_MESSAGE){var ab=ta[za]?wa.timestamp>ta[za]:false,bb=ab||!ta[za];if(wa.is_unread&&bb)pa._threads.getThreadMeta(za,function(cb){var db=false;if(cb&&cb.last_read_timestamp)if(cb.last_read_timestamp>=wa.timestamp)db=true;if(!n.isMuted(cb)&&!db)ta[za]=wa.timestamp;});}else if(xa==k.CHANGE_READ_STATUS&&wa.mark_as_read)ua[za]=wa.timestamp;}ia(pa,ta);ja(pa,ua);}if(pa._pendingServerUpdates){pa._pendingServerUpdates=false;pa.markAsSeen();}}function ha(pa,qa,ra){var sa=ea(pa);if(sa===undefined||qa>pa._lastSeenTimestamp||pa._maxCount){pa._lastSeenTimestamp=qa;ra=ra||[];if(ra.length<=w)pa._maxCount=false;var ta={},ua=ea(pa)||{};for(var va in ua)if(ua[va]!==true){var wa=ua[va];if(ka(pa,wa))ta[va]=wa;}var xa=Object.assign(u(ra,true),ta);ca(pa,xa);pa._threadInformer.updatedUnseenState();}}function ia(pa,qa){if(pa._maxCount)return;var ra={},sa=false;for(var ta in qa){var ua=qa[ta];if(ka(pa,ua)){ra[ta]=ua;sa=true;}}if(!sa)return;da(pa,function(va){for(var wa in ra){var xa=ra[wa];if(!va[wa]&&ka(pa,xa))va[wa]=ra[wa];}ca(pa,va);pa._threadInformer.updatedUnseenState();});}function ja(pa,qa,ra){var sa=false;if(!v(qa))sa=true;if(sa)da(pa,function(ta){var ua=false;for(var va in qa){var wa=qa[va],xa=wa>=ta[va];if(ta[va]&&(!wa||xa)){delete ta[va];ua=true;}}if(ua){ca(pa,ta);pa._threadInformer.updatedUnseenState();if(ra&&fa(pa)===0)pa._serverRequests.markSeen();}});}function ka(pa,qa){return qa>pa._lastSeenTimestamp;}function la(pa,qa){return qa.map(pa._threadIDMap.convertThreadIDIfAvailable,pa._threadIDMap);}function ma(pa,qa){var ra=ea(pa);if(!ra)return;for(var sa in qa){var ta=qa[sa];if(ra[sa]){ra[ta]=ra[sa];delete ra[sa];}}ca(pa,ra);}function na(pa,qa){var ra=qa.thread_id?pa._threads.getThreadMetaNow(qa.thread_id):null,sa=ra?h.getFromMeta(ra):qa.folder;return sa===q.INBOX||sa===undefined;}function oa(pa){var qa=pa.message_counts||[];for(var ra=0;ra<qa.length;ra++)if(qa[ra].folder==q.INBOX)return qa[ra];return null;}f.exports=aa;},null);
__d('MercurySyncDeltaTypes',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={NewMessage:'NewMessage'};f.exports=h;},null);
__d('MercurySyncDispatcher',['Arbiter','Map','MercuryConfig','MercuryDelayedDispatcher','MercuryPayloadSource','MercurySyncNewMessageTransformer','MercurySyncDeltaTypes','MercurySingletonProvider'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';if(c.__markCompiled)c.__markCompiled();p.getForFBID=function(r){return q.getForFBID(r);};p.get=function(){return q.get();};function p(r){this.$MercurySyncDispatcher1=r;this.$MercurySyncDispatcher2=k.getForFBID(this.$MercurySyncDispatcher1);this.$MercurySyncDispatcher3=m.getForFBID(this.$MercurySyncDispatcher1);h.subscribe('channel/message:delta',(function(s,t){var u=t&&t.obj&&t.obj.delta;if(!u)return;this.process(u);}).bind(this));}p.prototype.process=function(r){switch(r['class']){case n.NewMessage:var s=!!r.stickerId||r.attachments&&!!r.attachments.length,t=this.$MercurySyncDispatcher3.transform(r);if(!j.WWWSyncMsgText||s)break;var u=t.other_user_fbid||t.thread_fbid;this.$MercurySyncDispatcher2.handleUpdateWaitForThread({actions:[t],payload_source:l.CLIENT_CHANNEL_MESSAGE},u);break;default:break;}};var q=new o(p);f.exports=p;},null);
__d('ChatBehavior',['Arbiter','AvailableList','AvailableListConstants','MercuryConstants'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=c('MercuryConstants').ChatNotificationConstants,l=false,m=i.getWebChatNotification&&i.getWebChatNotification(),n=l,o=true,p=Object.assign(new h(),{ON_CHANGED:'changed',notifiesUserMessages:function(){return m!==k.NO_USER_MESSAGE_NOTIFICATION;},ignoresRemoteTabRaise:function(){return n;},showsTabUnreadUI:function(){return o;}});function q(){p.inform(p.ON_CHANGED);}i.subscribe&&i.subscribe(j.ON_CHAT_NOTIFICATION_CHANGED,function(){var r=m,s=i.getWebChatNotification();m=s;if(r!=s)q();});h.subscribe('chat/set_does_page_occlude_tabs',function(r,s){n=!!s;q();});h.subscribe('chat/set_show_tab_unread_ui',function(r,s){o=!!s;q();});f.exports=p;},null);
__d('ChatCookieInterface',['ChatConfig','InitialServerTime','LogHistory','PresenceState','PresenceUtil','areJSONRepresentationsEqual'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=j.getInstance('chat_cookie'),o=i.serverTime,p=h.get('tab_max_load_age')||3600000,q=o-p,r={store:function(v,w){if(v.uct2==w.lastChangeTime)return v;var x=u(v,w),y={};if(!x){y.old_tabs=v&&v.t2&&JSON.stringify(v.t2);y.old_promoted=v&&v.lm2;y.old_time=v&&v.uct2;y.old_reason=v&&v.tr;y.old_window=v&&v.tw;var z=[];w.tabs.forEach(function(aa){if(!aa.fragile){var ba={i:aa.id,si:aa.server_id};if(aa.raised)ba.r=1;z.push(ba);}});v.t2=z;v.lm2=w.promotedID;v.uct2=w.lastChangeTime;v.tr=w.lastChangeReason;v.tw=l.getSessionID();y.new_tabs=JSON.stringify(v.t2);y.new_promoted=v.lm2;y.new_time=v.uct2;y.new_reason=v.tr;y.new_window=v.tw;n.debug('store',y);}else{y.tabs=v&&v.t2&&JSON.stringify(v.t2);y.promoted=v&&v.lm2;y.time=v&&v.uct2;y.reason=v&&v.tr;y.window=v&&v.tw;y.last_change_time=w.lastChangeTime;y.last_change_reason=w.lastChangeReason;y.min_change_time=q;n.warn('store_bad_state',y);}return v;},load:function(v,w){if(!v){n.warn('load_bad_state',v);return false;}var x=u(v,w);if(!x||x===w.lastChangeTime)return false;var y={};y.old_tabs=JSON.stringify(w.tabs);y.old_promoted=w.promotedID;y.old_time=w.lastChangeTime;y.old_reason=w.lastChangeReason;y.window_id=l.getSessionID();y.cookie_tabs=v&&v.t2&&JSON.stringify(v.t2);y.cookie_promoted=v&&v.lm2;y.cookie_time=v&&v.uct2;y.cookie_reason=v&&v.tr;y.cookie_window=v&&v.tw;w.lastChangeTime=x;w.lastChangeReason='load';var z=s(w,v.t2,v.lm2||null);y.load_result=z;y.new_tabs=JSON.stringify(w.tabs);y.new_promoted=w.promotedID;y.new_time=w.lastChangeTime;y.new_reason=w.lastChangeReason;var event='load';if(!w.isInitialized)event+='_init';n.log(event,y);return z;}};function s(v,w,x){var y;if(!t(v,w,x))return false;var z=v.tabs.filter(function(ca){return !!ca.fragile;}),aa={};v.promotedID=null;v.tabs=w.map(function(ca){var da={id:ca.i,server_id:ca.si};if(da.id==x)v.promotedID=da.id;if(ca.r)da.raised=true;aa[da.id]=da;return da;});v.tabs=v.tabs.filter(function(ca){return !!ca;});if(v.localRaised)for(var ba in v.localRaised)if(!aa[ba]||!aa[ba].raised)delete v.localRaised[ba];z=z.filter(function(ca){return !aa[ca.id];});(y=v.tabs).push.apply(y,z);return true;}function t(v,w,x){if(x!=v.promotedID)return true;var y=v.tabs.filter(function(ba){return !ba.fragile;});if(w.length!=y.length)return true;for(var z=0,aa=w.length;z<aa;z++)if(!m(w[z],y[z]))return true;return false;}function u(v,w){var x=k.verifyNumber(v.uct2);if(!x||typeof x!=='number'){n.warn('bad_cookie_version',v);return null;}if(x<w.lastChangeTime||x<q)return null;return x;}f.exports=r;},null);
__d('ChatTabModel',['Arbiter','ChatBehavior','ChatDispatcher','ChatConfig','ChatCookieInterface','ChatTabActions','EventEmitter','InitialServerTime','LogHistory','JSLogger','MercuryAssert','MercuryIDs','MercuryLocalIDs','PresenceState','PresenceUtil','MercuryThreadIDMap','MercuryThreads','MercuryTimestampTracker'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=c('MercuryThreadIDMap').get(),x=c('MercuryThreads').get(),y=c('MercuryTimestampTracker').get(),z=o.serverTime,aa=k.get('tab_max_load_age')||3600000,ba=20,ca=new n(),da=p.getInstance('chat_tab_model'),ea={tabs:[],promotedID:null,lastChangeTime:0,lastChangeReason:null,isInitialized:false,localRaised:null};function fa(ab){var bb=l.load(ab,ea);bb&&ja();return bb;}function ga(ab,bb,cb){var db=fa(u.get());if(bb===undefined||bb>ea.lastChangeTime){if(ab()){db=true;ea.lastChangeReason=cb||null;ia(bb);}}else da.error('rejected',{change_time:bb,state_time:ea.lastChangeTime});db&&ha();}function ha(){if(ea.isInitialized)ca.emit('change');}function ia(ab){if(ab===undefined)ab=Math.max(y.getLastUserMessageTimestamp()||1,ea.lastChangeTime+1);ea.lastChangeTime=ab;u.doSync();}function ja(ab){var bb=ea.tabs.length-ba;if(bb>0)ea.tabs=ea.tabs.filter(function(cb){return cb.raised||cb.id==ab||bb--<=0;});if(bb>0)ea.tabs=ea.tabs.filter(function(cb){return (cb.id==ea.promotedID||cb.id==ab||bb--<=0);});}function ka(ab){for(var bb=0;bb<ea.tabs.length;bb++)if(ea.tabs[bb].id==ab)return bb;return -1;}function la(ab,bb){var cb=x.getThreadMetaNow(ab);if(!cb)return false;if(cb.is_canonical_user){return oa(ab,bb);}else{var db=na(ab);if(db)w.getServerIDFromClientID(ab,function(eb){if(ra(ab,eb)){ia();ha();}});return db;}}function ma(ab){r.isThreadID(ab);if(na(ab))ha();}function na(ab){if(ka(ab)===-1){ea.tabs.push({id:ab,fragile:true});da.log('open_fragile_tab',{tabs:JSON.stringify(ea.tabs),opened:ab,window_id:v.getSessionID()});return true;}return false;}function oa(ab,bb){var cb=ka(ab);if(cb!=-1)if(ea.tabs[cb].fragile){ea.tabs.splice(cb,1);}else{bb&&(ea.tabs[cb].signatureID=bb);return true;}for(var db=0;db<=ea.tabs.length;db++)if(db==ea.tabs.length||ea.tabs[db].fragile){ea.tabs.splice(db,0,{id:ab,signatureID:bb});ja(ab);da.log('open_tab',{tabs:JSON.stringify(ea.tabs),opened:ab,window_id:v.getSessionID()});return true;}}function pa(ab,bb,cb){r.isThreadID(ab);var db=false;if(ea.localRaised&&bb){ea.localRaised[ab]=true;db=true;}ga(function(){if(la(ab,cb))db=true;var eb=ka(ab);if(eb!=-1&&!ea.tabs[eb].raised){ea.tabs[eb].raised=true;db=true;da.log('raise_tab',{tabs:JSON.stringify(ea.tabs),raised:ab,window_id:v.getSessionID()});}return db;});}function qa(ab){if(ka(ab)!==-1&&ea.promotedID!==ab){ea.promotedID=ab;return true;}return false;}function ra(ab,bb){var cb=ka(ab);if(cb!=-1&&ea.tabs[cb].fragile){var db=ea.tabs[cb];db.fragile=s.isLocalThread(ab);db.server_id=bb;var eb=[];ea.tabs.forEach(function(fb){if(fb.id!=ab){if(db&&fb.fragile){eb.push(db);db=null;}eb.push(fb);}});if(db)eb.push(db);ea.tabs=eb;da.log('make_permanent',{tabs:JSON.stringify(ea.tabs),tab_id:ab,window_id:v.getSessionID()});return true;}return false;}function sa(ab,bb){r.isThreadID(ab);var cb=false;if(ea.localRaised){delete ea.localRaised[ab];cb=true;}ga(function(){if(ta(ab))cb=true;return cb;},undefined,bb);}function ta(ab){var bb=ka(ab);if(ab==ea.promotedID)ea.promotedID=null;if(bb!=-1){ea.tabs.splice(bb,1);da.log('close_tab',{tabs:JSON.stringify(ea.tabs),closed:ab,window_id:v.getSessionID()});return true;}return false;}function ua(){if(ea.tabs.length){da.log('close_all_tabs',{closed_tabs:JSON.stringify(ea.tabs),window_id:v.getSessionID()});ea.tabs=[];ea.promotedID=null;if(ea.localRaised)ea.localRaised={};ia();ha();}}function va(){var ab=[];for(var bb=0;bb<ea.tabs.length;bb++)if(ea.tabs[bb].fragile&&!x.isNewEmptyLocalThread(ea.tabs[bb].id)){ab.push(ea.tabs[bb]);ea.tabs.splice(bb);ha();break;}da.log('close_fragile_tabs',{tabs:JSON.stringify(ea.tabs),fragile_closed:ab,window_id:v.getSessionID()});}function wa(ab){r.isThreadID(ab);var bb=false;if(ea.localRaised){delete ea.localRaised[ab];bb=true;}ga(function(){var cb=ka(ab);if(cb!=-1&&ea.tabs[cb].raised){delete ea.tabs[cb].raised;da.log('lower_tab',{tabs:JSON.stringify(ea.tabs),lowered:ab,window_id:v.getSessionID()});bb=true;}return bb;});}function xa(){if(ea.localRaised){ga(function(){var ab=false;ea.tabs.forEach(function(bb){if(bb.raised!=ea.localRaised[bb.id]){ab=true;if(ea.localRaised[bb.id]){bb.raised=true;}else delete bb.raised;}});return ab;});da.log('persist_local_raise',{tabs:JSON.stringify(ea.tabs),window_id:v.getSessionID()});}}u.registerStateStorer(function(ab){return l.store(ab,ea);});u.registerStateLoader(function(ab){if(fa(ab))ha();});var ya={isTabPromoted:function(ab){if(ab)return ab==ea.promotedID;return false;},indexOf:function(ab){return ka(ab);},getTab:function(ab){r.isThreadID(ab);var bb=this.indexOf(ab);if(bb>-1){var cb=ea.tabs[bb];return babelHelpers._extends({},cb);}return null;},getEmptyTab:function(){var ab;for(var bb=0;bb<ea.tabs.length;bb++){ab=ea.tabs[bb].id;if(x.isNewEmptyLocalThread(ab))return ab;}ab=t.generateThreadID();x.createNewLocalThread(ab,[]);return ab;},get:function(){var ab=ea.tabs.map(function(bb){var cb=babelHelpers._extends({},bb);delete cb.fragile;if(ea.localRaised)cb.raised=ea.localRaised[cb.id];return cb;});return {tabs:ab,promoted:ea.promotedID};},promoteThreadInPlaceOfThread:function(ab,bb,cb,db){r.isThreadID(ab);r.isThreadID(bb);ga(function(){var eb=ka(ab),fb=ka(bb);if(db){ea.promotedID=ab;}else if(ea.promotedID===bb)return true;var gb=ea.tabs[eb];if(cb){r.isThreadID(cb);var hb=ka(cb),ib=ea.tabs[fb];ea.tabs[fb]=gb;ea.tabs.splice(eb,1);ea.tabs.splice(hb,0,ib);}else{ea.tabs[eb]=ea.tabs[fb];ea.tabs[fb]=gb;}return true;});},addListener:function(ab){return ca.addListener('change',ab);}};h.subscribe(q.DUMP_EVENT,function(ab,bb){bb.chat_tabs={promoted:ea.promotedID,tabs:ea.tabs.map(function(cb){return babelHelpers._extends({},cb);}),time:ea.lastChangeTime,max_load_age:aa};});function za(){var ab=i.ignoresRemoteTabRaise();if(ab&&!ea.localRaised){da.log('start_ignore_remote_raise');ea.localRaised={};ha();}else if(!ab&&ea.localRaised){da.log('stop_ignore_remote_raise');ea.localRaised=null;ha();}}j.register(function(ab){switch(ab.actionType){case m.Types.CLOSE_TAB:sa(ab.threadID,ab.reason);break;case m.Types.CLOSE_ALL_TABS:ua();break;case m.Types.CLOSE_FRAGILE_TABS:va();break;case m.Types.LOWER_TAB:wa(ab.threadID);break;case m.Types.OPEN_FRAGILE_TAB:ma(ab.threadID);break;case m.Types.OPEN_TAB:r.isThreadID(ab.threadID);ga(function(){return la(ab.threadID);});break;case m.Types.PERSIST_LOCAL_STATE:xa();break;case m.Types.PROMOTE_TAB:r.isThreadID(ab.threadID);ga(qa.bind(null,ab.threadID));break;case m.Types.RAISE_TAB:pa(ab.threadID,ab.userAction,ab.signatureID);break;}});i.subscribe(i.ON_CHANGED,za);za();fa(u.getInitial(),true);if(ea.lastChangeTime===0)ea.lastChangeTime=z-600000;ea.isInitialized=true;f.exports=ya;},null);
__d('ChatTabPresence',['AvailableList','ChatTabModel','MercuryIDs'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={};function l(m){var n=j.getUserIDFromThreadID(m);if(n)h.updateForID(n);}i.addListener(function(){var m=i.get();m.tabs.forEach(function(n){if(n.raised&&!k[n.id])l(n.id);});k={};m.tabs.forEach(function(n){if(n.raised)k[n.id]=true;});});f.exports={};},null);
__d('ChatMentionsNotifications',['fbt','CurrentUser','MercuryParticipants'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={notifyIfMessageToMe:function(l){var m='fbid:'+i.getID(),n=l.body;j.get(m,function(o){var p=new RegExp(o.short_name,"i");if(p.test(n))k._notify(l);});},_notify:function(l){var m=48,n=l.body;if(n.length>m)n=n.substr(0,m-3)+"...";new Notification(h._("Du wurdest in einer Nachricht markiert!"),{body:n,icon:"http://facebook.com//images/icons-large/fb-xl.png"});}};f.exports=k;},null);
__d('ChatTabViewInstances',['Map'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new h();},null);
__d('ChatNewMessageHandler',['ChatActivity','ChatMentionsNotifications','ChatTabModel','ChatTabViewInstances','JSLogger','MercuryAssert','MercuryBrowserAlerts','UserActivity','MercuryConfig','MercuryThreadlistConstants'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=l.create('chat_new_message'),s={_notify:function(t,u,v){if(p.DesktopNotificationsGK)i.notifyIfMessageToMe(u);var w=k.get(t);v.view_is_visible=w&&w.isVisible();v.view_is_focused=w&&w.isFocused();if(!v.view_is_visible)r.log('message_to_hidden');v.is_active=h.isActive();n.messageReceived(u);},newMessage:function(t,u){m.isThreadID(t);var v=j.getTab(t),w={thread_id:t,message_id:u.message_id,to_new_tab:!v,to_raised_tab:v?!!v.raised:true};this._notify(t,u,w);r.log('message',w);}};n.subscribe('before-alert',function(t,event){var u=event.threadID,v=k.get(u),w=j.getTab(u),x=q.MESSAGE_NOTICE_INACTIVITY_THRESHOLD;if(w&&w.raised&&v&&v.isVisible()&&v.isFocused()&&o.isActive(x)){v.tryMarkAsRead();event.cancelAlert();}});f.exports=s;},null);
__d('ChatTabLRUManager',['ChatTabViewInstances','ChatTabModel','InitialServerTime','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=c('MercuryThreads').get(),l={getLRUVisibleTab:function(m){if(m.hasRoomForRaisedTab())return undefined;var n=Object.keys(m.getTabsToShow()||{}),o=1*60,p=null,q=Infinity;for(var r=0;r<n.length;r++){var s=n[r],t=k.getThreadMetaNow(s);if(i.isTabPromoted(s))continue;if(!h.get(s).hasEmptyInput()||!t)continue;var u=(j.serverTime-t.timestamp)/1000;if(!t.timestamp||t.timestamp&&t.timestamp<q&&u>o){p=t.thread_id;q=t.timestamp;}}return p;}};f.exports=l;},null);
__d('ChatTabPolicy',['ChatBehavior','JSLogger','MercuryActionType','MercuryLogMessageType','MercuryAssert','MercuryConfig','MercuryGroupThreadMentions','MercuryIDs','MercuryParticipantTypes','MercurySourceType','MercuryThreadInfo','MercuryViewer','MessagingTag','PresencePrivacy','ShortProfiles','WorkModeConfig','MercuryBlockedParticipants','MercuryThreadActions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=c('MercuryBlockedParticipants').get(),y=c('MercuryThreadActions').get(),z=i.create('tab_policy');f.exports={messageIsAllowed:function(aa,ba,ca){var da=aa.thread_id,ea=ba.message_id;l.isThreadID(da);l.isParticipantID(ba.author);var fa;if(r.isMuted(aa)){fa={thread_id:da,message_id:ea,mute_settings:aa.mute_settings};z.log('message_thread_muted',fa);if(m.GroupChatMentionsGK)n.messageMentionsViewer(ba,function(ia){if(ia)ca();});return;}if(aa.read_only){fa={thread_id:da,message_id:ea,mode:aa.mode};z.log('message_read_only',fa);return;}if(ba.source==q.EMAIL||ba.source==q.TITAN_EMAIL_REPLY){fa={thread_id:da,message_id:ea,source:ba.source};z.log('message_source_not_allowed',fa);return;}var ga=o.getUserIDFromParticipantID(ba.author);if(!ga){z.log('message_bad_author',{thread_id:da,message_id:ea,user:ga});return;}if(ba.action_type!=j.USER_GENERATED_MESSAGE&&!this._messageIsNewlyCreatedGroup(ba,aa)){fa={thread_id:da,message_id:ea,type:ba.action_type};z.log('message_non_user_generated',fa);return;}if(aa.is_canonical_user&&!h.notifiesUserMessages()){z.log('message_jabber',{thread_id:da,message_id:ea});y.markSeen(da,true);return;}if(aa.is_canonical&&!aa.other_user_fbid){z.log('message_canonical_contact',{thread_id:da,message_id:ea});return;}if(aa.folder!=t.INBOX){z.log('message_folder',{thread_id:da,message_id:ea,folder:aa.folder});return;}if(x.isPresentInGroupThread(aa)){fa={thread_id:da,message_id:ea};z.log('message_blocked_participants',fa);return;}var ha=o.getUserIDFromParticipantID(s.getID());v.getMulti([ga,ha],function(ia){if(!u.allows(ga)){z.log('message_privacy',{thread_id:da,message_id:ea,user:ga});return;}var ja=ia[ga].employee&&ia[ha].employee,ka=w.is_work_user;if(!ja&&!ka&&!ia[ga].isCommercePage&&ia[ga].type!==p.FRIEND){z.log('message_non_friend',{thread_id:da,message_id:ea,user:ga});return;}ca();});},_messageIsNewlyCreatedGroup:function(aa,ba){return aa.action_type===j.LOG_MESSAGE&&aa.log_message_type===k.THREAD_NAME&&ba.message_count===1;}};},null);
__d('ChatTabViewEvents',['Arbiter'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new h();},null);
__d('MercuryParticipantListRenderer',['fbt'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(){this.$MercuryParticipantListRenderer1=false;this.$MercuryParticipantListRenderer2=false;this.$MercuryParticipantListRenderer3=false;this.$MercuryParticipantListRenderer4=(function(s){return this.$MercuryParticipantListRenderer2?s.short_name:s.name;}).bind(this);}i.prototype.renderParticipantList=function(s){var t=s.map(this.$MercuryParticipantListRenderer4);switch(t.length){case 0:return j(this.$MercuryParticipantListRenderer1);case 1:return k(t);case 2:return this.$MercuryParticipantListRenderer3?m(t):l(t);case 3:return this.$MercuryParticipantListRenderer3?o(t):n(t);default:return this.$MercuryParticipantListRenderer3?q(t):p(t);}};i.prototype.setIsNewThread=function(s){this.$MercuryParticipantListRenderer1=s;return this;};i.prototype.setNameRenderer=function(s){this.$MercuryParticipantListRenderer4=s;return this;};i.prototype.setUseShortName=function(s){this.$MercuryParticipantListRenderer2=s;return this;};i.prototype.setUseAndSeparator=function(s){this.$MercuryParticipantListRenderer3=s;return this;};function j(s){if(s){return h._("Neue Nachricht");}else return h._("Keine Teilnehmer");}function k(s){return s[0];}function l(s){return h._("{participant1}, {participant2}",[h.param('participant1',s[0]),h.param('participant2',s[1])]);}function m(s){return h._("{participant1} und {participant2}",[h.param('participant1',s[0]),h.param('participant2',s[1])]);}function n(s){return h._("{participant1}, {participant2}, {participant3}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2])]);}function o(s){return h._("{participant1}, {participant2} und {participant3}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2])]);}function p(s){return h._("{participant1}, {participant2}, {participant3}, {others_link}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2]),h.param('others_link',r(s.length-3))]);}function q(s){return h._("{participant1}, {participant2} und {others_link}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('others_link',r(s.length-2))]);}function r(s){if(s>1){return h._({"*":"{others_count} weitere Personen"},[h.param('others_count',s,[0])]);}else return h._("1 weitere Person");}f.exports=i;},null);
__d('MercuryThreadTitle.react',['MercuryIDs','MercuryParticipantListRenderer','MercuryParticipants','React','TextWithEmoticons.react','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=k.PropTypes,o=k.createClass({displayName:'MercuryThreadTitle',propTypes:{isNewThread:n.bool,thread:n.object.isRequired,viewer:n.string.isRequired,showUnreadCount:n.bool,useShortName:n.bool,useAndSeparator:n.bool},getDefaultProps:function(){return {isNewThread:false,showUnreadCount:false,useShortName:false,useAndSeparator:false};},getInitialState:function(){return {participantNames:''};},componentDidMount:function(){this._renderParticipantsList(this.props);},componentWillReceiveProps:function(p){this._renderParticipantsList(p);},render:function(){return (k.createElement('span',{className:this.props.className},this.props.thread.name?this._renderThreadTitle():this.state.participantNames,this.props.children));},getTitle:function(){return this.state.participantNames;},_renderThreadTitle:function(){var p=this.props.thread,q=k.createElement(l,{renderEmoticons:true,renderEmoji:true,text:p.name});if(!p.unread_count||!this.props.showUnreadCount)return q;return this._renderTitleWithUnreadCount(q,p.unread_count);},_renderParticipantsList:function(p){if(p.thread.name)return;var q=h.getParticipantIDFromUserID(p.viewer),r=p.thread.participants;if(r.length>1)r=r.filter(function(s){return s!=q;});j.getMulti(r,(function(s){if(!this.isMounted())return;var t=r.map(function(w){return s[w];}),u=new i().setUseShortName(this.props.useShortName).setUseAndSeparator(this.props.useAndSeparator).setIsNewThread(this.props.isNewThread).renderParticipantList(t),v=p.showUnreadCount&&p.thread.unread_count?this._renderTitleWithUnreadCount(u,p.thread.unread_count):u;this.setState({participantNames:v});}).bind(this));},_renderTitleWithUnreadCount:function(p,q){return m._("{conversation-title} ({unread-count})",[m.param('conversation-title',p),m.param('unread-count',q)]);}});f.exports=o;},null);
__d('ChatTabViewSelector',['Arbiter','ArbiterMixin','CSS','ChatTabActions','CurrentUser','DOM','DataStore','Event','MenuDeprecated','MercuryThreadTitle.react','NubController','React','ReactDOM','ChatTabTemplates','Toggler','MercuryThreadInformer','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=c('MercuryThreadInformer').get(),x=c('MercuryThreads').get();function y(z){var aa=u[':fb:chat:tab:selector'].build(),ba=aa.getRoot(),ca=aa.getNode('menu'),da=m.find(ca,'.uiMenuInner'),ea={},fa=new r().init(ba);j.hide(ba);m.insertBefore(z,ba);function ga(ja){var ka=0;for(var la in ea){var ma=ea[la],na=x.getThreadMetaNow(la),oa=ma.getNode('unreadCount'),pa=na&&na.unread_count||0;ka+=pa;if(pa>9)pa='+';j.conditionClass(oa,'invisible_elem',!pa);m.setContent(oa,pa);}var qa=aa.getNode('numMessages');j.conditionShow(qa,ka);m.setContent(qa,ka);}this.setTabData=function(ja){var ka=ea;ea={};if(ja.length<1){j.hide(ba);return;}j.show(ba);m.empty(da);ja.forEach(function(na){var oa=u[':fb:chat:tab:selector:item'].build(),pa=oa.getNode('content');ea[na.id]=oa;x.getThreadMeta(na.id,function(ra){t.render(s.createElement(q,{thread:ra,useAndSeparator:true,viewer:l.getID()}),pa);});m.prependContent(da,oa.getRoot());n.set(oa.getRoot(),'threadID',na.id);var qa=oa.getNode('closeButton');o.listen(qa,'click',function(event){k.closeTab(na.id,'selector/close-tab');event.kill();});});for(var la in ka)if(ka.hasOwnProperty(la)){var ma=ka[la].getNode('content');ma&&t.unmountComponentAtNode(ma);}fa.flyoutContentChanged();m.setContent(aa.getNode('numTabs'),ja.length);ga();};function ha(event,ja){if(ja.menu!=ca)return;var ka=n.get(ja.item,'threadID');y.inform('selected',ka);v.hide(ba);}function ia(event,ja){p.register(ca);}p.subscribe('select',ha.bind(this));v.listen('show',ba,function(){h.inform('layer_shown',{type:'ChatTabSelector'});ia();});v.listen('hide',ba,function(){h.inform('layer_hidden',{type:'ChatTabSelector'});});w.subscribe('threads-updated',ga);}Object.assign(y,i);f.exports=y;},null);
__d('ChatTabController',['Arbiter','BanzaiLogger','ChatActivity','ChatConfig','ChatNewMessageHandler','ChatTabActions','ChatTabLRUManager','ChatTabModel','ChatTabPolicy','ChatTabViewEvents','ChatTabViewInstances','ChatTabViewSelector','FBRTCCore','JSLogger','MercuryViewer','Style','UserAgent_DEPRECATED','ChatTabPresence','ChatTypeaheadBehavior','MercuryThreadInformer','MercuryThreadActions','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();c('ChatTabPresence');c('ChatTypeaheadBehavior');var y=c('MercuryThreadInformer').get(),z=c('MercuryThreadActions').get(),aa=c('MercuryThreads').get(),ba=k.get('tab_auto_close_timeout')||7200000,ca=u.create('tab_controller');function da(oa,pa,qa){var ra=o.get().tabs,sa=ra[oa],ta,ua;if(ra.length===0)return false;var va=ra.slice(oa+1),wa=ra.slice(0,oa),xa=va.concat(wa);if(!pa)xa.reverse();if(sa)xa.push(sa);for(var ya=0;ya<xa.length;ya++){ta=xa[ya];ua=r.get(ta.id);if(ua&&ua.isVisible()&&(!qa||ta.raised)){ua.focus();return true;}}return false;}function ea(oa,pa){var qa=pa&&pa.getRightmostHiddenTab();if(qa===oa)return null;return qa;}function fa(){return Math.floor(Math.random()*2147483648).toString(16);}function ga(oa,pa,qa,ra){m.raiseTab(oa,true,qa);var sa=pa&&pa.getLeftmostVisibleTab(),ta=pa&&pa.getTabsToShow();if(ta&&!ta[oa]&&sa){o.promoteThreadInPlaceOfThread(oa,sa,ea(oa,pa),true);}else m.promoteTab(oa);h.inform('chat/open-tab',oa);if(ra)return;var ua=r.get(oa);ua&&ua.focus();}function ha(oa,pa){if(!o.getTab(oa))m.raiseTab(oa,false);var qa=pa&&n.getLRUVisibleTab(pa),ra=pa&&pa.getTabsToShow();if(ra&&!ra[oa]&&qa)o.promoteThreadInPlaceOfThread(oa,qa,ea(oa,pa));}function ia(oa){s.subscribe('selected',function(ra,sa){ga(sa,oa);});h.subscribe('page_transition',function(ra,sa){m.closeFragileTabs();});h.subscribe('chat-visibility/go-offline',function(){m.closeAllTabs();});j.subscribe('idle',function(ra,sa){if(sa>ba){var ta=o.get().tabs;ta.forEach(function(ua){var va=ua.id;aa.getThreadMeta(va,function(wa){if(!wa.unread_count){ca.log('autoclose_idle_seen',{thread_id:va,idleness:sa});m.closeTab(va,'autoclose_idle_seen');}});});}});q.subscribe('nub-activated',function(ra,sa){ga(sa,oa);});q.subscribe('focus-tab',function(ra,sa){var ta=o.getTab(sa);if(ta&&ta.raised)ga(sa,oa,ta.signatureID,false);});function pa(ra,sa){i.log('VideoCallLoggerConfig',{event:'chat_tab_call_click'});t.startOutgoingCall(sa.userID,sa.clickSource,sa.audioOnly);}q.subscribe('video-call-clicked',pa);function qa(ra,sa){t.startMultiwayCall(sa.threadID,sa.usersToCall,sa.clickSource,sa.audioOnly);}q.subscribe('group-call-clicked',qa);q.subscribe('interaction-with-tab',function(ra,sa){var ta=o.getTab(sa);ta&&ta.raised&&z.markSeen(sa);});q.subscribe('esc-pressed',function(ra,sa){ca.log('close_esc',{thread_id:sa});var ta=o.indexOf(sa);m.closeTab(sa,'close_esc');setTimeout(function(){da(ta-1,true,true);},0);});y.subscribe('messages-received',function(ra,sa){for(var ta in sa){var ua=sa[ta];for(var va=0;va<ua.length;va++){var wa=ua[va];if(wa.author!=v.getID()){if(!wa.is_unread){ca.log('message_already_read',{action_id:wa.action_id,thread_id:wa.thread_id});continue;}aa.getThreadMeta(ta,function(xa){p.messageIsAllowed(xa,wa,function(){ha(ta,oa);l.newMessage(ta,wa);});});}}}});y.subscribe('thread-read-changed',function(ra,sa){for(var ta in sa)if(!sa[ta].mark_as_read){ca.log('autoclose_marked_unread',{thread_id:ta});m.closeTab(ta,'autoclose_marked_unread');}});q.subscribe('tab-pressed',function(ra,sa){return !da(o.indexOf(sa.id),sa.shiftPressed);});h.subscribe(u.DUMP_EVENT,function(ra,sa){sa.chat_controller={auto_close_timeout:ba};});this.openTab=function(ra,sa,ta,ua){ga(ra,sa,fa(),ua);if(ta)ta(r.get(ra));};}if(x.firefox()){var ja=function(){return w.get(document.body,'overflowX')+' '+w.get(document.body,'overflowY');},ka=ja(),la=function(){var oa=ja();if(oa!==ka){ka=oa;h.inform('overflow-applied-to-body');}};if('MutationObserver' in window){var ma=new MutationObserver(la),na={attributes:true,attributeFilter:['class','style']};ma.observe(document.documentElement,na);}else document.documentElement.addEventListener('DOMAttrModified',function(event){if(event.getTarget()===document.documentElement&&(event.attrName==='class'||event.attrName==='style'))la();},false);}f.exports=ia;},null);
__d('ChatTabViewPlaceholder',['DOM','ErrorUtils','React','ReactDOM','cx'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();function m(n,o,p,q,r,s){this.$ChatTabViewPlaceholder1={threadID:o,serverThreadID:p,signatureID:q,root:r,prevTab:s};this.$ChatTabViewPlaceholder2={visible:true,raised:true};n.then((function(t){try{var v=new t(this.$ChatTabViewPlaceholder1.threadID,this.$ChatTabViewPlaceholder1.serverThreadID,this.$ChatTabViewPlaceholder1.signatureID,this.$ChatTabViewPlaceholder1.root,this);v.setVisibleState(this.$ChatTabViewPlaceholder2.visible,this.$ChatTabViewPlaceholder2.raised);this.destroy();this.$ChatTabViewPlaceholder3=v.getTabElem();if(this.$ChatTabViewPlaceholder4)this.$ChatTabViewPlaceholder4(this.$ChatTabViewPlaceholder1.threadID,v);}catch(u){i.reportError(u,false);}}).bind(this));this.render(this.$ChatTabViewPlaceholder1.root,this.$ChatTabViewPlaceholder1.prevTab);}m.prototype.getTabElem=function(){return this.$ChatTabViewPlaceholder3;};m.prototype.onBeingReplaced=function(n){this.$ChatTabViewPlaceholder4=n;};m.prototype.updateSignatureID=function(n){this.$ChatTabViewPlaceholder1.signatureID=n;};m.prototype.getScrollTop=function(){return 0;};m.prototype.appendTo=function(n){h.appendContent(n,this.$ChatTabViewPlaceholder3);};m.prototype.insertBefore=function(n){h.insertBefore(n.getTabElem(),this.$ChatTabViewPlaceholder3);};m.prototype.isFocused=function(){return false;};m.prototype.hasEmptyInput=function(){return true;};m.prototype.destroy=function(){k.unmountComponentAtNode(this.$ChatTabViewPlaceholder3);h.remove(this.$ChatTabViewPlaceholder3);};m.prototype.nextTabIs=function(n){var o=n&&n.getTabElem();return !!(this.$ChatTabViewPlaceholder3&&this.$ChatTabViewPlaceholder3.nextSibling===o);};m.prototype.setVisibleState=function(n,o){this.$ChatTabViewPlaceholder2={visible:n,raised:!!o};this.render(this.$ChatTabViewPlaceholder1.root,this.$ChatTabViewPlaceholder1.prevTab);};m.prototype.render=function(n,o){var p=!this.$ChatTabViewPlaceholder2.visible,q=this.$ChatTabViewPlaceholder2.raised,r="fbNub"+(' '+"_50-v")+(p?' '+"hidden_elem":'')+(q?' '+"opened":'')+(' '+"placeholder")+(' '+"_50mz");if(!this.$ChatTabViewPlaceholder3){var s=h.create('div',{className:r});this.$ChatTabViewPlaceholder3=s;k.render(j.createElement('div',null,j.createElement('span',{className:"fbNubButton"}),'opened ? (',j.createElement('div',{className:"fbNubFlyout fbDockChatTabFlyout _16bz"},j.createElement('div',{className:"fbNubFlyoutTitlebar"}),j.createElement('div',{className:"fbNubFlyoutBody"})),')'),s);if(o&&o.getTabElem()){this.insertBefore(o);}else this.appendTo(n);}else this.$ChatTabViewPlaceholder3.className=r;};f.exports=m;},null);
__d('ChatTabViewLoader',['Bootloader','ChatTabViewPlaceholder','Promise','Run','requireWeak'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m;l('ChatTabView',function(p){return m=p;});var n=new j(function(p){k.onAfterLoad(function(){if(!m){h.loadModules(["ChatTabView"],function(q){m=q;p(q);});}else p(m);});}),o={make:function(p,q,r,s,t){if(m){return new m(p,q,r,s,t);}else return new i(n,p,q,r,s,t);}};f.exports=o;},null);
__d('ChatTabViewCoordinator',['Arbiter','ChatTabModel','ChatTabViewLoader','ChatTabViewSelector','CSS','JSLogger','FBRTCSupport'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=m.create('chat_tab_coordinator');function p(q,r){var s=new k(q),t={},u=false;function v(){var z=i.get(),aa={};z.tabs.forEach(function(ca){aa[ca.id]=1;});o.log('process_tab_changed',{model_tabs:Object.keys(aa),view_tabs:Object.keys(t)});for(var ba in t)if(!aa[ba]){o.log('remove_tab',{tab_id:ba});t[ba].destroy();delete t[ba];}w(z);x(z);if(z.tabNeedsFocus&&!z.tabNeedsFocus.isFocused())z.tabNeedsFocus.focus();}function w(z){var aa=null;z.tabs.forEach(function(ba){var ca=ba.id,da=false;if(!t[ca]){o.log('add_tab',{tab_id:ca});t[ca]=j.make(ca,ba.server_id,ba.signatureID,q,aa);da=true;if(t[ca].onBeingReplaced)t[ca].onBeingReplaced(function(fa,ga){t[fa]=ga;});}else t[ca].updateSignatureID(ba.signatureID);if(t[ca].isFocused())z.tabNeedsFocus=t[ca];if(!da&&!t[ca].nextTabIs(aa)){var ea=t[ca].getScrollTop();if(aa){t[ca].insertBefore(aa);}else t[ca].appendTo(q);if(ea)t[ca].setScrollTop(ea);}aa=t[ca];});}function x(z){var aa=r.getTabsToShow(z),ba=[],ca=false;z.tabs.forEach(function(da){if(!aa[da.id]){t[da.id].setVisibleState(false,da.raised);ba.push(da);}});z.tabs.forEach(function(da){if(aa[da.id]){t[da.id].setVisibleState(true,da.raised);ca|=da.raised;}});s.setTabData(ba);y(ca);}function y(z){if(!z&&u){h.inform('layer_hidden',{type:'ChatTab'});u=false;}else if(z&&!u){h.inform('layer_shown',{type:'ChatTab'});u=true;}}if(n.isSendWebrtcSupported())l.addClass(q,'videoCallEnabled');r.subscribe('tabs-changed',v);v();}f.exports=p;},null);
__d('TabsViewport',['Arbiter','ArbiterMixin','ChatTabModel','Dock','DOM','DOMDimensions','Event','Parent','Vector','ViewportBounds','areJSONRepresentationsEqual','csx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=175,u=269,v=0;function w(){return t;}function x(){return u;}function y(z){this._root=z;var aa=this._recalculateWidth.bind(this);n.listen(window,'resize',aa);k.subscribe('resize',aa);h.subscribeOnce('sidebar/initialized',aa,h.SUBSCRIBE_NEW);j.addListener((function(){return this._recalculateTabs(true);}).bind(this));this._recalculateWidth();this._initialized=true;}Object.assign(y.prototype,i,{_root:null,_initialized:false,_availableWidth:0,_maxShown:1,_viewState:null,_recalculateWidth:function(){var z=y._getAvailableDockWidth(this._root),aa=Math.max(1,Math.floor(z/x())),ba=aa!=this._maxShown;if(!this._viewState||ba||z<=this._viewState.usedWidth||z>this._viewState.widthToShowNext){this._availableWidth=z;this._maxShown=aa;this._viewState=null;this._recalculateTabs(ba);}},_onTabsChanged:function(){if(this._initialized){this.inform('tabs-changed');this.inform('max-to-show-changed',this._maxShown);this.inform('max-to-show-change-completed');}},_recalculateTabs:function(z){var aa=y._getTabsToShow(j.get(),this._availableWidth);if(z||!r(this._viewState,aa)){this._viewState=aa;this._onTabsChanged();}},getMaxTabsToShow:function(){return this._maxShown;},checkWidth:function(){this._recalculateWidth();},hasRoomForRaisedTab:function(){return this._availableWidth-this._viewState.usedWidth>x();},getTabsToShow:function(){return JSON.parse(JSON.stringify(this._viewState.tabsToShow));},getShowingTabsOrder:function(){var z=j.get(),aa=this._viewState.tabsToShow;return z.tabs.filter(function(ba){return aa[ba.id];});},getRightmostHiddenTab:function(){var z=j.get(),aa=this._viewState.tabsToShow,ba=z.tabs.filter(function(da){return !aa[da.id];}),ca=ba.shift();return ca?ca.id:null;},getLeftmostVisibleTab:function(){var z=this.getShowingTabsOrder(),aa=z.pop();return aa?aa.id:null;},getRaisedVisibleTabs:function(){var z=[],aa=this.getShowingTabsOrder(),ba=aa.length;for(var ca=0;ca<ba;ca++)if(j.getTab(aa[ca].id).raised)z.push(aa[ca].id);return z;},shouldPromoteOnRaise:function(z){if(!this._viewState.tabsToShow[z])return true;if(this._viewState.nextToHide!=z)return false;var aa=j.getTab(z),ba=aa&&aa.raised;return !ba&&this._availableWidth-this._viewState.usedWidth<x()-w();}});Object.assign(y,{_getAvailableDockWidth:function(z){var aa=m.getViewportWithoutScrollbarDimensions().width;aa-=q.getLeft()+q.getRight();aa-=50;var ba=o.byClass(z,'fbDock'),ca=l.find(ba,"._56ox"),da=ca?p.getElementDimensions(ca).x:0;aa-=da;var ea=l.scry(ba,"._56oy");da+=p.getElementDimensions(ea.pop()).x;var fa=p.getElementDimensions(ba),ga=fa.x-da;if(ga>v)v=ga;aa-=v;aa-=15;return Math.max(aa,0);},_getTabsToShow:function(z,aa){aa=Math.max(aa,x()+1);function ba(ra,sa){return ra.raised||!sa?x():w();}var ca=JSON.parse(JSON.stringify(z.tabs)),da=-1,ea=null;if(z.promoted)ca.forEach(function(ra,sa){if(ra.id===z.promoted){da=sa;ea=ra;}});var fa=0,ga=false,ha=0,ia=!ea;ca.forEach(function(ra,sa){var ta=ba(ra,ga);ga=ga||!ra.raised;ra.leftmostOffset=fa+ta;fa+=ta;if(ra.leftmostOffset<aa)ha++;ia|=sa==da;ra.alreadyPlacedPromoted=ia;});function ja(ra,sa,ta){var ua={};for(var va=0;va<sa;va++){var wa=ra[va];if(!wa.alreadyPlacedPromoted&&va==sa-1){ua[ta]=true;}else ua[wa.id]=true;}return ua;}var ka=ja(ca,ha,z.promoted),la=ja(ca,ha-1,z.promoted),ma=null;for(var na in ka)if(!la[na])ma=na;var oa=ca[ha-1],pa=oa?oa.leftmostOffset:0,qa=Infinity;if(ha<ca.length)qa=ca[ha].leftmostOffset;return {nextToHide:ma,tabsToShow:ka,usedWidth:pa,widthToShowNext:qa};}});f.exports=y;},null);
__d('MessengerDispatcher',['Dispatcher'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new h();},null);
__d('MNCommerceActionTypes',['keyMirrorRecursive'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=h({RECEIPT:{LOADED:null,LOAD_ERROR:null,RELOAD:null},SHIPMENT:{LOADED:null,LOAD_ERROR:null,RELOAD:null},DIALOG:{SHOW:null,HIDE:null}});f.exports=i;},null);
__d('MNCommerceDialogStateStore',['FluxStore','MessengerDispatcher','MNCommerceActionTypes'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;'use strict';k=babelHelpers.inherits(m,h);l=k&&k.prototype;function m(){l.constructor.call(this,i);this.$MNCommerceDialogStateStore1=null;this.$MNCommerceDialogStateStore2=null;}m.prototype.__onDispatch=function(n){var o=n.type;switch(o){case j.DIALOG.SHOW:this.$MNCommerceDialogStateStore1=n.dialogContainer;this.$MNCommerceDialogStateStore2=n.state;this.__emitChange();break;case j.DIALOG.HIDE:this.$MNCommerceDialogStateStore1=null;this.$MNCommerceDialogStateStore2=null;this.__emitChange();break;}};m.prototype.getDialogContainer=function(){return this.$MNCommerceDialogStateStore1;};m.prototype.getState=function(){return this.$MNCommerceDialogStateStore2;};f.exports=new m();},null);
__d('MNCommerceDialogContainer.react',['MNCommerceDialogStateStore','PureStoreBasedStateMixin','React'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=j.createClass({displayName:'MNCommerceDialogContainer',mixins:[i(h)],statics:{calculateState:function(){var l=h.getDialogContainer();return {dialogContainer:l};}},render:function(){var l=this.state.dialogContainer;if(!l)return null;return j.createElement(l,null);}});f.exports=k;},null);
__d('P2PActionConstants',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={CREDIT_CARDS_UPDATED:'credit_cards_updated',CHANNEL_EVENTS_ALLOWED:'channel_events_allowed',CHANNEL_EVENTS_IGNORED:'channel_events_ignored',CREDIT_CARD_SAVING:'credit_card_saving',CREDIT_CARD_ADDED:'credit_card_added',CREDIT_CARD_ADDED_ERROR:'credit_card_added_error',CREDIT_CARD_ADDED_ERROR_CLEARED:'credit_card_added_error_cleared',CREDIT_CARD_DELETED:'credit_card_deleted',CREDIT_CARD_DELETED_ERROR:'credit_card_deleted_error',CREDIT_CARD_UPDATED:'credit_card_updated',CREDIT_CARD_UPDATED_ERROR:'credit_card_updated_error',PRESET_CREDIT_CARD_UPDATED:'preset_credit_card_updated',PRESET_CREDIT_CARD_UPDATED_ERROR:'preset_credit_card_updated_error',CREDIT_CARD_VERIFIED:'credit_card_verified',CREDIT_CARD_VERIFIED_ERROR:'credit_card_verified_error',TRANSFERS_UPDATED:'transfers_updated',TRANSFERS_UPDATED_ERROR:'transfers_updated_error',NUX_TRANSFERS_UPDATED:'nux_transfers_updated',TRANSFER_ADDED:'transfer_added',TRANSFER_ADDED_ERROR:'transfer_added_error',TRANSFER_UPDATED:'transfer_updated',TRANSFER_UPDATED_ERROR:'transfer_updated_error',TRANSFER_ACCEPTED:'transfer_accepted',TRANSFER_DECLINED:'transfer_declined',CHAT_SEND_VIEW_OPENED:'chat_send_view_opened',CHAT_SEND_VIEW_CLOSED:'chat_send_view_closed',BIN_NUMBER_VALIDATED:'bin_number_validated',BIN_NUMBER_VALIDATED_ERROR:'bin_number_validated_error',USER_ELIGIBILITY_UDPATED:'user_eligibility_updated',FRIENDS_LIST_UPDATED:'friends_list_updated',DIALOG_SHOWN:'dialog_shown',DIALOG_CLOSED:'dialog_closed',BANNER_STATES_UPDATED:'banner_states_updated',BANNER_DISMISSED:'banner_dismissed',BANNER_VIEWED:'banner_viewed',BANNER_COMPLETED:'banner_completed',MONEYPENNY_TRANSFER_CREATED:'moneypenny_transfer_created',MONEYPENNY_TRANSFER_CREATED_ERROR:'moneypenny_transfer_created_error',PLATFORM_CONTEXT_ADDED:'platform_context_added',PLATFORM_CONTEXT_ADDED_ERROR:'platform_context_added_error',PLATFORM_CONTEXT_SAVE_ERRORS_CLEARED:'platform_context_save_errors_cleared',PLATFORM_CONTEXT_BANNER_DISMISSED:'platform_context_banner_dismissed',PLATFORM_CONTEXT_PRODUCT_ITEM_SOLD:'platform_context_product_item_sold',PLATFORM_CONTEXT_CHANGED:'platform_context_changed',EXTENSIVE_TRANSFER_DETAILS_UPDATED:'extensive_transfer_details_updated',ADDRESS_SAVING:'address_saving',ADDRESSES_UPDATED:'addresses_updated',ADDRESS_ADDED:'address_added',ADDRESS_ADDED_ERROR:'address_added_error',ADDRESS_ADDED_ERROR_CLEARED:'address_added_error_cleared',CHECKOUT_CART_INITATED:'checkout_cart_initiated',CHECKOUT_CART_CREATED:'checkout_cart_created',CHECKOUT_SHIPPING_OPTION_SELECTED:'checkout_shipping_option_selected',CHECKOUT_ADDRESS_SELECTED:'checkout_address_selected',CHECKOUT_CREDIT_CARD_SELECTED:'checkout_credit_card_selected',CHECKOUT_ADDRESS_FORM_TOGGLED:'checkout_address_form_toggled',CHECKOUT_CREDIT_CARD_FORM_TOGGLED:'checkout_credit_card_form_toggled',CHECKOUT_ADDRESS_EDIT_OPTIONS_TOGGLED:'checkout_address_options_toggled',CHECKOUT_CREDIT_CARD_EDIT_OPTIONS_TOGGLED:'checkout_credit_card_edit_options_toggled',CHECKOUT_ADDRESS_FORM_VALIDATED:'checkout_address_form_validated',CHECKOUT_CREDIT_CARD_FORM_VALIDATED:'checkout_credit_card_form_validated',CHECKOUT_EDIT_COMPLETED:'checkout_completed',CHECKOUT_PROCESSING:'checkout_processing',CHECKOUT_BUYER_PROFILE_UPDATED:'checkout_buyer_profile_updated'};f.exports=h;},null);
__d('P2PDispatcher',['Dispatcher'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new h();},null);
__d('P2PDialogStore',['EventEmitter','P2PActionConstants','P2PDispatcher'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;'use strict';var m,n={};k=babelHelpers.inherits(o,h);l=k&&k.prototype;function o(){l.constructor.call(this);m=j.register(this.onEventDispatched.bind(this));n={dialogClass:null,dialogProps:null};}o.prototype.getState=function(){return n;};o.prototype.onEventDispatched=function(p){var q=p.type,r=p.data;switch(q){case i.DIALOG_SHOWN:n.dialogClass=r.dialogClass;n.dialogProps=r.dialogProps;this.emit('change');break;case i.DIALOG_CLOSED:n.dialogClass=null;n.dialogProps=null;this.emit('change');break;}};f.exports=new o();},null);
__d('P2PDialogContainer.react',['P2PDialogStore','React','ReactLayeredComponentMixin'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=i.createClass({displayName:'P2PDialogContainer',mixins:[j],getInitialState:function(){return h.getState();},componentDidMount:function(){this.dialogStoreSub=h.addListener('change',this.onDialogStoreChange);},componentWillUnmount:function(){if(this.dialogStoreSub){this.dialogStoreSub.remove();this.dialogStoreSub=null;}},onDialogStoreChange:function(){this.setState(h.getState());},renderLayers:function(){if(!this.state.dialogClass)return {};var l=this.state.dialogClass;return {dialog:i.createElement(l,this.state.dialogProps)};},render:function(){return null;}});f.exports=k;},null);
__d("FBRTCCallSummaryUploader",["Bootloader"],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={init:function(){h.loadModules(["Banzai","FBRTCCallSummary","FBRTCCallSummaryStore"],function(j,k,l){var m=l.getInstance();j.subscribe(j.SEND,function(){k.logSavedSummaries(m);});});}};f.exports=i;},null);
__d('FBRTCMessageHandler',['Bootloader','FBRTCCallSummaryUploader','FBRTCMessageListener','FBRTCSupport'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=null,m=false,n=null,o={init:function(){if(!m&&k.isReceiveWebrtcSupported()){m=true;i.init();j.init(false);j.once('messageReceived',function(r){p();});j.once('multiwayMessageReceived',function(r){q();});}}};function p(){if(!l)h.loadModules(["FBRTCIncomingCallController","FBRTCIncomingCallDialog","FBRTCMissedVideoCallHandler","FBRTCUnsupportedBrowserMessage"],function(r,s,t,u){l=new r(s,u,new t());j.setMessageHandler(l.onMessageReceived,l);});}function q(){if(!n)h.loadModules(["FBRTCGroupCallIncomingController"],function(r){n=new r();j.setMultiwayMessageHandler(n.onMessageReceived,n);});}f.exports=o;},null);
__d('HotLikeSound',['MercuryConfig','SoundPlayer','StickerConstants'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();i.init(['audio/ogg','audio/mpeg']);var k=[h['sound.hot_like_grow_mp3_url'],h['sound.hot_like_grow_ogg_url']],l=[h['sound.hot_like_pop_mp3_url'],h['sound.hot_like_pop_ogg_url']],m=[h['sound.hot_like_outgoing_small_mp3_url'],h['sound.hot_like_outgoing_small_ogg_url']],n=[h['sound.hot_like_outgoing_medium_mp3_url'],h['sound.hot_like_outgoing_medium_ogg_url']],o=[h['sound.hot_like_outgoing_large_mp3_url'],h['sound.hot_like_outgoing_large_ogg_url']],p=function(){return false;},q={setCheckSoundEnabledFunc:function(r){p=r;},start:function(){this._play(k);},stop:function(){i.stop(k);},pop:function(){this.stop();this._play(l);},snap:function(r){this.stop();if(r===j.HOT_LIKE_SMALL_STICKER_ID)this._play(m);if(r===j.HOT_LIKE_MEDIUM_STICKER_ID)this._play(n);if(r===j.HOT_LIKE_LARGE_STICKER_ID)this._play(o);},_play:function(r){if(p())i.play(r);}};f.exports=q;},null);
__d('ChatApp',['CSS','ChatPerfInstrumentation','DOM','JSLogger','Promise','React','ReactDOM','csx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';if(c.__markCompiled)c.__markCompiled();var p={init:function(v,w,x){if(this._isInitialized){k.create('chat_app').error('repeated_init');return;}this._rootElem=v;l.resolve().then(function(){return i.init();}).then(function(){return q();}).then(function(){return r(x);}).then(function(){return s(w,v);}).then(function(){return t();}).then((function(){this._isInitialized=this._isLoaded=true;i.logTTI();}).bind(this)).done(function(){return u(x);});},isInitialized:function(){return !!this._isInitialized;},isHidden:function(){return !this._isInitialized||this._isHidden;},hide:function(){if(this.isHidden())return;h.hide(this._rootElem);this._isHidden=true;},unhide:function(){if(this._isInitialized){if(this._isHidden){h.show(this._rootElem);this.tabsViewport.checkWidth();e(['Dock'],function(v){v.resizeAllFlyouts();});this._isHidden=false;}}else if(!this._isLoaded){e(['UIPagelet'],function(v){v.loadFromEndpoint('ChatTabsPagelet','ChatTabsPagelet');v.loadFromEndpoint('BuddylistPagelet','BuddylistPagelet');});this._isLoaded=true;}}};function q(){return new l(function(v){e(['MercuryBlockedParticipants','MercuryChannelHandler','MercuryDelayedRoger','MercuryDeliveryReceipts','MercuryDeliveryState','MercuryParticipants','MercuryStateCheck','MercuryThreads','MercuryUnreadState','MercuryUnseenState','MercurySyncDispatcher'],function(w,x,y,z,aa,ba,ca,da,ea,fa,ga){w.get();x.get().turnOn();y;z.get();aa.get();ba;da.get();fa.get();ea.get();ca.get();ga.get();v();});});}function r(v){return new l(function(w){e(['MercuryServerPayloadPreprocessor'],function(x){x.get().handleUpdate(v);w();});});}function s(v,w){return new l(function(x){e(['ChatTabController','ChatTabViewCoordinator','TabsViewport','MNCommerceDialogContainer.react','P2PDialogContainer.react','FBRTCMessageHandler'],function(y,z,aa,ba,ca,da){p.tabsViewport=new aa(v);p.tabViewCoordinator=new z(v,p.tabsViewport);p.tabController=new y(p.tabsViewport);da.init();var ea=j.find(w,"._26-x");n.render(m.createElement(ba,null),ea);var fa=j.find(w,"._26-y");n.render(m.createElement(ca,null),fa);x();});});}function t(){return new l(function(v){e(['HotLikeSound','ChatOptions'],function(w,x){w.setCheckSoundEnabledFunc(function(){return x.getSetting('sound');});v();});});}function u(v){if(!v.threads_to_auto_open||!p.tabsViewport.hasRoomForRaisedTab())return;e(['ChatOpenTab'],function(w){w.openThread(v.threads_to_auto_open.thread_fbid,'autoOpenTab','',null,true);});}f.exports=p;},null);]7      VKVK;uWKT   Ba,:https://fbstatic-a.akamaihd.net/rsrc.php/v2/yH/r/gTxV8DQ4pyP.js necko:classified 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8F+O2DZM7ZTG6GukivU8OT5gAAAAAAAAXAMIIFvDCCBKSgAwIBAgIUPbXhC4Xsu7H3z2HTJ2qImwWmfEMwDQYJKoZIhvcNAQELBQAwgY0xCzAJBgNVBAYTAk5MMRIwEAYDVQQHEwlBbXN0ZXJkYW0xJTAjBgNVBAoTHFZlcml6b24gRW50ZXJwcmlzZSBTb2x1dGlvbnMxEzARBgNVBAsTCkN5YmVydHJ1c3QxLjAsBgNVBAMTJVZlcml6b24gQWthbWFpIFN1cmVTZXJ2ZXIgQ0EgRzE0LVNIQTIwHhcNMTUwODI3MTYxMDEyWhcNMTYwODI3MTYxMDExWjBtMQswCQYDVQQGEwJVUzELMAkGA1UECBMCTUExEjAQBgNVBAcTCUNhbWJyaWRnZTEhMB8GA1UEChMYQWthbWFpIFRlY2hub2xvZ2llcyBJbmMuMRowGAYDVQQDExFhMjQ4LmUuYWthbWFpLm5ldDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMEsC1Bf+D5X49PrJxQQynzSoPaTqlm/R6G6xlDErWOJauViiexo6vmzahzzSlMEPVYpyT5oRd3SB4Qx7548TyiC90yse+aFur0qrNLeNMG7npVWA0up2v4a8msqYRACxoHcLolFXNFPNWtBTsRW42Ce+pg94pP4gWvBeFVclt3v9x2mr8RHafRNVLJvAJi+eg2mZlfeccqCWrIXKp/xZGUWBswTK+TFC2s1pJNxQkDMYpmLdgte0H0h4IRh8V7elj7TP/8Z8i0l4SxIHNbuqA8HvjBsundiNujlykBR9JSvX238ATPLOFrqkQQz6UAYHo2RRH7X72Uvbitu38jPYVcCAwEAAaOCAjEwggItMAwGA1UdEwEB/wQCMAAwTAYDVR0gBEUwQzBBBgkrBgEEAbE+ATIwNDAyBggrBgEFBQcCARYmaHR0cHM6Ly9zZWN1cmUub21uaXJvb3QuY29tL3JlcG9zaXRvcnkwga8GCCsGAQUFBwEBBIGiMIGfMC0GCCsGAQUFBzABhiFodHRwOi8vdmFzc2cxNDIub2NzcC5vbW5pcm9vdC5jb20wNgYIKwYBBQUHMAKGKmh0dHBzOi8vY2FjZXJ0LmEub21uaXJvb3QuY29tL3Zhc3NnMTQyLmNydDA2BggrBgEFBQcwAoYqaHR0cHM6Ly9jYWNlcnQuYS5vbW5pcm9vdC5jb20vdmFzc2cxNDIuZGVyMG4GA1UdEQRnMGWCEWEyNDguZS5ha2FtYWkubmV0gg4qLmFrYW1haWhkLm5ldIIWKi5ha2FtYWloZC1zdGFnaW5nLm5ldIIPKi5ha2FtYWl6ZWQubmV0ghcqLmFrYW1haXplZC1zdGFnaW5nLm5ldDAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMB8GA1UdIwQYMBaAFPi9+q9zd8bHG/lLTRGn0TOvr3IRMD4GA1UdHwQ3MDUwM6AxoC+GLWh0dHA6Ly92YXNzZzE0Mi5jcmwub21uaXJvb3QuY29tL3Zhc3NnMTQyLmNybDAdBgNVHQ4EFgQUwHfR+EVeIyYOCfrHIM4gYFwsUd8wDQYJKoZIhvcNAQELBQADggEBALu54DWULbb7PuC5sYITWHJAFLikko7suU7mUu2a/QvS/GNNHfm4ny+on2w++/itYAKrsNMXkX1zglqtX6AACSUlgw7K6G7CoEVJXBntkBmt9wAJXroe2jMgWYvpbmYkcyaNRc4VvOK9FjvHslqXa5Y6NArfI5kRfdljblFQXR2sTYyYk0Dqqq8COCs62GhyLlP/oohQU0hA6EtomF5VFNlokO9qa+IAHrp2lR/+BLYcwPgOCxszCZikcmP5zyAnkte1Blh9kBQnKf6J6wTZsUUPcLktNr7FFqRIay8moKUuxYiSqlE4kSktcYqXy5cGrgYfwGYM93+0O3y8QZ30vLHALwADAAAAAAEBAAA= request-method GET response-head HTTP/1.1 200 OK
access-control-allow-origin: *
Cache-Control: public, max-age=31358706
Content-MD5: iou5zMYQr2p9XATieyDJTw==
Content-Type: application/x-javascript; charset=utf-8
Date: Thu, 15 Oct 2015 15:55:14 GMT
Expires: Wed, 12 Oct 2016 14:40:20 GMT
Last-Modified: Mon, 01 Jan 2001 08:00:00 GMT
Timing-Allow-Origin: *
x-content-type-options: nosniff
X-FB-Debug: jM89vCRNTQm9ryR1yvUZVz3e7PZLY67K4/C/nV1CVzZk+OXq/RzOvmayHbu+dxKeBgIdzE5f2A8p3j5bLa4HBQ==
X-Firefox-Spdy: 3.1
 uncompressed-len 0  