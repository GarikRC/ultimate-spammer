/*!CK:1974659906!*//*1444839713,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["JGh9a"]); }

__d("GroupSellComposerActionEvents",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={COMPOSER_LOAD:"composer_load",LAUNCH_SELL_COMPOSER:"launch_sell_composer",SELL_COMPOSER_POST_TO_MARKETPLACE_SEEN:"sell_composer_post_to_marketplace_seen",CROSS_POST_CHECKBOX_SEEN:"cross_post_checkbox_seen",LAUNCH_NORMAL_COMPOSER:"launch_normal_composer",COMPOSER_FILL_TITLE:"composer_fill_title",COMPOSER_FILL_PRICE:"composer_fill_price",COMPOSER_FILL_DESCRIPTION:"composer_fill_description",COMPOSER_FILL_PICKUP_NOTE:"composer_fill_pickup_note",COMPOSER_FILL_CATEGORY:"composer_fill_category",COMPOSER_LOCATION_DEFAULT_TYPE:"composer_location_default_type",COMPOSER_ADD_PHOTO:"composer_add_photo",COMPOSER_DELETE_PHOTO:"composer_delete_photo",COMPOSER_SUBMIT:"composer_submit",COMPOSER_SUBMIT_ENABLED:"composer_submit_enabled",COMPOSER_FILL_DESCRIPTION_REGULAR:"composer_fill_description_regular",COMPOSER_ADD_PHOTO_REGULAR:"composer_add_photo_regular",COMPOSER_DELETE_PHOTO_REGULAR:"composer_delete_photo_regular",COMPOSER_SUBMIT_REGULAR:"composer_submit_regular",COMPOSER_INVALID_FIELD_SUBMISSION:"composer_invalid_field_submission",GROUP_POST:"group_post",GROUP_NON_FOR_SALE_POST:"group_non_for_sale_post",COMPOSER_TUTORIAL_VIDEO_SHOW:"composer_tutorial_video_show",COMPOSER_TUTORIAL_VIDEO_COMPLETE:"composer_tutorial_video_complete",COMPOSER_TUTORIAL_VIDEO_CONFIRM:"composer_tutorial_video_confirm",COMPOSER_TUTORIAL_VIDEO_CLOSE:"composer_tutorial_video_close",COMPOSER_TUTORIAL_VIDEO_NO_FLASH:"composer_tutorial_video_no_flash"};},null,{});
__d('ComposerXHiddenInputClear',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){i.element.value='';}f.exports=h;},null);
__d("ComposerXSessionInputClear",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){i.element.value=new Date().valueOf().toString().substr(0,10);}f.exports=h;},null);
__d('ComposerTagSuggestionsWaterfall',['Banzai'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i='composer_tag_suggestions';function j(k){'use strict';this._waterfallID=k;}j.prototype.setWaterfallID=function(k){'use strict';this._waterfallID=k;};j.prototype._logStep=function(k,l){'use strict';l=babelHelpers._extends({},l||{},{waterfall_id:this._waterfallID,step:k});h.post(i,l);return this;};j.prototype.logBegin=function(){'use strict';return this._logStep('begin');};j.prototype.logAddPhoto=function(k){'use strict';return this._logStep('add_photo',{photo:k});};j.prototype.logAddPhotos=function(k){'use strict';k.forEach(this.logAddPhoto.bind(this));};j.prototype.logRemovePhoto=function(k,l,m){'use strict';return this._logStep('remove_photo',{photo:k,tokens:l,suggestions:m});};j.prototype.logAddToken=function(k,l){'use strict';return this._logStep('add_token',{user:k,replaced_with_tag:l});};j.prototype.logRemoveToken=function(k,l){'use strict';return this._logStep('remove_token',{user:k,suggestions:l});};j.prototype.logAddSuggestion=function(k,l,m,n){'use strict';return this._logStep('add_suggestion',{photo:k,facebox:l,user:m,certainty:n});};j.prototype.logRemoveSuggestion=function(k,l,m,n){'use strict';return this._logStep('remove_suggestion',{photo:k,facebox:l,user:m,certainty:n});};j.prototype.logAddManualTag=function(k,l,m){'use strict';return this._logStep('add_tag',{photo:k,facebox:l,user:m});};j.prototype.logRemoveManualTag=function(k,l,m){'use strict';return this._logStep('remove_tag',{photo:k,facebox:l,user:m});};j.prototype.logStartPoll=function(k){'use strict';return this._logStep('start_poll',{photos:k});};j.prototype.logStopPoll=function(k,l){'use strict';return this._logStep('stop_poll',{time_spent:k,unresolved_photos:l});};j.prototype.logSubmit=function(k,l,m,n,o,p){'use strict';return this._logStep('submit',{photos:k,tokens:l,manual_tokens:m,suggestions:n,manual_tags:o,time_spent:p});};j.prototype.logFailure=function(k,l){'use strict';return this._logStep('fail',{photo:k,user:l});};f.exports=j;},null);
__d('FaceRecognitionController',['ArbiterMixin','BanzaiODS','Poller','mixin','removeFromArray'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=babelHelpers.inherits(o,k(h));n=m&&m.prototype;function o(p){'use strict';n.constructor.call(this);this._config=babelHelpers._extends({uri:'/photos/tagging/recognition/',interval:2000,maxRequests:4,targetIsPage:false,targetID:null},p);this._cleanup();this._poller=new j({dontStart:true,maxRequests:this._config.maxRequests,interval:this._config.interval,setupRequest:(function(q){q.setURI(this._config.uri).setData({recognition_project:'composer_facerec',photos:this._pendingPhotos,waterfallID:this._config.waterfallID,target:this._config.targetID,is_page:this._config.targetIsPage,include_unrecognized_faceboxes:!!this._config.include_unrecognized_faceboxes,include_face_crop_src:!!this._config.include_face_crop_src,include_recognized_user_profile_picture:!!this._config.include_recognized_user_profile_picture,include_low_confidence_recognitions:!!this._config.include_low_confidence_recognitions}).setHandler(this._handleResponse.bind(this));}).bind(this)});this._poller.subscribe('done',(function(){var q=this._pendingPhotos;this._cleanup();this.inform('done',{unresolved:q});}).bind(this));}o.prototype.setWaterfallID=function(p){'use strict';this._config.waterfallID=p;};o.prototype.start=function(p){'use strict';Array.prototype.push.apply(this._pendingPhotos,p);this._poller.reset();this._resetSafeguardTimeout();};o.prototype.stop=function(){'use strict';this._poller.stop();this._cleanup();};o.prototype._cleanup=function(){'use strict';window.clearTimeout(this._safeguardTimeout);this._safeguardTimeout=null;this._pendingPhotos=[];};o.prototype._resetSafeguardTimeout=function(){'use strict';window.clearTimeout(this._safeguardTimeout);this._safeguardTimeout=window.setTimeout((function(){i.bumpEntityKey('composer_facerec','safeguard');var p=this._pendingPhotos;this._poller.stop();this._cleanup();this.inform('done',{unresolved:p});}).bind(this),(this._config.maxRequests+2)*this._config.interval);};o.prototype._handleResponse=function(p){'use strict';var q=p.getPayload();q.forEach((function(r){var s=0;l(this._pendingPhotos,r.fbid);r.faceboxes.forEach((function(t){s+=t.recognitions.length;t.recognitions.forEach((function(u){this.inform('recognition',{photo:r.fbid,facebox:{fbid:t.fbid,x:t.x,y:t.y},recognition:u});}).bind(this));}).bind(this));this.inform('photo',{photo:r.fbid,faceboxes:r.faceboxes,recognitions:s});}).bind(this));if(!this._pendingPhotos.length){this._poller.stop();this._cleanup();this.inform('done',{unresolved:this._pendingPhotos});}};f.exports=o;},null);
__d('AttachmentWithPhotoEditorTaggingMixin',['Arbiter','ComposerTagSuggestionsWaterfall','DOM','FaceRecognitionController','Form','Map','Parent','PhotoTagStore','SubscriptionsHandler'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();f.exports={initPhotoEditorTaggingMixin:function(){this._tagStore=o.getInstance();this._tagsWaitingForFaceboxes=new m();this._photoEditorTagging={};this._photoEditorTagging.uploadArea=this.getUploadArea();this._photoEditorTagging.xyTagInputs={};this._photoEditorTagging.subscriptions=new p();this._photoEditorTagging.recognitionController=new k({include_unrecognized_faceboxes:true});this._photoEditorTagging.faceRecSubmitButtonLock=null;var q=this.getWaterfallID();this._photoEditorTagging.tagSuggestionsWaterfall=new i(q);this._photoEditorTagging.tagSuggestionsWaterfall.logBegin();this._photoEditorTagging.flowBeginTimestamp=Date.now();this._photoEditorTagging.subscriptions.addSubscriptions(h.subscribe('AttachmentsPhotoEditor/tagsUpdated'+this.getGridID(),this._onTagsUpdatedForPhoto.bind(this)),h.subscribe('AttachmentsPhotoEditor/requestFaceboxes'+this.getGridID(),this._onFaceboxesRequestedForPhoto.bind(this)),h.subscribe('multi-upload/images-added/'+this.getGridID(),this._onImageAdded.bind(this)),h.subscribe('multi-upload/image-removed/'+this.getGridID(),this._onImageRemoved.bind(this)),this._photoEditorTagging.recognitionController.subscribe('photo',this._onPhotoRecognitionComplete.bind(this)),this._photoEditorTagging.recognitionController.subscribe('done',this._onRecognitionDone.bind(this)));var r=this.getComponentInstance('withtagger');if(r)this._photoEditorTagging.subscriptions.addSubscriptions(r.subscribe('removeToken',this._onTokenRemoved.bind(this)));this._tagStore.clear();this._taggingFlyoutData=this._photoEditorTagging;},setPhotoEditorFaceRecSubmitButtonLock:function(q){this._photoEditorTagging.faceRecSubmitButtonLock=q;},_onFaceboxesRequestedForPhoto:function(q,r){var s=r.fbid,t=r.tags;if(r.shouldTransferFaceboxTags)this._tagsWaitingForFaceboxes.set(s,t);this._photoEditorTagging.faceRecSubmitButtonLock.lock();this._photoEditorTagging.recognitionController.start([s]);},_onPhotoRecognitionComplete:function(q,r){var s=r.photo,t=this._tagsWaitingForFaceboxes.get(s),u=r.faceboxes;if(t){t=t.map((function(v){if(!v.from_facebox)return v;for(var w=0;w<u.length;++w)if(this._isTagInFacebox(v,u[w])){v.x=u[w].x;v.y=u[w].y;v.facebox=u[w].fbid;u.splice(w,1);return v;}v.from_facebox=false;delete v.facebox;return v;}).bind(this));this._tagsWaitingForFaceboxes['delete'](s);}else{t=[];u.forEach((function(v){if(v.recognitions.length)t.push({fbid:this._fbid,x:v.x,y:v.y,subject:v.recognitions[0].user.fbid,name:v.recognitions[0].user.name,from_facebox:true,facebox:v.fbid});}).bind(this));}this._photoEditorTagging.faceRecSubmitButtonLock.unlock();this._updateTagsForPhoto(s,t);},_onRecognitionDone:function(q,r){r.unresolved.forEach((function(s){var t=this._tagsWaitingForFaceboxes.get(s)||[];t=t.map(function(u){u.from_facebox=false;delete u.facebox;return u;});this._tagsWaitingForFaceboxes['delete'](s);this._updateTagsForPhoto(s,t);}).bind(this));},_isTagInFacebox:function(q,r){return q.x>=r.left&&q.x<=r.left+r.width&&q.y>=r.top&&q.y<=r.top+r.height;},_onTagsUpdatedForPhoto:function(q,r){this._updateTagsForPhoto(r.fbid,r.tags);},_updateTagsForPhoto:function(q,r){var s=false,t=this.getComponentInstance('withtagger');this._removeTagsForPhoto(q);r.forEach((function(u){s=this._tagStore.userHasDirtyTags(u.subject);u.fbid=q;this._tagStore.storeTagWithOptions(q,u.subject,u.x,u.y,u);if(t&&!s)t.replaceToken(t.createDecorativeToken({uid:u.subject,text:u.name},'faceSuggestion'));}).bind(this));h.inform('AttachmentsPhotoEditor/tagStateChanged'+q,!!r.length);this._updateXYTagsInputs();},_onImageAdded:function(){if(this.getComponent('withtagger'))this.getTagger().eventuallySwitchToTagger('with');},_onImageRemoved:function(q,r){this._removeTagsForPhoto(r);this._updateXYTagsInputs();},_removeTagsForPhoto:function(q){var r=this.getComponentInstance('withtagger'),s;if(r){s=Object.keys(this._tagStore.getPhotoTags(q));this._tagStore.removeAllTagsFromPhoto(q);s.forEach((function(t){if(!this._tagStore.userHasDirtyTags(t))r.removeToken(r.findToken({uid:t}));}).bind(this));}},_updateXYTagsInputs:function(){var q=n.byTag(this.getSubmitButton(),'form');this._removeAllXYTagInputs();var r=this._tagStore.getAllTags();l.createHiddenInputs({xy_tags:r},q,this._photoEditorTagging.xyTagInputs);},_removeAllXYTagInputs:function(){for(var q in this._photoEditorTagging.xyTagInputs)j.remove(this._photoEditorTagging.xyTagInputs[q]);this._photoEditorTagging.xyTagInputs={};},_onTokenRemoved:function(q,r){var s=r.info.uid,t=this._tagStore.removeAllNewTagsOfUser(s);t.forEach((function(u){if(!this._tagStore.photoHasTags(u.fbid))h.inform('AttachmentsPhotoEditor/tagStateChanged'+u.fbid,false);}).bind(this));this._updateXYTagsInputs();},cleanupPhotoEditorTagging:function(){this._photoEditorTagging.subscriptions.release();this._photoEditorTagging.subscriptions.engage();},resetPhotoEditorTagging:function(){this._tagStore.clear();this._removeAllXYTagInputs();}};},null);
__d("InstanceRegistry",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(){"use strict";this.instances={};this.waits=[];}h.prototype.set=function(i,j){"use strict";this.instances[i]=j;this.waits=this.waits.filter((function(k){if(this._isWaitResolved(k.names)){k.callback.apply(this,this._mapNamesToInstances(k.names));return false;}return true;}).bind(this));};h.prototype.get=function(i){"use strict";return this.instances[i];};h.prototype.remove=function(i){"use strict";delete this.instances[i];};h.prototype.waitFor=function(i,j){"use strict";if(this._isWaitResolved(i))return j.apply(this,this._mapNamesToInstances(i));this.waits.push({names:i,callback:j});};h.prototype.waitForAndRemove=function(i,j){"use strict";this.waitFor(i,(function(){j.apply(this,arguments);i.forEach(this.remove.bind(this));}).bind(this));};h.prototype._isWaitResolved=function(i){"use strict";return i.every(this.instances.hasOwnProperty.bind(this.instances));};h.prototype._mapNamesToInstances=function(i){"use strict";return i.map((function(j){return this.instances[j];}).bind(this));};f.exports=new h();},null);
__d('PhotosTaggingFlyoutLoader',['ArbiterMixin','AsyncRequest','InstanceRegistry','URI','arrayContains','mixin','removeFromArray'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o,p;o=babelHelpers.inherits(q,m(h));p=o&&o.prototype;function q(r){'use strict';p.constructor.call(this);this._flyouts={};this._loading=[];this._callbacks={};this._targetID=r;}q.prototype.get=function(r,s){'use strict';if(this._isLoaded(r))return s(this._flyouts[r]);this._callbacks[r]=this._callbacks[r]||[];if(!this._isLoading(r))this._load(r);this._callbacks[r].push(s);};q.prototype.whenLoaded=function(r,s){'use strict';if(this._isLoaded(r))return s(this._flyouts[r]);this._callbacks[r]=this._callbacks[r]||[];this._callbacks[r].push(s);};q.prototype._load=function(r){'use strict';if(this._isLoading(r))return;this._loading.push(r);new i().setURI(new k('/ajax/photos/tagging-flyout/').addQueryData({photo:r,target:this._targetID,recognitionFeature:'composer_facerec'})).setHandler((function(){j.waitForAndRemove(['PhotosTaggingFlyout_'+r],(function(s){if(!this._isLoading(r))return;this.inform('loaded',s);this._flyouts[r]=s;this._callbacks[r].forEach(function(t){t(s);});delete this._callbacks[r];}).bind(this));}).bind(this)).setFinallyHandler((function(){n(this._loading,r);}).bind(this)).send();};q.prototype._isLoading=function(r){'use strict';return l(this._loading,r);};q.prototype._isLoaded=function(r){'use strict';return !!this._flyouts[r];};q.prototype.remove=function(r){'use strict';if(this._isLoaded(r))this._flyouts[r].cleanup();delete this._flyouts[r];delete this._callbacks[r];n(this._loading,r);};q.prototype.cleanup=function(){'use strict';Object.keys(this._flyouts).forEach(this.remove.bind(this));Object.keys(this._callbacks).forEach(this.remove.bind(this));};f.exports=q;},null);
__d('AttachmentWithPhotosTaggingFlyoutMixin',['Event','Arbiter','PhotoTagStore','ComposerTagSuggestionsWaterfall','PhotosTaggingFlyoutLoader','BanzaiODS','FaceRecognitionController','ComposerXNUX','DOM','CSS','cx','csx','DOMQuery','isEmpty','fbt','Tooltip','Parent','Form','SubscriptionsHandler','PhotosUploadWaterfallXMixin','AsyncRequest','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){if(c.__markCompiled)c.__markCompiled();var da=[];f.exports=Object.assign(aa,{initTaggingFlyoutMixin:function(ea,fa){this._attachment=ea;this._taggingFlyoutData={};this._taggingFlyoutData.root=ea.getRoot();this._taggingFlyoutData.gridID=ea.getGridID();this._taggingFlyoutData.uploadArea=ea.getUploadArea();this._taggingFlyoutData.submitButton=ea.getSubmitButton();this._taggingFlyoutData.tagger=ea.getTagger();this._taggingFlyoutData.config=fa;this._taggingFlyoutData.xyTagInputs={};this._taggingFlyoutData.subscriptions=new z();this._initTaggingFlyout();},setFaceRecSubmitButtonLock:function(ea){this._taggingFlyoutData.faceRecSubmitButtonLock=ea;},initTaggingFlyoutWithComponents:function(){this._taggingFlyoutData.scrollableArea=this._attachment.getScrollableArea();this._taggingFlyoutData.subscriptions.addSubscriptions(i.subscribe('multi-upload/image-removed/'+this._taggingFlyoutData.gridID,this._doHandleImageRemoved.bind(this)),i.subscribe('multi-upload/images-added/'+this._taggingFlyoutData.gridID,this._doHandleImageAdded.bind(this)),this._taggingFlyoutData.recognitionController.subscribe('recognition',this._doHandleRecognitionResult.bind(this)),this._taggingFlyoutData.recognitionController.subscribe('photo',this._doHandlePhotoRecognitionDone.bind(this)),this._taggingFlyoutData.recognitionController.subscribe('done',(function(ga,ha){this._taggingFlyoutData.faceRecSubmitButtonLock.unlock();this._setSubmitButtonTooltip('');ha.unresolved.forEach(function(ia){this._taggingFlyoutData.flyoutLoader.whenLoaded(ia,function(ja){ja.reset();});this._taggingFlyoutData.facerecLogger.bump('facerec_queries_fail');this._taggingFlyoutData.tagSuggestionsWaterfall.logFailure(ia,ha.user);this._doHandlePhotoRecognitionDone(ga,{photo:ia,faceboxes:[],recognitions:0});},this);this._taggingFlyoutData.facerecLogger.bump('facerec_queries_done');this._taggingFlyoutData.tagSuggestionsWaterfall.logStopPoll(Date.now()-this._taggingFlyoutData.pollLastStartedTimestamp,ha.unresolved.length);}).bind(this)));var ea=this.getComponentInstance('withtagger');if(ea)this._taggingFlyoutData.subscriptions.addSubscriptions(ea.subscribe('removeToken',this._doHandleTokenRemoved.bind(this)));j.getInstance().clear();var fa=this.getWaterfallID();this._taggingFlyoutData.tagSuggestionsWaterfall=new k(fa);this._taggingFlyoutData.tagSuggestionsWaterfall.logBegin();this._taggingFlyoutData.flowBeginTimestamp=Date.now();this._taggingFlyoutData.recognitionController.setWaterfallID(fa);},cleanupTaggingFlyout:function(){this._taggingFlyoutData.flyoutLoader.cleanup();if(this._taggingFlyoutData.config.taggingFlyoutNUXDialog)o.onCleanup(this._taggingFlyoutData.config.taggingFlyoutNUXDialog);this.releaseSubscriptions();this.engageSubscriptions();},resetTaggingFlyout:function(){j.getInstance().clear();if(this._taggingFlyoutData){this._taggingFlyoutData.recognitionController.stop();for(var ea in this._taggingFlyoutData.xyTagInputs)p.remove(this._taggingFlyoutData.xyTagInputs[ea]);this._taggingFlyoutData.xyTagInputs={};}},getWaterfallID:function(){throw "Classes using AttachmentWithPhotosTaggingFlyoutMixin "+"should implement getWaterfallID";},releaseSubscriptions:function(){this._taggingFlyoutData.subscriptions.release();},engageSubscriptions:function(){this._taggingFlyoutData.subscriptions.engage();},addSubscriptions:function(){var ea=this._taggingFlyoutData.subscriptions;for(var fa=arguments.length,ga=Array(fa),ha=0;ha<fa;ha++)ga[ha]=arguments[ha];ea.addSubscriptions.apply(ea,ga);},getSubscriptions:function(ea){return this._taggingFlyoutData.subscriptions;},logWithTaggingData:function(ea,fa){var ga=0,ha=this.getComponentInstance('withtagger');if(ha){var ia=j.getInstance(),ja=ha.getTokens();ga=ja.filter(function(ma){return !ia.userHasDirtyTags(ma.info.uid);}).length;var ka=ia.getAllTags(),la=ka.filter(function(ma){return ma.source=='composerx_suggestions';});this._taggingFlyoutData.tagSuggestionsWaterfall.logSubmit(ea,ja.length,ga,la.length,ka.length-la.length,Date.now()-this._taggingFlyoutData.flowBeginTimestamp);}return ga;},_initTaggingFlyout:function(){this._taggingFlyoutData.flyoutLoader=new l(this._taggingFlyoutData.config.targetID);this._taggingFlyoutData.flyoutLoader.subscribe('loaded',(function(ea,fa){this._setupTaggingFlyout(fa);}).bind(this));this._taggingFlyoutData.facerecLogger={bump:function(ea,fa){m.bumpEntityKey('composer_facerec_suggestions',ea,fa);}};this._taggingFlyoutData.recognitionController=new n({targetID:this._taggingFlyoutData.config.targetID,targetIsPage:this._taggingFlyoutData.config.targetIsPage});},_setupTaggingFlyout:function(ea){da.push(ea);if(!this._getPhotoGridItem(ea.getPhotoID()))return;this._taggingFlyoutData.subscriptions.addSubscriptions(ea.subscribe('show',this._onTaggingFlyoutShow.bind(this,ea)),ea.subscribe('beforehide',this._onTaggingFlyoutHide.bind(this,ea)),ea.subscribe('confirm',this._onTaggingFlyoutConfirmed.bind(this,ea)),ea.subscribe('select',this._onTaggingFlyoutSelect.bind(this,ea)),ea.subscribe('unselect',this._onTaggingFlyoutUnselect.bind(this,ea)));},_onTaggingFlyoutShow:function(ea,fa,ga){da.forEach(function(ha){if(ha!=ea)ha.hide();});if(this._taggingFlyoutData.config.taggingFlyoutNUXDialog)o.acknowledgeDialog(o.TAGGING_FLYOUT_NUX,this._taggingFlyoutData.config.taggingFlyoutNUXDialog);ea.setNextButtonVisibility(!this._findNextTaggableGridItem(this._getPhotoGridItem(ea.getPhotoID())));},_onTaggingFlyoutHide:function(ea,fa,ga){q.removeClass(ea.getContext(),"_58pl");q.conditionClass(this._taggingFlyoutData.uploadArea,"_58pk",t.scry(this._taggingFlyoutData.uploadArea,"._58pl").length);},_onTaggingFlyoutConfirmed:function(ea,fa,ga){var ha=this._findNextTaggableGridItem(this._getPhotoGridItem(ea.getPhotoID()));if(!ha)return;if(this._taggingFlyoutData.scrollableArea)this._taggingFlyoutData.scrollableArea.scrollIntoView(ha);q.addClass(this._taggingFlyoutData.uploadArea,"_58pk");q.addClass(ha,"_58pl");this._getTaggingFlyout(ha.getAttribute('data-fbid'),function(ia){ia.show(ha);});},_onTaggingFlyoutSelect:function(ea,fa,ga){q.addClass(this._getPhotoGridItem(ea.getPhotoID()),"_57vj");var ha=j.getInstance().userHasDirtyTags(ga.user);if(!ha)this._taggingFlyoutData.facerecLogger.bump('suggestion_tags_added');j.getInstance().storeTagWithOptions(ga.photo,ga.user,ga.facebox.x,ga.facebox.y,{fbid:ga.photo,name:ga.name,subject:ga.user,from_facebox:true,facebox:ga.facebox.fbid,source:'composerx_flyout'});this._taggingFlyoutData.tagSuggestionsWaterfall.logAddManualTag(ga.photo,ga.facebox.fbid,ga.user);var ia=this.getComponentInstance('withtagger');if(ia)if(!ha){var ja=ia.replaceToken(ia.createDecorativeToken({uid:ga.user,text:ga.name},'faceSuggestion'));this._taggingFlyoutData.tagSuggestionsWaterfall.logAddToken(ga.user,ja);}this._updateXYTagInputs();},_onTaggingFlyoutUnselect:function(ea,fa,ga){this._fireDismissRequest([{facebox:ga.facebox,log_data:{tagee:ga.user,is_first:true}}]);var ha=j.getInstance().removeTag(ga.photo,ga.user);if(u(ha))return;var ia=this._taggingFlyoutData.tagSuggestionsWaterfall;ha.forEach(function(la){if(la.source=='composerx_suggestions'){ia.logRemoveSuggestion(la.fbid,la.facebox,la.subject,la.certainty);}else ia.logRemoveManualTag(la.fbid,la.facebox,la.subject);});q.conditionClass(this._getPhotoGridItem(ea.getPhotoID()),"_57vj",!u(j.getInstance().getPhotoTags(ga.photo)));var ja=j.getInstance().userHasDirtyTags(ga.user),ka=this.getComponentInstance('withtagger');if(ka&&!ja){ka.removeToken(ka.findToken({uid:ga.user}));this._taggingFlyoutData.tagSuggestionsWaterfall.logRemoveToken(ga.user,0);}this._updateXYTagInputs();},_doHandleImageRemoved:function(ea,fa){this._taggingFlyoutData.flyoutLoader.remove(fa);var ga=0,ha=[],ia=this.getComponentInstance('withtagger');if(ia){ha=Object.keys(j.getInstance().getPhotoTags(fa));j.getInstance().removeAllTagsFromPhoto(fa);ha.forEach(function(ja){if(!j.getInstance().userHasDirtyTags(ja)){ga++;ia.removeToken(ia.findToken({uid:ja}));}});}this._taggingFlyoutData.tagSuggestionsWaterfall.logRemovePhoto(fa,ga,ha.length);this._updateXYTagInputs();da.forEach(function(ja){return ja.hide();});},_doHandleImageAdded:function(ea,fa){if(fa.disableRecognition)return;Object.keys(fa.fbids).forEach(function(ga){var ha=fa.fbids[ga],ia=this._getPhotoGridItem(ha);if(ia)q.addClass(ia,"_57vh");},this);this._taggingFlyoutData.tagSuggestionsWaterfall.logAddPhotos(ca(fa.fbids));this._taggingFlyoutData.facerecLogger.bump('photos_queried');if(this.getComponent('withtagger')&&!this._taggingFlyoutData.config.hideWithTagger)this._taggingFlyoutData.tagger.eventuallySwitchToTagger('with');if(!this._taggingFlyoutData.config.applyTagSuggestionsDelay)this._taggingFlyoutData.faceRecSubmitButtonLock.lock();this._taggingFlyoutData.recognitionController.start(ca(fa.fbids));this._setSubmitButtonTooltip(v._("Wird bearbeitet"));this._taggingFlyoutData.pollLastStartedTimestamp=Date.now();this._taggingFlyoutData.tagSuggestionsWaterfall.logStartPoll(Object.keys(fa.fbids).length);},_doHandleRecognitionResult:function(ea,fa){var ga=fa.facebox,ha=fa.recognition,ia=j.getInstance().userHasDirtyTags(ha.user.fbid);this._taggingFlyoutData.facerecLogger.bump('xy_tags_added');this._taggingFlyoutData.tagSuggestionsWaterfall.logAddSuggestion(fa.photo,ga.fbid,ha.user.fbid,ha.certainty);if(!ia)this._taggingFlyoutData.facerecLogger.bump('suggestion_tags_added');j.getInstance().storeTagWithOptions(fa.photo,ha.user.fbid,ga.x,ga.y,{fbid:fa.photo,name:ha.user.name,subject:ha.user.fbid,from_facebox:true,facebox:ga.fbid,certainty:ha.certainty,source:'composerx_suggestions',timestamp:Date.now()});var ja=this.getComponentInstance('withtagger');if(ja){if(!ia){var ka=ja.replaceToken(ja.createDecorativeToken({uid:ha.user.fbid,text:ha.user.name},this._taggingFlyoutData.config.additionalTokensGlyph));this._taggingFlyoutData.tagSuggestionsWaterfall.logAddToken(ha.user.fbid,ka);}this._taggingFlyoutData.tagger.eventuallySwitchToTagger('with');}setTimeout(this._updateXYTagInputs.bind(this),this._taggingFlyoutData.config.applyTagSuggestionsDelay?500:0);},_doHandlePhotoRecognitionDone:function(ea,fa){var ga=fa.photo,ha=this._getPhotoGridItem(ga);if(!ha)return;q.removeClass(ha,"_57vh");if(!this._taggingFlyoutData.config.useTaggingFlyout)return;q.addClass(ha,"_57vi");q.conditionClass(ha,"_57vj",fa.recognitions);q.conditionClass(ha,"_57vk",fa.faceboxes.length);if(fa.recognitions&&this._taggingFlyoutData.config.taggingFlyoutNUXDialog&&!this._taggingFlyoutData.taggingFlyoutNUXShown){this._scrollIntoView(ha);o.onInit(this._taggingFlyoutData.config.taggingFlyoutNUXDialog,ha,o.TAGGING_FLYOUT_NUX);this._taggingFlyoutData.taggingFlyoutNUXShown=true;}this._taggingFlyoutData.subscriptions.addSubscriptions(h.listen(ha,'click',(function(ia){if(q.hasClass(ia.target,'fbVaultGridPhotoItemRemoveButton')||q.hasClass(ia.target,'fbVaultGridPhotoItemEditButton')||q.hasClass(ia.target,"_24iq"))return;q.addClass(this._taggingFlyoutData.uploadArea,"_58pk");q.addClass(ha,"_58pl");this._getTaggingFlyout(ga,function(ja){ja.toggle(ha);});}).bind(this)));},_setSubmitButtonTooltip:function(ea){var fa=t.find(this._taggingFlyoutData.root,"._yo");if(ea){w.set(fa,ea,'above','center');}else{w.remove(fa);fa.setAttribute('aria-label',v._("Posten"));}},_doHandleTokenRemoved:function(ea,fa){var ga=j.getInstance(),ha=fa.info.uid,ia=this._taggingFlyoutData;if(ga.userHasDirtyTags(ha)){var ja=ga.userDirtyTagsCount(ha);ia.tagSuggestionsWaterfall.logRemoveToken(ha,ja);ia.facerecLogger.bump('suggestion_tokens_removed');ia.facerecLogger.bump('xy_tags_removed',ja);}var ka=[];ga.removeAllNewTagsOfUser(ha).forEach((function(la){ka.push({facebox:la.facebox,log_data:{tagee:la.subject,is_first:true}});if(ia.config.useTaggingFlyout){if(!ga.photoHasTags(la.fbid))q.removeClass(this._getPhotoGridItem(la.fbid),"_57vj");ia.flyoutLoader.whenLoaded(la.fbid,function(ma){ma.getFaceboxInstance(la.facebox).reset();});}if(la.source=='composerx_suggestions'){ia.tagSuggestionsWaterfall.logRemoveSuggestion(la.fbid,la.facebox,la.subject,la.certainty);}else ia.tagSuggestionsWaterfall.logRemoveManualTag(la.fbid,la.facebox,la.subject);}).bind(this));this._fireDismissRequest(ka);this._updateXYTagInputs();},_updateXYTagInputs:function(){var ea=x.byTag(this._taggingFlyoutData.submitButton,'form');for(var fa in this._taggingFlyoutData.xyTagInputs)p.remove(this._taggingFlyoutData.xyTagInputs[fa]);var ga=j.getInstance().getAllTags();if(this._taggingFlyoutData.config.applyTagSuggestionsDelay)ga=ga.filter(function(ha){return !ha.timestamp||ha.timestamp+500<=Date.now();});y.createHiddenInputs({xy_tags:ga},ea,this._taggingFlyoutData.xyTagInputs);},_getPhotoGridItem:function(ea){return t.scry(this._taggingFlyoutData.uploadArea,'.fbVaultGridItem[data-fbid="'+ea+'"]')[0];},_findNextTaggableGridItem:function(ea){var fa=t.scry(this._taggingFlyoutData.uploadArea,'.fbVaultGridItem'),ga=fa.indexOf(ea);while(++ga<fa.length)if(q.hasClass(fa[ga],"_57vk"))break;return fa[ga];},_getTaggingFlyout:function(ea,fa){this._taggingFlyoutData.flyoutLoader.get(ea,fa);},_fireDismissRequest:function(ea){if(ea.length>0)new ba().setURI('/ajax/dismiss_tag_suggest.php').setMethod('POST').setData({facebox_logs:ea,closing_source:'composerx_suggestions',closing_action:'no'}).setAllowCrossPageTransition(true).send();},_scrollIntoView:function(ea){if(this._taggingFlyoutData.scrollableArea)this._taggingFlyoutData.scrollableArea.scrollIntoView(ea);}});},null);
__d('ComposerXPrivacyWidgetTags',['Arbiter','CurrentUser','PrivacySelectorBase','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m){'use strict';var n=m.getComponent('mainprivacywidget');if(!n){this._subscriptions=[];return null;}this._privacyWidget=n.element;this._privacyWidgetInstance=n.instance&&n.instance.getInstance().getInstance();this._mentionsInput=m.getComponent('maininput').instance;this._placeTypeahead=m.getComponent('placetagger')?m.getComponent('placetagger').instance:null;this._friendsTokenizer=m.getComponent('withtagger')?m.getComponent('withtagger').instance:null;this._ogTagger=m.getComponent('ogtagger')?m.getComponent('ogtagger').instance:null;this._init();}l.prototype._init=function(){'use strict';this._subscriptions=[this._mentionsInput.subscribe('update',this._informChangedTags.bind(this))];if(this._placeTypeahead){this._subscriptions.push(this._placeTypeahead.subscribe('select',this._onPlaceSelect.bind(this)));this._subscriptions.push(h.subscribe('Events/autoSuggestionSelected',this._onPlaceSelect.bind(this)));this._subscriptions.push(this._placeTypeahead.subscribe('unselect',this._onPlaceUnselect.bind(this)));}if(this._ogTagger)this._subscriptions.push(this._ogTagger.subscribe('composer/eventExpansionChanged',this._informChangedEventExpansion.bind(this)));if(this._friendsTokenizer)this._subscriptions.push(this._friendsTokenizer.subscribe(['addToken','removeToken'],this._informChangedTags.bind(this)));this._informChangedTags();};l.prototype._getTaggedNamesForAudience=function(){'use strict';var m={},n=this._mentionsInput.getMentions();for(var o in n)if(n[o].type=='user')m[o]=n[o].text;if(this._friendsTokenizer)this._friendsTokenizer.getTokens().map(function(p){m[p.getValue()]=p.getText();});delete m[i.getID()];return k(m);};l.prototype._onPlaceSelect=function(m,n){'use strict';this._placeType=n.selected.place_type;this._informChangedTags();};l.prototype._onPlaceUnselect=function(m,n){'use strict';this._placeType=null;this._informChangedTags();};l.prototype._informChangedEventExpansion=function(){'use strict';if(this._privacyWidgetInstance instanceof j)this._privacyWidgetInstance.informEventExpansionChanged(this._ogTagger.getEventExpansionType());};l.prototype._informChangedTags=function(){'use strict';var m=[];if(this._friendsTokenizer)m=this._friendsTokenizer.getTokens();var n=null;if(this._placeType==='Event')n=this._placeTypeahead.getCore().getHiddenValue();var o={withTags:m,mention:this._mentionsInput.getMentions(),eventTag:n};h.inform('Composer/changedtags',o);if(this._privacyWidgetInstance&&this._privacyWidgetInstance instanceof j)this._privacyWidgetInstance.informTagsChanged(o);};l.prototype.destroy=function(){'use strict';while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();};Object.assign(l.prototype,{_subscriptions:null,_placeType:null});f.exports=l;},null);
__d('ComposerXMediaUploadAttachment',['Arbiter','Button','ComposerXAttachment','ComposerXAttachmentUtils','ComposerXAttachmentButtonBarState','ComposerXAttachmentPrefillMixin','ComposerXPrivacyWidgetTags','ComposerXSessionIDInserter','Dialog','DOM','DOMQuery','Event','PagesEventObserver','PagesComposerEntryLogger','Parent','SubscriptionsHandler','classWithMixins','csx','cx','ge','fbt','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){if(c.__markCompiled)c.__markCompiled();var da,ea;da=babelHelpers.inherits(fa,x(j,ca(m)));ea=da&&da.prototype;function fa(ga,ha,ia){'use strict';ea.constructor.call(this);this._root=ga;this._tagger=ha;this._config=ia;this._hasSelected=false;this._subscriptions=new w();this._submitButton=q.find(this._root,"._yo");}fa.prototype.getRoot=function(){'use strict';return this._root;};fa.prototype.getUploadArea=function(){'use strict';return this._uploadArea;};fa.prototype.getSubmitButton=function(){'use strict';return this._submitButton;};fa.prototype.getTagger=function(){'use strict';return this._tagger;};fa.prototype.initWithComponents=function(){'use strict';this._uploadArea=q.find(this._root,"div._yn");this._initFileInput();var ga=this.getComponent('maininput');k.initMentions(ga,this._config.mentionsPlaceholder,this.getComposerID(),{dontFocusMentions:this._config.dontFocusMentions});var ha=r.find(ga.element,'textarea.input');if(!ha.value&&this._config.targetIsPage){this._pagesComposerEntryLogger=new u(this._config.targetID);this._pagesComposerEntryLogger.registerForContentEntryEvents(ha);}if(this._config.prefill)this._initPrefill(r.find(this.getComponent('maininput').element,'textarea.input'),this._config.prefill);this._root.action=this._config.photoEndpoint;this._tagger.init(this);this._privacyWidgetTags=new n(this);l.trackCityChanges(this);h.inform('ComposerXMediaUpload/start');var ia=this._config.fileForm;this._subscriptions.addSubscriptions(ia.subscribe('submit',(function(){o.insertSessionInput(ia.getRoot());}).bind(this)));if(this._config.postActionsButton!=null)this._config.postActionsButton.initHiddenInputs(this.getComponent('pabhiddeninputs').instance);h.inform('composer/render_pab_nux');};fa.prototype.persistUploadArea=function(){'use strict';return false;};fa.prototype.cleanup=function(){'use strict';this._tagger.cleanup();this._privacyWidgetTags&&this._privacyWidgetTags.destroy();this._privacyWidgetTags=null;this._subscriptions.release();this._subscriptions.engage();if(this._pagesComposerEntryLogger)this._pagesComposerEntryLogger.unregister();};fa.prototype.reset=function(){'use strict';this._tagger.reset();this._resetFileInput();if(this._config.prefill)this._resetPrefill();};fa.prototype._resetFileInput=function(){'use strict';q.replace(this._fileInput,this._fileInputCopy);this._initFileInput();};fa.prototype.canSwitchAway=function(){'use strict';return !v.byClass(this._root,'async_saving');};fa.prototype._setSubmitButtonEnabled=function(ga){'use strict';i.setEnabled(this._submitButton,ga);};fa.prototype._isImageFile=function(){'use strict';return !!this._config.imageExtensions[this._getFileExtension()];};fa.prototype._getFileExtension=function(){'use strict';return this._fileInput.value.split('.').pop().toLowerCase();};fa.prototype._initFileInput=function(){'use strict';this._fileInput=q.find(this._root,"._n");this._fileInputCopy=this._fileInput.cloneNode(false);this._subscriptions.addSubscriptions(s.listen(this._fileInput,'change',this._onFileChange.bind(this)));};fa.prototype._onFileChange=function(){'use strict';if(this._isImagesOnly()&&!this._isImageFile()){new p().setTitle(ba._("Ung\u00fcltige Bilddatei")).setBody(ba._("Bitte lade eine g\u00fcltige Bilddatei hoch.")).setModal(true).setButtons([p.OK]).show();this._resetFileInput();}else{q.setContent(aa('fbComposerUploadMediaFilename'),this._fileInput.value.split('\\').pop());this._setSubmitButtonEnabled(!!this._fileInput.value);}var ga=this._getPageSelectLoggingData();if(ga&&!this._hasSelected&&this._fileInput.value){this._hasSelected=true;t.logData_DEPRECATED(ga,null);}};fa.prototype._isImagesOnly=function(){'use strict';return !!this._config.imagesOnly;};fa.prototype._getPageSelectLoggingData=function(){'use strict';return this._config.pageSelectLoggingData;};Object.assign(fa.prototype,{_privacyWidgetTags:null,attachmentClassName:"_92"});f.exports=fa;},null);
__d("Lockable",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(j,k){"use strict";this._onUnlock=j;this._onLock=k;this._isLocked=false;this._locks=[];}h.prototype.getLock=function(){"use strict";var j=new i(this._onLockChanged.bind(this));this._locks.push(j);return j;};h.prototype._onLockChanged=function(){"use strict";var j=this._locks.some(function(k){return k.isLocked();});if(j!==this._isLocked){this._isLocked=j;if(j){this._onLock();}else this._onUnlock();}};function i(j){"use strict";this._isLocked=false;this._onChange=j;}i.prototype.lock=function(){"use strict";if(!this._isLocked){this._isLocked=true;this._onChange();}return this;};i.prototype.unlock=function(){"use strict";if(this._isLocked){this._isLocked=false;this._onChange();}return this;};i.prototype.isLocked=function(){"use strict";return this._isLocked;};f.exports=h;},null);
__d("XComposerXAddPhotoItemController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/composerx\/photo\/item\/",{photo_fbid:{type:"Int",required:true},grid_id:{type:"String",required:true},image_height:{type:"Int",required:true},image_width:{type:"Int",required:true}});},null,{});
__d('ComposerXMediaUploadPlusAttachment',['Event','Arbiter','ComposerXAttachmentUtils','ComposerXController','ComposerXDragDrop','ComposerXDragDropUtils','ComposerXMediaUploadAttachment','CSS','DOM','Lockable','Parent','PhotoEditorSaveStates','PhotosMultiUploadInput','PUWApplications','AsyncRequest','csx','cx','ge','mixin','classWithMixins','AttachmentWithPhotoEditorTaggingMixin','AttachmentWithPhotosTaggingFlyoutMixin','PUWSteps','Scroll','SubscriptionsHandler','XComposerXAddPhotoItemController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){if(c.__markCompiled)c.__markCompiled();var ha,ia;ha=babelHelpers.inherits(ja,aa(n,z(ca,ba)));ia=ha&&ha.prototype;function ja(ka,la,ma){'use strict';ia.constructor.call(this,ka,la,ma);this._cameraIcon=null;this._eventSuggestionQuerySent=false;this._submitButtonLockable=null;this._cleaningUp=false;this._resetting=false;if(this._config.warningDialog)this._config.warningDialog.setContext(this._submitButton);this._photosToInit=this._config.existingPhotos;if(this._config.qualityChooser)this._config.qualityChooser.addListener('checkboxChanged',(function(na){this.getScrollableArea().getUploadItem().getUploadInput().onQualitySettingChanged(na);new v().setURI('/ajax/photos/upload/settings/').setData({composer_resolution:na?'high':'standard'}).send();}).bind(this));}ja.prototype.getPhotoCount=function(){'use strict';return this.getScrollableArea().getPhotoCount();};ja.prototype.getGrid=function(){'use strict';return this._grid;};ja.prototype.getGridID=function(){'use strict';return this._gridID;};ja.prototype.getWaterfallID=function(){'use strict';if(this._grid){return this._grid.getWaterfallID();}else return t.getWaterfallID(this._gridID);};ja.prototype.getWaterfallAppName=function(){'use strict';return u.WEB_COMPOSER;};ja.prototype.getScrollableArea=function(){'use strict';return this.getComponent('upload_area').instance;};ja.prototype.initWithComponents=function(){'use strict';ia.initWithComponents.call(this);this._gridID=this._uploadArea.id;var ka=this.getScrollableArea().getUploadItem(),la=this._config.usePhotoEditorTagging;if(ka&&ka.getUploadInput().getGrid)this._grid=ka.getUploadInput().getGrid();if(la){this.initPhotoEditorTaggingMixin();}else this.initTaggingFlyoutMixin(this,this._config);this.addSubscriptions(i.subscribe('multi-upload/images-upload-start/'+this._gridID,this._onUploadStart.bind(this)),i.subscribe('multi-upload/composer-reset/'+this._gridID,this._handleMultiUploadComposerReset.bind(this)),i.subscribe('multi-upload/images-added/'+this._gridID,this._handleImageAdded.bind(this)),i.subscribe('multi-upload/image-removed/'+this._gridID,this._handleImageRemoved.bind(this)),h.listen(this._root,'submit',this._onSubmit.bind(this),h.Priority.URGENT));if(this.supportsDragDrop()&&!this._dragdrop)this._dragdrop=new l(this._root,this.getComposerID());if(!la)this.initTaggingFlyoutWithComponents();this._cameraIcon=this.getComponent('cameraicon');this._moreLink=p.find(this._root,"._2oh");o.conditionShow(this._moreLink,this._config.isMediaModifiable);var ma=[this._moreLink];this._cameraIcon&&ma.push(this._cameraIcon.element);this.getScrollableArea().initialize(ma,this._config,this._root,this._gridID,this.getComposerID());this.getScrollableArea().setPlaceholderHandler(this._setPlaceholders.bind(this));this._resetSubmitButtonLockable();var na;if(!this._config.allowNoMedia){na=this._submitButtonLockable.getLock().lock();this.getScrollableArea().setEnableComposerHandler(function(oa){if(oa){i.inform('ComposerXMediaUploadPlusAttachment/submitEnabled');na.unlock();}else{i.inform('ComposerXMediaUploadPlusAttachment/submitDisabled');na.lock();}}).setAllMediaRemovedHandler((function(){if(!this._cleaningUp&&!this._resetting)if(k.hasAttachmentWithClassName(this._root,"_4j")){k.getAttachment(this._root,'/ajax/composerx/attachment/status/');}else if(this._config.editPostID)k.getAttachment(this._root,this._config.statusAttachmentEndpoint);}).bind(this));}else{na=this._submitButtonLockable.getLock().unlock();this.getScrollableArea().setEnableComposerHandler(function(oa){i.inform('ComposerXMediaUploadPlusAttachment/submitEnabled');na.unlock();});}if(!this._fileHandler)this._fileHandler=i.subscribe('ComposerXFilesStore/filesAdded/'+this._composerID+'/mediaupload',(function(oa,pa){if(!pa.fileInput.getValue()||pa.receivedBySubscriber)return;pa.receivedBySubscriber=true;if(this._grid){this._grid.doFileUpload(pa.fileInput);}else t.doFileUpload(this._gridID,pa.fileInput);}).bind(this));if(!this._cameraPhotoHandler)this._cameraPhotoHandler=i.subscribe('ComposerXFilesStore/filesAdded/'+this._composerID+'/cameraphoto',(function(oa,pa){var qa=ga.getURIBuilder().setInt('photo_fbid',pa.photoFBID).setString('grid_id',this._gridID).setInt('image_width',this._config.thumbnailSize.width).setInt('image_height',this._config.thumbnailSize.height).getURI();new v(qa).send();}).bind(this));if(this.supportsDragDrop()&&!this._dragdropHandler){this._dragdropHandler=i.subscribe('ComposerXFilesStore/filesDropped/'+this._composerID+'/mediaupload',(function(oa,pa){if(this._grid){this._grid.onFilesDrop(pa.files,pa.method);}else t.onFilesDrop(this._gridID,pa.files);}).bind(this));m.handleDragEnterAndLeave(this._root);}if(!this._photoReminderHandler)this._photoReminderHandler=i.subscribe('ComposerXFilesStore/vaultImagesAdded/'+this._composerID+'/mediaupload',(function(oa,pa){if(!pa.receivedBySubscriber){pa.receivedBySubscriber=true;t.onVaultImagesAdded(this._gridID,pa.photos);}}).bind(this).bind(this));if(this._photosToInit){this._photosToInit.forEach((function(oa){i.inform(['multi-upload/images-added/'+this._gridID,'multi-upload/images-added'],{fbids:{'0':''+oa},tagInfo:{},disableRecognition:true,initialPhoto:true});}).bind(this));this._photosToInit=null;}o.conditionShow(this.getScrollableArea().getUploadArea().getRoot(),this._config.isMediaModifiable||this.getPhotoCount()>0);if(this._config.postActionsButton!=null)this._config.postActionsButton.initHiddenInputs(this.getComponent('pabhiddeninputs').instance);};ja.prototype.reset=function(){'use strict';this._resetting=true;if(this._config.usePhotoEditorTagging){this.resetPhotoEditorTagging();}else this.resetTaggingFlyout();this.getTagger().reset();this._eventSuggestionQuerySent=false;if(this._config.isAutoEventSuggestionEnabled){var ka=y('event_tagging_auto_suggestion');ka&&o.hide(ka);}this._resetting=false;if(this._config.prefill)this._resetPrefill();};ja.prototype._handleImageAdded=function(ka,la){'use strict';this.getScrollableArea().handleImageAdded(ka,la);this._checkPhotoMaxSelect();if(this._config.preShowWithTagger&&this.getComponent('withtagger'))this.getTagger().eventuallySwitchToTagger('with');if(la.tagInfo.exifLocation&&la.tagInfo.exifLocation.latitude&&la.tagInfo.exifLocation.longitude){var ma=this.getComponent('placetagger');if(ma&&ma.instance){ma.instance.getCore().setLocation(la.tagInfo.exifLocation);this.getTagger().eventuallySwitchToTagger('place');}}if(!this._config.isAutoEventSuggestionEnabled)return;if(this.getComponent('hiddenplaceinput').element.value)return;if(this._eventSuggestionQuerySent)return;this._sendEventsSuggestionRequest({fbid:la.fbids[Object.keys(la.fbids)[0]],anchor_id:'composerCityTagger'});this._eventSuggestionQuerySent=true;};ja.prototype._handleImageRemoved=function(ka,la){'use strict';this.getScrollableArea().handleImageRemoved(ka,la);this._checkPhotoMaxSelect();};ja.prototype._handleMultiUploadComposerReset=function(){'use strict';this._resetting=true;this.getScrollableArea().reset();this._resetting=false;};ja.prototype.cleanup=function(){'use strict';this._cleaningUp=true;if(this._config.usePhotoEditorTagging){this.cleanupPhotoEditorTagging();}else this.cleanupTaggingFlyout();ia.cleanup.call(this);if(!this.persistUploadArea())this.getScrollableArea().cleanup();this._moreLinkListener&&this._moreLinkListener.remove();if(this.getComponent('withtagger'))this._withTaggerIconListener&&this._withTaggerIconListener.remove();if(this._fileHandler){this._fileHandler.unsubscribe();this._fileHandler=null;}if(this._dragdrop){this._dragdrop.deactivate();this._dragdrop=null;}if(this._photoReminderHandler){this._photoReminderHandler.unsubscribe();this._photoReminderHandler=null;}this._cleaningUp=false;};ja.prototype.canSwitchAway=function(){'use strict';return !r.byClass(this._root,'async_saving');};ja.prototype.supportsDragDrop=function(){'use strict';return this._config.maxSelect!==1;};ja.prototype._setPlaceholders=function(ka,la){'use strict';j.setStickyPlaceholderForMentions(this.getComponent('maininput'),ka);j.setStickyPlaceholderForTypeahead(this.getComponent('placetagger').element,la);this._cameraIcon&&o.conditionClass(this._cameraIcon.element,"_1dsx",this.getScrollableArea().getTotalImageCount()>0);};ja.prototype._resetSubmitButtonLockable=function(){'use strict';this._submitButtonLockable=new q(this._setSubmitButtonEnabled.bind(this,true),this._setSubmitButtonEnabled.bind(this,false));this._overImageSelectionLimitLock=this._submitButtonLockable.getLock();if(this._config.usePhotoEditorTagging){this.setPhotoEditorFaceRecSubmitButtonLock(this._submitButtonLockable.getLock());}else this.setFaceRecSubmitButtonLock(this._submitButtonLockable.getLock());};ja.prototype._onUploadStart=function(){'use strict';var ka=this.getScrollableArea().getUploadArea().getRoot(),la=p.find(ka,'.fbScrollableAreaWrap');ea.setLeft(la,Math.max(0,p.find(ka,'.fbScrollableAreaBody').offsetWidth-la.offsetWidth));};ja.prototype._sendEventsSuggestionRequest=function(ka){'use strict';new v('ajax/events/tagging/suggestion_query').setData(ka).setHandler(null).send();};ja.prototype._initFileInput=function(){'use strict';};ja.prototype._getTotalNumberOfStickersOnPhotos=function(){'use strict';var ka=p.scry(this._root,".fbVaultGridItem"),la=0;ka.forEach(function(ma){la+=s.getTotalNumOfStickersOnPhoto(ma.getAttribute('data-originalfbid'));});return la;};ja.prototype._onSubmit=function(){'use strict';var ka=Date.now(),la=this.logWithTaggingData(this.getPhotoCount(),this.getComposerID()),ma={volume:this.getPhotoCount(),with_tag_count:la,sticker_count:this._getTotalNumberOfStickersOnPhotos()};this.logStep(da.CLIENT_PUBLISH_BEGIN,ma);var na=new fa();na.addSubscriptions(h.listen(this._root,'success',(function(oa){ma.dt=Date.now()-ka;this.logStep(da.CLIENT_PUBLISH_SUCCESS,ma);this.logStep(da.CLIENT_FLOW_SUCCESS);na.release();}).bind(this)),h.listen(this._root,'error',(function(oa){ma.dt=Date.now()-ka;oa=oa.getData().response;if(oa){ma.error_code=oa.getError();ma.error_info=oa.getErrorDescription();}this.logStep(da.CLIENT_PUBLISH_FAIL,ma);na.release();}).bind(this)));};ja.prototype._checkPhotoMaxSelect=function(){'use strict';if(this._config.maxSelect>1)if(this.getPhotoCount()>this._config.maxSelect){this._config.warningDialog.show();if(this._overImageSelectionLimitLock)this._overImageSelectionLimitLock.lock();}else{this._config.warningDialog.hide();if(this._overImageSelectionLimitLock)this._overImageSelectionLimitLock.unlock();}};f.exports=ja;},null);
__d('GroupSellComposerLogger',['BanzaiLogger','GroupSellComposerActionEvents'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={log:function(k,event,l){h.log('GroupSellComposerActionsLoggerConfig',{event:event,group_id:k,is_edit:l});},logComposerSubmit:function(k,l,m,n,o,p,q,r,s){h.log('GroupSellComposerActionsLoggerConfig',{event:i.COMPOSER_SUBMIT,group_id:k,title:l,price_currency:m,price_amount:n,description:o,pickup_note:p,num_photos:q,is_edit:r,is_intercept:s});},logComposerNonForsaleSubmit:function(k,l,m){h.log('GroupSellComposerActionsLoggerConfig',{event:i.COMPOSER_SUBMIT_REGULAR,group_id:k,description:l,is_edit:m});},logVideoEvent:function(event,k){h.log('GroupSellComposerActionsLoggerConfig',{event:event,video_time_position:k});}};f.exports=j;},null);
__d('ComposerXSellAttachmentMixin',['Arbiter','ComposerXController','CSS','DataStore','DOM','Focus','Input','Event','GroupSellComposerActionEvents','GroupSellComposerLogger','Parent','SubscriptionsHandler','URI','URLScraper','AsyncRequest','XGroupSellNUXPostToMarketplaceDialogController','getOrCreateDOMID','csx','cx','setImmediate'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba={initSellInputs:function(ca){this._isUploadingPhotos=false;this._composerSubmitted=false;var da=l.scry(this._root,"._4t9g");if(da.length>0)this._postOnMarketplaceCheckBox=da[0];var ea=this.getComponent('forsale').instance;if(this._linkShare){m.set(this._getDescriptionTextarea());}else if(!this._config.isDefaultComposer)m.set(ea.getTitleInput());this._inputsEverChanged={title:false,price:false,description:false,pickupNote:false,category:false,submitEnabled:false,launchedSellComposer:false};if(this._sellInputListeners){this._sellInputListeners.release();this._sellInputListeners=null;}if(this._descriptionFocusListener){this._descriptionFocusListener.remove();this._descriptionFocusListener=null;}this._sellInputListeners=new s();this._sellInputListeners.addSubscriptions(o.listen(ea.getTitleInput(),'input',this._inputsChanged.bind(this)),o.listen(ea.getTitleInput(),'change',this._inputsChanged.bind(this)),o.listen(ea.getPriceInput(),'input',this._inputsChanged.bind(this)),o.listen(ea.getPriceInput(),'change',this._inputsChanged.bind(this)),o.listen(this.getComponent('maininput').element,'input',this._inputsChanged.bind(this)),o.listen(this.getComponent('maininput').element,'change',this._inputsChanged.bind(this)),o.listen(ea.getPickupNoteInput(),'input',this._inputsChanged.bind(this)),o.listen(ea.getPickupNoteInput(),'change',this._inputsChanged.bind(this)),ea.subscribe('categoryChanged',this._inputsChanged.bind(this)),o.listen(this.getSubmitButton(),'click',this._submitButtonClicked.bind(this)));if(this._taggingFlyoutData&&this._taggingFlyoutData.recognitionController)this._sellInputListeners.addSubscriptions(this._taggingFlyoutData.recognitionController.subscribe('done',this._inputsChanged.bind(this)));var fa=l.scry(this._root,"._9s")[0];if(fa)this._sellInputListeners.addSubscriptions(o.listen(fa,'click',this._removeLinkAttachment.bind(this)));this._urlScraper=new u(this.getComponent('maininput').element,(function(){return this.getComponent('maininput').instance.getValue();}).bind(this));this._scraperListener=this._urlScraper.subscribe('match',(function(ha,ia){if(this._hasPhotos||fa||this._config.isEditComposer)return;var ja=new t(this._config.scraperEndpoint);ja.addQueryData({scrape_url:encodeURIComponent(ia.url)});i.getAttachment(this._root,ja.toString());}).bind(this));this.setHasPhotos(this.getPhotoCount()>0);this.getScrollableArea().setPlaceholderHandler(function(){});if(ca)q.log(this._config.targetID,p.COMPOSER_LOAD,this._config.isEditComposer);this._logLaunchSellComposer();this._sellComposerInited=true;this._inputsChanged();var ga=this.getComponent('maininput');ea.setInitialData(ga.instance.getValue(),false);},supportsDragDrop:function(){return false;},resetSellInputs:function(){if(this._sellInputListeners){this._sellInputListeners.release();this._sellInputListeners=null;}if(this._urlScraper){this._urlScraper.disable();this._urlScraper.reset();this._urlScraper=null;}if(this._descriptionFocusListener){this._descriptionFocusListener.remove();this._descriptionFocusListener=null;}var ca=r.byClass(this._root,"child_was_focused");if(ca)j.removeClass(ca,"child_was_focused");this._isUploadingPhotos=false;this._composerSubmitted=false;},cleanupSellInputs:function(){if(this._scraperListener){this._scraperListener.unsubscribe();this._scraperListener=null;}if(!this._descriptionFocusListener)this._descriptionFocusListener=o.listen(this._getDescriptionTextarea(),'focus',(function(){this._descriptionFocusListener.remove();this._descriptionFocusListener=null;if(this._nuxTooltip)this._nuxTooltip.show();}).bind(this));},_inputsChanged:function(){if(!this._sellComposerInited)return;var ca=this.getComponent('forsale').instance,da=n.isEmpty(ca.getTitleInput()),ea=n.isEmpty(ca.getHiddenPriceInput()),fa=ca.requiresCategory(),ga=ca.hasCategory(),ha=this.getComponent('maininput').instance,ia=!ha.getValue(),ja=n.isEmpty(ca.getPickupNoteInput());if(!this._inputsEverChanged.title&&!da){q.log(this._config.targetID,p.COMPOSER_FILL_TITLE,this._config.isEditComposer);this._inputsEverChanged.title=true;}if(!this._inputsEverChanged.price&&!ea){q.log(this._config.targetID,p.COMPOSER_FILL_PRICE,this._config.isEditComposer);this._inputsEverChanged.price=true;}if(!this._inputsEverChanged.description&&!ia){q.log(this._config.targetID,p.COMPOSER_FILL_DESCRIPTION,this._config.isEditComposer);this._inputsEverChanged.description=true;}if(!this._inputsEverChanged.pickupNote&&!ja){q.log(this._config.targetID,p.COMPOSER_FILL_PICKUP_NOTE,this._config.isEditComposer);this._inputsEverChanged.pickupNote=true;}if(!this._inputsEverChanged.category&&ga){q.log(this._config.targetID,p.COMPOSER_FILL_CATEGORY,this._config.isEditComposer);this._inputsEverChanged.category=true;}var ka=!this._isUploadingPhotos&&!this._composerSubmitted&&!da&&!ea&&(!fa||ga),la=this.getSubmitButton().parentNode,ma=l.find(la,"._314l");j.conditionShow(ma,!ka);if(!this._inputsEverChanged.submitEnabled&&ka){this._inputsEverChanged.submitEnabled=true;q.log(this._config.targetID,p.COMPOSER_SUBMIT_ENABLED,this._config.isEditComposer);}this._setSubmitButtonEnabled(ka);},_removeLinkAttachment:function(){if(!this._linkShare)return;l.remove(this._linkShare);this._linkShare=null;this._urlScraper.disable();},startedUploadingPhotos:function(){this._isUploadingPhotos=true;this._inputsChanged();},finishedUploadingPhotos:function(){this._isUploadingPhotos=false;this._inputsChanged();},setHasPhotos:function(ca){this._hasPhotos=ca;if(ca)this._removeLinkAttachment();},_getDescriptionTextarea:function(){return l.find(this.getComponent('maininput').element,'textarea.input');},_submitButtonClicked:function(ca){this._composerSubmitted=true;this._logComposerSubmitted();if(this._postOnMarketplaceCheckBox&&!this._postOnMarketplaceCheckBox.checked){ca.preventDefault();var da=document.getElementsByName('marketplace_from_group_id'),ea=da[0].value,fa=this._postOnMarketplaceCheckBox.form,ga=l.create('button');ga.className='hidden_elem ';ga.type='submit';fa.appendChild(ga);var ha=w.getURIBuilder().setString('root_id',this._root.id).setString('checkbox_id',this._postOnMarketplaceCheckBox.id).setString('button_id',x(ga)).setString('group_id',ea).getURI();new v().setURI(ha).send();}aa(this._inputsChanged.bind(this));},_logLaunchSellComposer:function(){var ca=r.byClass(this._root,"focus_target");if(j.hasClass(ca,'child_was_focused')){this._logComposerLaunched();}else{var da=this.getComponent('forsale').instance;this._titleFocusHandler=o.listen(da.getTitleInput(),'focus',this._logComposerLaunched.bind(this));}},_logComposerLaunched:function(){if(this._titleFocusHandler){this._titleFocusHandler.remove();this._titleFocusHandler=null;}if(this._inputsEverChanged.launchedSellComposer)return;this._inputsEverChanged.launchedSellComposer=true;q.log(this._config.targetID,p.LAUNCH_SELL_COMPOSER,this._config.isEditComposer);var ca=l.scry(this._root,"._4t9g");if(ca.length>0)q.log(this._config.targetID,p.SELL_COMPOSER_POST_TO_MARKETPLACE_SEEN,this._config.isEditComposer);h.inform('GroupSellComposer/launchedComposer');},_logComposerSubmitted:function(){var ca=this.getComponent('forsale').instance,da=this.getComponent('maininput'),ea=!!k.get(da.element,'groupForSalePostIntercept')&&!k.get(da.element,'groupForSalePostInterceptSubmit'),fa=parseFloat(n.getValue(ca.getHiddenPriceInput()))*100;q.logComposerSubmit(this._config.targetID,n.getValue(ca.getTitleInput()),n.getValue(ca.getCurrencyInput()),fa,da.instance.getValue(),n.getValue(ca.getPickupNoteInput()),this.getPhotoCount(),this._config.isEditComposer,ea);if(this.resetIntercept)this.resetIntercept();}};f.exports=ba;},null);
__d('ComposerXSellPlusAttachment',['ComposerXMediaUploadPlusAttachment','ComposerXSellAttachmentMixin','GroupSellComposerActionEvents','GroupSellComposerLogger','Parent','classWithMixins','cx','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q;p=babelHelpers.inherits(r,m(h,o(i)));q=p&&p.prototype;function r(s,t,u,v,w){'use strict';q.constructor.call(this,s,t,u);this.attachmentClassName="_4_7-";this._linkShare=v;this._nuxTooltip=w;}r.prototype.initWithComponents=function(s){'use strict';q.initWithComponents.call(this);this.getTagger().hideTaggerIcons();this._root.action=this._config.statusEndpoint;this.initSellInputs(!!s);this.updateEndpoints();};r.prototype.persistUploadArea=function(){'use strict';return true;};r.prototype.reset=function(){'use strict';this.resetSellInputs();q.reset.call(this);};r.prototype.cleanup=function(){'use strict';this.cleanupSellInputs();this.getTagger().showTaggerIcons();this.resetSellInputs();q.cleanup.call(this);};r.prototype.canSwitchAway=function(){'use strict';return !l.byClass(this._root,'async_saving');};r.prototype._onUploadStart=function(){'use strict';q._onUploadStart.call(this);this.setHasPhotos(true);this.startedUploadingPhotos();};r.prototype._handleImageRemoved=function(s,t){'use strict';q._handleImageRemoved.call(this,s,t);this.updateEndpoints();k.log(this._config.targetID,j.COMPOSER_DELETE_PHOTO,this._config.isEditComposer);};r.prototype._handleImageAdded=function(s,t){'use strict';q._handleImageAdded.call(this,s,t);this.finishedUploadingPhotos();this.updateEndpoints();k.log(this._config.targetID,j.COMPOSER_ADD_PHOTO,this._config.isEditComposer);};r.prototype.updateEndpoints=function(){'use strict';if(this.getPhotoCount()>0&&!this._config.isEditComposer){this._root.action=this._config.photoEndpoint;this.setHasPhotos(true);}else{this._root.action=this._config.statusEndpoint;this.setHasPhotos(false);}};f.exports=r;},null);
__d('ComposerXCameraIconBehavior',['Arbiter','ComposerXMediaUploadHandler','CSS','Event','cx'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m={initCameraIcon:function(n){this._cameraIcon=n.getComponent('cameraicon');if(!this._config.showCameraIcon){j.hide(this._cameraIcon.element);return;}j.show(this._cameraIcon.element);var o=this._cameraIcon.instance,p=new i(this._config.composerID,{imagesOnly:this._config.imagesOnly,isEditComposer:this._config.isEditComposer,photoUploadOverrideEndpoint:this._config.photoUploadOverrideEndpoint});this._listeners.push(k.listen(this._cameraIcon.element,'click',(function(){p.fetchAttachments();h.inform('cameraicon/click');}).bind(this)));this._subscriptions.push(o.subscribe('change',(function(){p.handleFileSelected(o);j.addClass(this._cameraIcon.element,"_19_a");}).bind(this)));}};f.exports=m;},null);
__d('ComposerXPlusTagger',['ComposerXCameraIconBehavior','ComposerXStandardTagger','classWithMixins','mixin'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;l=babelHelpers.inherits(n,j(i,k(h)));m=l&&l.prototype;function n(o){'use strict';m.constructor.call(this,o);this._eventuallyTagger=null;}n.prototype.init=function(o){'use strict';m.init.call(this,o);if(o.getComponent('cameraicon'))this.initCameraIcon(o);};n.prototype._nonObstrusiveSwitchToTagger=function(o){'use strict';var p=this._onTaggerShowCallbacks[o];delete this._onTaggerShowCallbacks[o];this.switchToTagger(o);this._dontHideTaggerOnMentionsFocus=o;this._onTaggerShowCallbacks[o]=p;};n.prototype.eventuallySwitchToTagger=function(o){'use strict';if(!this.isAnyTaggerShown()){this._nonObstrusiveSwitchToTagger(o);}else if(this._currentTagger!==o)this._eventuallyTagger=o;};n.prototype.switchToTagger=function(o){'use strict';if(this._eventuallyTagger===o)this._eventuallyTagger=null;this._nonEventuallyHideTaggers();this._showTagger(o);};n.prototype.hideTaggers=function(){'use strict';m.hideTaggers.call(this);if(this._eventuallyTagger){this._nonObstrusiveSwitchToTagger(this._eventuallyTagger);this._eventuallyTagger=null;}};n.prototype._nonEventuallyHideTaggers=function(){'use strict';m.hideTaggers.call(this);};n.prototype._hideTaggersFromMentionsInputClick=function(){'use strict';if(this._currentTagger!=this._dontHideTaggerOnMentionsFocus){this.eventuallySwitchToTagger(this._dontHideTaggerOnMentionsFocus);m._hideTaggersFromMentionsInputClick.call(this);}};f.exports=n;},null);
__d('ComposerXPlusTaggerWithOG',['ComposerXOGTaggerBehavior','ComposerXPlusTagger','classWithMixins','mixin'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;l=babelHelpers.inherits(n,j(i,k(h)));m=l&&l.prototype;n.prototype.init=function(o){'use strict';m.init.call(this,o);this.initOGTagger(o);};n.prototype.cleanup=function(){'use strict';m.cleanup.call(this);this.cleanupOGTagger();};function n(){'use strict';l.apply(this,arguments);}f.exports=n;},null);
__d("ComposerXInstanceResetter",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){i.instance.reset();}f.exports=h;},null);
__d('ComposerXOGTaggerReset',['CSS'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){j.instance.reset();h.hide(j.element);}f.exports=i;},null);
__d('ComposerXPeopleTaggerReset',['CSS'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){j.instance.reset();h.hide(j.element);}f.exports=i;},null);
__d('ComposerXPlaceTaggerReset',['CSS'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){j.instance.getCore().reset();h.hide(j.element);}f.exports=i;},null);
__d('VaultComposerController',['Arbiter','CSS','SubscriptionsHandler','areEqual','emptyFunction','removeFromArray','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();function o(p,q){this._uploadedImageCount=0;this._uploadingImageCount=0;this._subscriptionsHandler=new j();this._hasVideo=false;this._singleSelect=false;this._multiselectElems=q;this._initialPhotoFbids=[];this._photoFbids=[];this.setAllMediaRemovedHandler(l);this._subscriptionsHandler.addSubscriptions(h.subscribe('multi-upload/images-added/'+p,(function(r,s){var t=Object.keys(s.fbids),u=t.length;this._uploadingImageCount=Math.max(0,this._uploadingImageCount-u);this._uploadedImageCount+=u;if(this._uploadingImageCount>0)return;t.forEach((function(v){var w=s.fbids[v];this._photoFbids.push(w);if(s.initialPhoto)this._initialPhotoFbids.push(w);}).bind(this));this._onImagesChanged();}).bind(this)),h.subscribe('multi-upload/image-removed/'+p,(function(r,s){this._uploadedImageCount=Math.max(0,this._uploadedImageCount-1);m(this._photoFbids,s);this._onImagesChanged();}).bind(this)),h.subscribe('multi-upload/images-upload-completed/'+p,(function(r,s){this._uploadingImageCount=0;this._onImagesChanged();}).bind(this)),h.subscribe('multi-upload/video-added/'+p,(function(){this._multiselectElems.forEach(i.hide);this._enableComposerHandler(true);this._placeholderHandler(n._("Sag etwas \u00fcber dieses Video ..."),n._("Wo wurde dieses Video aufgenommen?"));this._hasVideo=true;}).bind(this)),h.subscribe('multi-upload/video-removed/'+p,(function(){this._multiselectElems.forEach(i.show);this._enableComposerHandler(false);this._placeholderHandler(n._("Sag etwas dar\u00fcber \u2026"),n._("Wo wurde das aufgenommen?"));this._hasVideo=false;this._allMediaRemovedHandler();}).bind(this)),h.subscribe('multi-upload/images-upload-start/'+p,(function(r,s){this._uploadingImageCount+=s.imageCount;this._enableComposerHandler(false);var t=this.getTotalImageCount();this._placeholderHandler(o.getPlaceholderText(t),o.getPlacePickerPlaceholderText(t));this._checkForSingleSelect();}).bind(this)),h.subscribe('multi-upload/all-images-removed/'+p,(function(){this._multiselectElems.forEach(i.show);this._uploadedImageCount=0;this._uploadingImageCount=0;this._enableComposerHandler(false);this._placeholderHandler(n._("Sag etwas dar\u00fcber \u2026"),n._("Wo wurde das aufgenommen?"));this._photoFbids.length=0;this._allMediaRemovedHandler();}).bind(this)));}Object.assign(o,{getPlaceholderText:function(p){if(p===0){return n._("Sag etwas dar\u00fcber \u2026");}else if(p==1){return n._("Sag etwas \u00fcber dieses Foto ...");}else return n._("Sag etwas \u00fcber diese Fotos ...");},getPlacePickerPlaceholderText:function(p){if(p===0){return n._("Wo wurde das aufgenommen?");}else if(p==1){return n._("Wo wurde dieses Foto aufgenommen?");}else return n._("Wo wurden diese Fotos aufgenommen?");}});Object.assign(o.prototype,{setEnableComposerHandler:function(p){this._enableComposerHandler=p;return this;},setMultiselectElems:function(p){this._multiselectElems=p;return this;},setPlaceholderHandler:function(p){this._placeholderHandler=p;return this;},setAllMediaRemovedHandler:function(p){this._allMediaRemovedHandler=p;return this;},setSingleSelect:function(p){this._singleSelect=p;return this;},cleanup:function(){this._uploadedImageCount=0;this._uploadingImageCount=0;this._initialPhotoFbids.length=0;this._photoFbids.length=0;this._subscriptionsHandler.release();},_checkForSingleSelect:function(){if(this._singleSelect)this._multiselectElems.forEach((function(p){i.conditionShow(p,this.getTotalImageCount()===0);}).bind(this));},getTotalImageCount:function(){return this._uploadingImageCount+this._uploadedImageCount;},getUploadedImageCount:function(){return this._uploadedImageCount;},enableComposerHandlerIfHasImages:function(){this._enableComposerHandler(this._uploadedImageCount>0&&this._uploadingImageCount===0);},_onImagesChanged:function(){this.enableComposerHandlerIfHasImages();this._placeholderHandler(o.getPlaceholderText(this._uploadedImageCount),o.getPlacePickerPlaceholderText(this._uploadedImageCount));this._checkForSingleSelect();if(this._uploadedImageCount===0&&this._uploadingImageCount===0)this._allMediaRemovedHandler();},getPhotoFbids:function(){return this._photoFbids;},hasChanges:function(){var p=!k(this._photoFbids,this._initialPhotoFbids);return p||this._hasVideo;}});f.exports=o;},null);
__d('ComposerXUploadArea',['Arbiter','ComposerXController','CSS','DOM','PhotosMultiUploadInput','VaultComposerController','csx','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();function p(q,r,s){'use strict';this.$ComposerXUploadArea1=q;this.$ComposerXUploadArea2=r;this.$ComposerXUploadArea3=s;this.$ComposerXUploadArea4=0;}p.prototype.initialize=function(q,r,s,t,u){'use strict';this.$ComposerXUploadArea5=t;if(!this.$ComposerXUploadArea6)this.$ComposerXUploadArea6=new m(this.$ComposerXUploadArea5,q);this.$ComposerXUploadArea6.setSingleSelect(r.maxSelect===1).setPlaceholderHandler(this.setPlaceholderHandler.bind(this)).setMultiselectElems(q);i.registerConditionForComposerCancel(u,this.$ComposerXUploadArea6.hasChanges.bind(this.$ComposerXUploadArea6));this.$ComposerXUploadArea6.setMultiselectElems(q);};p.prototype.setEnableComposerHandler=function(q){'use strict';this.$ComposerXUploadArea6.setEnableComposerHandler(q);this.$ComposerXUploadArea6.enableComposerHandlerIfHasImages();return this;};p.prototype.setAllMediaRemovedHandler=function(q){'use strict';this.$ComposerXUploadArea6.setAllMediaRemovedHandler(q);return this;};p.prototype.setSingleSelect=function(q){'use strict';this.$ComposerXUploadArea6.setSingleSelect(q);return this;};p.prototype.setPlaceholderHandler=function(q){'use strict';this.$ComposerXUploadArea6.setPlaceholderHandler(q);return this;};p.prototype.getUploadArea=function(){'use strict';return this.$ComposerXUploadArea2;};p.prototype.getUploadItem=function(){'use strict';return this.$ComposerXUploadArea3;};p.prototype.getPhotoFbids=function(){'use strict';return this.$ComposerXUploadArea6?this.$ComposerXUploadArea6.getPhotoFbids():null;};p.prototype.handleImageAdded=function(q,r){'use strict';this.$ComposerXUploadArea7(this.getPhotoCount()+Object.keys(r.fbids).length);};p.prototype.handleImageRemoved=function(q,r){'use strict';this.$ComposerXUploadArea7(this.getPhotoCount()-1);};p.prototype.getTotalImageCount=function(){'use strict';return this.$ComposerXUploadArea6?this.$ComposerXUploadArea6.getTotalImageCount():0;};p.prototype.reset=function(){'use strict';h.inform('multi-upload/video-removed/'+this.$ComposerXUploadArea5);this.removeAllImages();};p.prototype.cleanup=function(){'use strict';this.reset();if(this.$ComposerXUploadArea6){this.$ComposerXUploadArea6.cleanup();this.$ComposerXUploadArea6=null;}};p.prototype.$ComposerXUploadArea7=function(q){'use strict';this.$ComposerXUploadArea4=q;};p.prototype.getPhotoCount=function(){'use strict';return this.$ComposerXUploadArea4;};p.prototype.getController=function(){'use strict';return this.$ComposerXUploadArea6;};p.prototype.removeAllImages=function(){'use strict';this.$ComposerXUploadArea7(0);k.scry(this.$ComposerXUploadArea1,"._yr").forEach(function(r){if(!j.hasClass(r,"_2oh"))k.remove(r);});k.scry(this.$ComposerXUploadArea1,"._579").forEach(function(r){if(!j.hasClass(r,"_2oh"))k.remove(r);});var q=this.$ComposerXUploadArea3.getUploadInput().getGrid();if(q){q.clearSession();}else l.clearSession(this.$ComposerXUploadArea5);h.inform(['multi-upload/all-images-removed/'+this.$ComposerXUploadArea5,'multi-upload/all-images-removed']);};f.exports=p;},null);
__d('GroupSellInterceptUtil',['escapeRegex'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={parseInterceptedPrices:function(j,k){var l=new RegExp('\\d+','ig'),m=new RegExp(h(k)+'\\s*\\d+','ig'),n=new RegExp('\\d+(?=\\s*'+h(k)+')','ig'),o=[],p=j.match(m);if(p)p.forEach(function(q){return o=o.concat(q.match(l));});p=j.match(n);if(p)o=o.concat(p);return o;}};f.exports=i;},null);
__d('ComposerXForSaleComponent',['Currency','AdsCurrencyFormatter','ArbiterMixin','ContextualLayer','CSS','DataStore','Event','GroupSellInterceptUtil','Input','LayerHideOnBlur','SubscriptionsHandler','cx','fbt','getActiveElement','getElementText','invariant','mixin','setTextContent'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){if(c.__markCompiled)c.__markCompiled();var z,aa;z=babelHelpers.inherits(ba,x(j));aa=z&&z.prototype;function ba(ca,da,ea){'use strict';aa.constructor.call(this);this._inputs=ca;this._charCounts=da;this._options=ea;this._currency=ea.currencies[0];!this._currency?w(0):undefined;this._currencySymbol=h.getSymbol(this._currency);!this._currencySymbol?w(0):undefined;var fa=this._inputs.title,ga=this._inputs.price,ha=this._inputs.pickupNote;this._subscriptions=new r();this._subscriptions.addSubscriptions(n.listen(fa,'input',this._titleChanged.bind(this)),n.listen(fa,'change',this._titleChanged.bind(this)),n.listen(fa,'focus',this._titleFocusChanged.bind(this)),n.listen(fa,'blur',this._titleFocusChanged.bind(this)),n.listen(ga,'focus',this._priceFocused.bind(this)),n.listen(ga,'input',this._priceChanged.bind(this)),n.listen(ga,'change',this._priceChanged.bind(this)),n.listen(ga,'blur',this._priceBlurred.bind(this)));if(this._charCounts.pickupNote)this._subscriptions.addSubscriptions(n.listen(ha,'input',this._pickupNoteChanged.bind(this)),n.listen(ha,'change',this._pickupNoteChanged.bind(this)),n.listen(ha,'focus',this._pickupNoteFocusChanged.bind(this)),n.listen(ha,'blur',this._pickupNoteFocusChanged.bind(this)));p.setValue(this._inputs.hiddenCurrency,this._currency);this._priceChanged();this._priceBlurred();this._titleChanged();this._titleFocusChanged();if(this._charCounts.pickupNote){this._pickupNoteChanged();this._pickupNoteFocusChanged();}if(this._inputs.selectCategory){l.removeClass(this._inputs.categoriesDropdown,"hidden_elem");this._subscriptions=new r();this._subscriptions.addSubscriptions(n.listen(this._inputs.selectCategory,'click',this._handleSelectCategory.bind(this)),n.listen(this._inputs.categoriesDropdown,'click',this._handleCategoryClick.bind(this)));this._layer=new k({context:this._inputs.selectCategory,position:'below',alignment:'left'},this._inputs.categoriesDropdown);this._layer.enableBehavior(q);}}ba.prototype._titleChanged=function(){'use strict';var ca=p.getValue(this._inputs.title).trim(),da=this._options.inputMaxChars-ca.length;y(this._charCounts.title,da);};ba.prototype._titleFocusChanged=function(){'use strict';l.conditionShow(this._charCounts.title,u()===this._inputs.title);};ba.prototype._priceFocused=function(){'use strict';if(p.isEmpty(this._inputs.price))p.setValue(this._inputs.price,this._currencySymbol);};ba.prototype.setInitialData=function(ca,da){'use strict';this.setInitialPriceIfEmpty(ca,da);if(da){var ea=ca.length,fa=ca.substr(0,Math.min(30,ea));if(fa.length<ea)fa=fa.concat('...');var ga=this._options.everyThingElseCategoryID.toString();p.setValue(this._inputs.title,fa);if(this.requiresCategory())this._setCategory(ga,v(this._options.everythingElseCategory));}};ba.prototype.setInitialPriceIfEmpty=function(ca,da){'use strict';var ea=this._getPriceValue();if(!ea){var fa=o.parseInterceptedPrices(ca,this._currencySymbol);if(fa.length){p.setValue(this._inputs.price,fa[0]);this._priceChanged();}else if(da)this._inputs.price.focus();}};ba.prototype._priceChanged=function(){'use strict';var ca=this._getPriceValue();if(ca==null){p.setValue(this._inputs.hiddenPrice,'');p.setValue(this._inputs.price,this._currencySymbol);return;}p.setValue(this._inputs.hiddenPrice,''+ca);var da=h.getOffset(this._currency),ea=i.formatCurrencyWithOptionalDecimals(this._currency,ca*da);if(ea!==p.getValue(this._inputs.price))p.setValue(this._inputs.price,ea);};ba.prototype._priceBlurred=function(){'use strict';var ca=this._getPriceValue();if(ca==null)p.reset(this._inputs.price);};ba.prototype._getPriceValue=function(){'use strict';var ca=p.getValue(this._inputs.price),da=ca.replace(/\D/g,'');if(!da.length){return null;}else return parseInt(da,10);};ba.prototype._pickupNoteChanged=function(){'use strict';var ca=p.getValue(this._inputs.pickupNote).trim();y(this._charCounts.pickupNote,this._options.inputMaxChars-ca.length);};ba.prototype._pickupNoteFocusChanged=function(){'use strict';l.conditionShow(this._charCounts.pickupNote,u()===this._inputs.pickupNote);};ba.prototype.requiresCategory=function(){'use strict';return !!this._inputs.selectCategory;};ba.prototype.hasCategory=function(){'use strict';return (!!this._inputs.categoryIDInput&&!!p.getValue(this._inputs.categoryIDInput));};ba.prototype._handleSelectCategory=function(){'use strict';this._layer.show();};ba.prototype._handleCategoryClick=function(event){'use strict';var ca=m.get(event.target,'categoryID');if(ca){this._setCategory(ca,v(event.target));this._layer.hide();}};ba.prototype._setCategory=function(ca,da){'use strict';p.setValue(this._inputs.categoryIDInput,ca);y(this._inputs.selectCategory,da);l.addClass(this._inputs.selectCategory,"_4oxb");this.inform('categoryChanged');};ba.prototype.reset=function(){'use strict';p.reset(this._inputs.title);p.reset(this._inputs.price);p.reset(this._inputs.hiddenPrice);if(this._charCounts.pickupNote)p.reset(this._inputs.pickupNote);this._charCounts.title.innerText=this._options.inputMaxChars;if(this._charCounts.pickupNote)this._charCounts.pickupNote.innerText=this._options.inputMaxChars;if(this._inputs.categoryIDInput){p.reset(this._inputs.categoryIDInput);y(this._inputs.selectCategory,t._("W\u00e4hle eine Kategorie"));l.removeClass(this._inputs.selectCategory,"_4oxb");}};ba.prototype.getTitleInput=function(){'use strict';return this._inputs.title;};ba.prototype.getPriceInput=function(){'use strict';return this._inputs.price;};ba.prototype.getCurrencyInput=function(){'use strict';return this._inputs.hiddenCurrency;};ba.prototype.getHiddenPriceInput=function(){'use strict';return this._inputs.hiddenPrice;};ba.prototype.getPickupNoteInput=function(){'use strict';return this._inputs.pickupNote;};f.exports=ba;},null);
__d("VaultGridUploadItem",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){"use strict";this.$VaultGridUploadItem1=i;}h.prototype.getUploadInput=function(){"use strict";return this.$VaultGridUploadItem1;};f.exports=h;},null);FD_      VqVq;_EW   Ba,:https://fbstatic-a.akamaihd.net/rsrc.php/v2/yR/r/Y1B_6mAnRtb.js necko:classified 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8F+O2DZM7ZTG6GukivU8OT5gAAAAAAAAXAMIIFvDCCBKSgAwIBAgIUPbXhC4Xsu7H3z2HTJ2qImwWmfEMwDQYJKoZIhvcNAQELBQAwgY0xCzAJBgNVBAYTAk5MMRIwEAYDVQQHEwlBbXN0ZXJkYW0xJTAjBgNVBAoTHFZlcml6b24gRW50ZXJwcmlzZSBTb2x1dGlvbnMxEzARBgNVBAsTCkN5YmVydHJ1c3QxLjAsBgNVBAMTJVZlcml6b24gQWthbWFpIFN1cmVTZXJ2ZXIgQ0EgRzE0LVNIQTIwHhcNMTUwODI3MTYxMDEyWhcNMTYwODI3MTYxMDExWjBtMQswCQYDVQQGEwJVUzELMAkGA1UECBMCTUExEjAQBgNVBAcTCUNhbWJyaWRnZTEhMB8GA1UEChMYQWthbWFpIFRlY2hub2xvZ2llcyBJbmMuMRowGAYDVQQDExFhMjQ4LmUuYWthbWFpLm5ldDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMEsC1Bf+D5X49PrJxQQynzSoPaTqlm/R6G6xlDErWOJauViiexo6vmzahzzSlMEPVYpyT5oRd3SB4Qx7548TyiC90yse+aFur0qrNLeNMG7npVWA0up2v4a8msqYRACxoHcLolFXNFPNWtBTsRW42Ce+pg94pP4gWvBeFVclt3v9x2mr8RHafRNVLJvAJi+eg2mZlfeccqCWrIXKp/xZGUWBswTK+TFC2s1pJNxQkDMYpmLdgte0H0h4IRh8V7elj7TP/8Z8i0l4SxIHNbuqA8HvjBsundiNujlykBR9JSvX238ATPLOFrqkQQz6UAYHo2RRH7X72Uvbitu38jPYVcCAwEAAaOCAjEwggItMAwGA1UdEwEB/wQCMAAwTAYDVR0gBEUwQzBBBgkrBgEEAbE+ATIwNDAyBggrBgEFBQcCARYmaHR0cHM6Ly9zZWN1cmUub21uaXJvb3QuY29tL3JlcG9zaXRvcnkwga8GCCsGAQUFBwEBBIGiMIGfMC0GCCsGAQUFBzABhiFodHRwOi8vdmFzc2cxNDIub2NzcC5vbW5pcm9vdC5jb20wNgYIKwYBBQUHMAKGKmh0dHBzOi8vY2FjZXJ0LmEub21uaXJvb3QuY29tL3Zhc3NnMTQyLmNydDA2BggrBgEFBQcwAoYqaHR0cHM6Ly9jYWNlcnQuYS5vbW5pcm9vdC5jb20vdmFzc2cxNDIuZGVyMG4GA1UdEQRnMGWCEWEyNDguZS5ha2FtYWkubmV0gg4qLmFrYW1haWhkLm5ldIIWKi5ha2FtYWloZC1zdGFnaW5nLm5ldIIPKi5ha2FtYWl6ZWQubmV0ghcqLmFrYW1haXplZC1zdGFnaW5nLm5ldDAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMB8GA1UdIwQYMBaAFPi9+q9zd8bHG/lLTRGn0TOvr3IRMD4GA1UdHwQ3MDUwM6AxoC+GLWh0dHA6Ly92YXNzZzE0Mi5jcmwub21uaXJvb3QuY29tL3Zhc3NnMTQyLmNybDAdBgNVHQ4EFgQUwHfR+EVeIyYOCfrHIM4gYFwsUd8wDQYJKoZIhvcNAQELBQADggEBALu54DWULbb7PuC5sYITWHJAFLikko7suU7mUu2a/QvS/GNNHfm4ny+on2w++/itYAKrsNMXkX1zglqtX6AACSUlgw7K6G7CoEVJXBntkBmt9wAJXroe2jMgWYvpbmYkcyaNRc4VvOK9FjvHslqXa5Y6NArfI5kRfdljblFQXR2sTYyYk0Dqqq8COCs62GhyLlP/oohQU0hA6EtomF5VFNlokO9qa+IAHrp2lR/+BLYcwPgOCxszCZikcmP5zyAnkte1Blh9kBQnKf6J6wTZsUUPcLktNr7FFqRIay8moKUuxYiSqlE4kSktcYqXy5cGrgYfwGYM93+0O3y8QZ30vLHALwADAAAAAAEBAAA= request-method GET response-head HTTP/1.1 200 OK
access-control-allow-origin: *
Cache-Control: public, max-age=31450979
Content-MD5: V+YO8pvPurlfWHJPUn7lKw==
Content-Type: application/x-javascript; charset=utf-8
Date: Thu, 15 Oct 2015 15:59:45 GMT
Expires: Thu, 13 Oct 2016 16:22:44 GMT
Last-Modified: Mon, 01 Jan 2001 08:00:00 GMT
Timing-Allow-Origin: *
x-content-type-options: nosniff
X-FB-Debug: 280UROev7WRZAqBuR3GHeTdE0FThfzHRFuZG8XCmZ7FSb76xQd5hC3zovAIgJLvNb+qk+ysHLPRoVjHwxioA0A==
X-FB-Stats-Contexts: : www, : V2
X-Firefox-Spdy: 3.1
 uncompressed-len 0  ,v